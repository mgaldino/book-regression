<!DOCTYPE html>
<html lang="pt" xml:lang="pt">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 - Causalidade | Introdução à Regresssão para Ciências Sociais</title>
  <meta name="description" content="Capítulo 8 - Causalidade | Introdução à Regresssão para Ciências Sociais" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 - Causalidade | Introdução à Regresssão para Ciências Sociais" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 - Causalidade | Introdução à Regresssão para Ciências Sociais" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2023-10-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimação.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Regressão</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> - Prefácio</a></li>
<li class="chapter" data-level="2" data-path="revisão-de-r.html"><a href="revisão-de-r.html"><i class="fa fa-check"></i><b>2</b> - Revisão de R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-e-rstudio"><i class="fa fa-check"></i><b>2.1</b> R e Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-como-calculadora"><i class="fa fa-check"></i><b>2.2</b> R como calculadora</a></li>
<li class="chapter" data-level="2.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#objetos-no-r"><i class="fa fa-check"></i><b>2.3</b> Objetos no R</a></li>
<li class="chapter" data-level="2.4" data-path="revisão-de-r.html"><a href="revisão-de-r.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.4</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#numeric"><i class="fa fa-check"></i><b>2.4.1</b> Numeric</a></li>
<li class="chapter" data-level="2.4.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#character"><i class="fa fa-check"></i><b>2.4.2</b> character</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="revisão-de-r.html"><a href="revisão-de-r.html#armazenando-dados"><i class="fa fa-check"></i><b>2.5</b> Armazenando dados</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#vetor"><i class="fa fa-check"></i><b>2.5.1</b> Vetor</a></li>
<li class="chapter" data-level="2.5.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#matriz"><i class="fa fa-check"></i><b>2.5.2</b> Matriz</a></li>
<li class="chapter" data-level="2.5.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-frame"><i class="fa fa-check"></i><b>2.5.3</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="revisão-de-r.html"><a href="revisão-de-r.html#bibliotecaspacotes"><i class="fa fa-check"></i><b>2.6</b> Bibliotecas/pacotes</a></li>
<li class="chapter" data-level="2.7" data-path="revisão-de-r.html"><a href="revisão-de-r.html#importando-dados"><i class="fa fa-check"></i><b>2.7</b> importando dados</a></li>
<li class="chapter" data-level="2.8" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-wrangling"><i class="fa fa-check"></i><b>2.8</b> Data wrangling</a></li>
<li class="chapter" data-level="2.9" data-path="revisão-de-r.html"><a href="revisão-de-r.html#visualização"><i class="fa fa-check"></i><b>2.9</b> Visualização</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html"><i class="fa fa-check"></i><b>3</b> - Revisão de estatística e probabilidade</a>
<ul>
<li class="chapter" data-level="3.1" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#variável-aleatória"><i class="fa fa-check"></i><b>3.1</b> Variável Aleatória</a></li>
<li class="chapter" data-level="3.2" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#esperança-matemática"><i class="fa fa-check"></i><b>3.2</b> Esperança matemática</a></li>
<li class="chapter" data-level="3.3" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#variância"><i class="fa fa-check"></i><b>3.3</b> Variância</a></li>
<li class="chapter" data-level="3.4" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#algebra-com-esperança-variância-e-covariância"><i class="fa fa-check"></i><b>3.4</b> Algebra com Esperança, Variância e Covariância</a></li>
<li class="chapter" data-level="3.5" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#distribuição-de-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.5</b> Distribuição de Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.6" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#pobabilidade-condicional"><i class="fa fa-check"></i><b>3.6</b> Pobabilidade Condicional</a></li>
<li class="chapter" data-level="3.7" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#esperança-condicional"><i class="fa fa-check"></i><b>3.7</b> Esperança Condicional</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html"><i class="fa fa-check"></i><b>4</b> Introdução à Simulação</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#configuração"><i class="fa fa-check"></i><b>4.1</b> Configuração</a></li>
<li class="chapter" data-level="4.2" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simular"><i class="fa fa-check"></i><b>4.2</b> Simular</a></li>
<li class="chapter" data-level="4.3" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#resumir"><i class="fa fa-check"></i><b>4.3</b> Resumir</a></li>
<li class="chapter" data-level="4.4" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#análise-de-sensibilidade"><i class="fa fa-check"></i><b>4.4</b> Análise de sensibilidade</a></li>
<li class="chapter" data-level="4.5" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#aplicação-de-simulação"><i class="fa fa-check"></i><b>4.5</b> Aplicação de simulação</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html"><i class="fa fa-check"></i><b>5</b> O Modelo de Regressão</a>
<ul>
<li class="chapter" data-level="5.1" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#modelo-de-regressão---teoria"><i class="fa fa-check"></i><b>5.1</b> Modelo de Regressão - Teoria</a></li>
<li class="chapter" data-level="5.2" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#esperança-condicional-1"><i class="fa fa-check"></i><b>5.2</b> Esperança Condicional</a></li>
<li class="chapter" data-level="5.3" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#cef"><i class="fa fa-check"></i><b>5.3</b> CEF</a></li>
<li class="chapter" data-level="5.4" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#objetivos-de-aprendizagem-ao-final-do-capítulo"><i class="fa fa-check"></i><b>5.4</b> Objetivos de aprendizagem ao final do capítulo</a></li>
<li class="chapter" data-level="5.5" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#distribuição-dos-salários"><i class="fa fa-check"></i><b>5.5</b> Distribuição dos salários</a></li>
<li class="chapter" data-level="5.6" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#distribuição-condicional-dos-salários"><i class="fa fa-check"></i><b>5.6</b> Distribuição Condicional dos salários</a></li>
<li class="chapter" data-level="5.7" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#logaritmos"><i class="fa fa-check"></i><b>5.7</b> Logaritmos</a></li>
<li class="chapter" data-level="5.8" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#gênero-e-raça"><i class="fa fa-check"></i><b>5.8</b> Gênero e Raça</a></li>
<li class="chapter" data-level="5.9" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#prevendo-a-partir-da-esperança-condicional"><i class="fa fa-check"></i><b>5.9</b> Prevendo a partir da esperança condicional</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cef-1.html"><a href="cef-1.html"><i class="fa fa-check"></i><b>6</b> - CEF</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cef-1.html"><a href="cef-1.html#erro-da-cef"><i class="fa fa-check"></i><b>6.1</b> Erro da CEF</a></li>
<li class="chapter" data-level="6.2" data-path="cef-1.html"><a href="cef-1.html#simulando-para-entender-a-cef"><i class="fa fa-check"></i><b>6.2</b> Simulando para entender a CEF</a></li>
<li class="chapter" data-level="6.3" data-path="cef-1.html"><a href="cef-1.html#propriedades-da-cef"><i class="fa fa-check"></i><b>6.3</b> Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="cef-1.html"><a href="cef-1.html#a-esperança-do-erro-condicional-a-x-é-zero"><i class="fa fa-check"></i><b>6.3.1</b> A Esperança do Erro Condicional a X é zero</a></li>
<li class="chapter" data-level="6.3.2" data-path="cef-1.html"><a href="cef-1.html#a-esperança-não-condicional-do-erro-é-zero."><i class="fa fa-check"></i><b>6.3.2</b> A esperança (não-condicional) do erro é zero.</a></li>
<li class="chapter" data-level="6.3.3" data-path="cef-1.html"><a href="cef-1.html#o-erro-da-cef-é-não-correlacionado-com-x"><i class="fa fa-check"></i><b>6.3.3</b> O erro da CEF é não-correlacionado com X</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="cef-1.html"><a href="cef-1.html#regressão-linear-e-a-cef"><i class="fa fa-check"></i><b>6.4</b> Regressão Linear e a CEF</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="cef-1.html"><a href="cef-1.html#mínimos-quadrados-ordinários"><i class="fa fa-check"></i><b>6.4.1</b> Mínimos Quadrados Ordinários</a></li>
<li class="chapter" data-level="6.4.2" data-path="cef-1.html"><a href="cef-1.html#suponha-que-a-cef-é-linear-justificativa-i"><i class="fa fa-check"></i><b>6.4.2</b> Suponha que a CEF é Linear (Justificativa I)</a></li>
<li class="chapter" data-level="6.4.3" data-path="cef-1.html"><a href="cef-1.html#é-o-melhor-preditor-linear-justificativa-ii"><i class="fa fa-check"></i><b>6.4.3</b> É o melhor preditor linear (justificativa II)</a></li>
<li class="chapter" data-level="6.4.4" data-path="cef-1.html"><a href="cef-1.html#a-reta-de-regressão-é-a-aproxdimação-com-o-menor-erro-quadrático-médio-justificativa-iii"><i class="fa fa-check"></i><b>6.4.4</b> A reta de regressão é a aproxdimação com o menor erro quadrático médio (justificativa III)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cef-1.html"><a href="cef-1.html#modelo-só-com-intercepto"><i class="fa fa-check"></i><b>6.5</b> Modelo só com intercepto</a></li>
<li class="chapter" data-level="6.6" data-path="cef-1.html"><a href="cef-1.html#variância-da-regressão"><i class="fa fa-check"></i><b>6.6</b> Variância da Regressão</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="cef-1.html"><a href="cef-1.html#chuva-na-jamaica"><i class="fa fa-check"></i><b>6.6.1</b> Chuva na Jamaica</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="cef-1.html"><a href="cef-1.html#variância-condicional"><i class="fa fa-check"></i><b>6.7</b> Variância condicional</a></li>
<li class="chapter" data-level="6.8" data-path="cef-1.html"><a href="cef-1.html#efeito-marginal"><i class="fa fa-check"></i><b>6.8</b> Efeito Marginal</a></li>
<li class="chapter" data-level="6.9" data-path="cef-1.html"><a href="cef-1.html#cef-linear-com-peditores-não-lineares"><i class="fa fa-check"></i><b>6.9</b> CEF linear com peditores não-lineares</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimação.html"><a href="estimação.html"><i class="fa fa-check"></i><b>7</b> - Estimação</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimação.html"><a href="estimação.html#regressão-por-mínimos-quadrados"><i class="fa fa-check"></i><b>7.1</b> Regressão por mínimos quadrados</a></li>
<li class="chapter" data-level="7.2" data-path="estimação.html"><a href="estimação.html#modelo-de-média-amostral"><i class="fa fa-check"></i><b>7.2</b> Modelo de Média amostral</a></li>
<li class="chapter" data-level="7.3" data-path="estimação.html"><a href="estimação.html#modelo-de-regressão-linear"><i class="fa fa-check"></i><b>7.3</b> Modelo de Regressão Linear</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="causalidade.html"><a href="causalidade.html"><i class="fa fa-check"></i><b>8</b> - Causalidade</a>
<ul>
<li class="chapter" data-level="8.1" data-path="causalidade.html"><a href="causalidade.html#resultados-potenciais"><i class="fa fa-check"></i><b>8.1</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="causalidade.html"><a href="causalidade.html#decomposição-do-efeito-causal"><i class="fa fa-check"></i><b>8.1.1</b> Decomposição do Efeito Causal</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="causalidade.html"><a href="causalidade.html#modelo-estrutural-e-modelo-de-regressão"><i class="fa fa-check"></i><b>8.2</b> Modelo estrutural e modelo de regressão</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="causalidade.html"><a href="causalidade.html#exemplo-de-cef-e-cef-estrutural"><i class="fa fa-check"></i><b>8.2.1</b> Exemplo de CEF e CEF estrutural</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="causalidade.html"><a href="causalidade.html#simulação-de-resultados-potenciais-e-causalidade"><i class="fa fa-check"></i><b>8.3</b> Simulação de Resultados Potenciais e Causalidade</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à Regresssão para Ciências Sociais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="causalidade" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Capítulo 8</span> - Causalidade<a href="causalidade.html#causalidade" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Até o momento estivemos estudando regressão em um sentido puramente preditivo (ou descritivo). Mas com frequência nosso interesse está em utilizar regressão para inferir causalidade. E uma regressão pode ser interpretada causalmente quando a CEF for causal. Obviamente, essa resposta é insatisfatória, pois a próxima pergunta é: quando a CEF é causal? A resposta é: A CEF é causal quando ela descreve diferenças nos resultados ponteciais (potencial outcomes) em uma dada população alvo.</p>
<p>Vamos então definir causalidade a partir da noção de resultados potenciais, para em seguida ver como podemos utilizar regressão para fazer inferência causal.</p>
<div id="resultados-potenciais" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Resultados Potenciais<a href="causalidade.html#resultados-potenciais" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Digamos que estamos interessados em estimar o efeito causal de pertencer à base do governo sobre o percentual de votos de um deputado que será conforme indicado pelo líder do governo. Donald Rubin, em uma série de artigos nos anos 70, introduziu a noção de resultados potenciais a partir da noção mais familiar de contrafactual. Imagine um deputado que está na oposição e ele passa a fazer parte do governo. Se nós pudéssemos observar uma série de votações tanto no mundo factual em que é do governo, quando no contrafactual em que não é do governo, teríamos o efeito causal para aquele deputado de fazer parte do governo sobre seu percentual de votação em acordo com a indicação do líder do governo. Porém, não é possível observar ambos os mundos, o factual e o contrafactual ao mesmo tempo, o que é conhecido como o problema fundamental da inferência causal. Se pudéssemos observar duas terras paralelas, exatamente iguais, exceto por esse único fato, conseguiríamos calcular o efeito causal.</p>
<p>Seja <span class="math inline">\(Y_{1i}\)</span> o percentual de votação <em>potencial</em> do deputado <span class="math inline">\(i\)</span> quando ele é da base do governo (indicado pelo índice “1”) e seja <span class="math inline">\(Y_{0i}\)</span> o percentual de votação <em>potencial</em> do deputado <span class="math inline">\(i\)</span> quando ele não é da base do governo (indicado pelo índice “0”).</p>
<p><span class="math inline">\(Y_{1i} - Y_{0i}\)</span> é o efeito causal para <span class="math inline">\(i\)</span> de fazer parte da base do governo e é o que gostaríamos de saber para cada deputado. Se eu pudesse observar essa diferença para cada deputado, poderia calcular o Efeito Causal Médio, <span class="math inline">\(\mathbb{E}[Y_{1i} - Y_{0i}]\)</span>, em inglês, Average Causal Effect (ACE).</p>
<p>Seja <span class="math inline">\(B_i\)</span> uma variável que indica se um deputado é ou não da base do governo (<span class="math inline">\(1\)</span> se é, <span class="math inline">\(0\)</span> caso contrário).</p>
<p>O mundo factual (observado) pode ser descrito em termos dos resultados potenciais pela eqquação abaixo. É importante enfatizar que essa equação conecta os resultados observados com os resultados potenciais. Vale notar também a diferença de notação entre um resultado observado (indexado apenas o indivíduo <span class="math inline">\(i\)</span>) e um potencial (indexado para o indivíduo <span class="math inline">\(i\)</span> e para o tratamento potencialmente recebido).</p>
<p><span class="math display">\[\begin{equation}
\tag{8.1}
Y_i = Y_{0i} + (Y_{1i} - Y_{0i})*B_i
\end{equation}\]</span></p>
<p>A equação nos lembra também que nós só podemos observar um dos resultados potenciais, associado a ser ou não da base do governo, mas não ambos ao mesmo tempo. Veja que se para um indivíduo <span class="math inline">\(i\)</span> ele é da base do governo, isto é, <span class="math inline">\(B_i = 1\)</span>, então tenho para este individuo em particularque <span class="math inline">\(Y_i = Y_{1i}\)</span>, isto é, o resultado potencial coincide com o resultado observado. Essa igualdade é na verdade uma suposição, chamada de consistência.</p>
<p>Consistência: Essa suposição implica que o resultado potencial de um indivíduo quando recebe um tratmento é igual ao observado na realidade. Em outras palavras, consistência significa que o que você observa é o que você supunha que aconteceria se a pessoa recebesse o tratamento.</p>
<p>Para imaginar que consistência falhasse, imagine quando um deputado <span class="math inline">\(i\)</span> distante ideologicamente do governo vira da base do governo ele, buscando reduzir dissonância cognitiva, muda sua ideologia para algo mais proximo do governo. Já um deputado mais alinhado não precisa fazer isso. Então, na verdade temos dois “tratamentos” acontecendo, e não um, e a hipótese de consistência não será verificada.</p>
<div id="decomposição-do-efeito-causal" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Decomposição do Efeito Causal<a href="causalidade.html#decomposição-do-efeito-causal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A equação 8.1 conecta resultados observados com resultados potenciais. Isso é particularmente útil quando quisermos estimar o efeito causal a prtir de dados observacionais. Digamos que tenho dados sobre deputados que fazem parte da base do governo e que não fazem. Nós iremos mostrar agora porque correlação (associação) não implica causalidade.</p>
<p>Digamos que queremos computar a média percentual de votação conforme indicação do governo para deputados da base e fora da base. Isso é dado pela equação 8.2 abaixo.</p>
<p><span class="math display">\[\begin{equation}
\tag{8.2}
\mathbb{E}[Y_{i}|B_i = 1] - \mathbb{E}[Y_{i}| B_i = 0]
\end{equation}\]</span></p>
<p>Veja que por enquanto estamos tratando apenas de dados observados e, portanto, não podemos falar de dados potenciais. Contudo, se a suposição de consistência for válida, podemos utilizar a equação 8.1 para conectar o factual e o contrafactual.</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\mathbb{E}[Y_{i}|B_i = 1] =  \mathbb{E}([Y_{0i} + (Y_{1i} - Y_{0i})*B_i)|B_i=1] \\

\mathbb{E}[Y_{i}|B_i = 1] =  \mathbb{E}[(Y_{0i} + (Y_{1i} - Y_{0i})*1)|B_i=1] \\

\mathbb{E}[Y_{i}|B_i = 1] =  \mathbb{E}[Y_{1i}|B_i=1]
\end{aligned}
\end{equation}\]</span></p>
<p>E, similarmente,</p>
<p><span class="math display">\[\begin{equation}
\mathbb{E}[Y_{i}|B_i = 0] =  \mathbb{E}[Y_{0i}|B_i=0]
\end{equation}\]</span></p>
<p>De modo que a equação 8.2 pode ser reescrita do seguinte modo (supondo consistência):</p>
<p><span class="math display">\[\begin{equation}
\mathbb{E}[Y_{i}|B_i = 1] - \mathbb{E}[Y_{i}| B_i = 0] =  \mathbb{E}[Y_{1i}|B_i=1] -  \mathbb{E}[Y_{0i}| B_i = 0]
\end{equation}\]</span></p>
<p>Agora, podemos utilizar aquele truque de subtrair e somar a mesma coisa que não altera a equação. Em particular, somar um resultado pottencial contrafactual, isto é, o que em média um deputado que faz parte da base do governo faria se não estivesse no governo (denotado por <span class="math inline">\(Y_{0i}|B_i = 1\)</span>). Em vermelho está o truqe matemático de subtrair e somar a mesma coisa sem alterar a equação.</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\mathbb{E}[Y_{i}|B_i = 1] - \mathbb{E}[Y_{i}| B_i = 0] =  \\
\mathbb{E}[Y_{1i}|B_i=1] \color{red}{- \mathbb{E}[Y_{0i}|B_i = 1] +  \mathbb{E}[Y_{0i}|B_i = 1]} - \mathbb{E}[Y_{0i}| B_i = 0]
\end{aligned}
\end{equation}\]</span></p>
<p>Rearranjando a equação e utilizando as propriedades do operador esperança ,temos:</p>
<p><span class="math display">\[\begin{equation}
\tag{8.3}
\begin{aligned}
\mathbb{E}[Y_{i}|B_i = 1] - \mathbb{E}[Y_{0i}|B_i=0] =  \\
\color{green}{\mathbb{E}[Y_{1i} - Y_{0i}|B_i = 1]} +  \color{blue}{\mathbb{E}[Y_{0i}|B_i = 1] - \mathbb{E}[Y_{0i}| B_i = 0]}
\end{aligned}
\end{equation}\]</span></p>
<p>A equação 8.3 apresenta em verde o que chamamos de efeito Médio do Tratamento entre as pessoas Tratadas (em inglês, <strong>Average effect of the Treatment on the Treated, ATT</strong>) e em azul o viés de seleção.
O ATT é o efeito médio porque estamos calculando a média (esperança), do efeito do Tratamento por causa do termo <span class="math inline">\(Y_{1i} - Y_{0i}\)</span>, e entre as pessoas Tratadas, isto é, que pertencem à base do governo, por que condiciona em <span class="math inline">\(B_i = 1\)</span>.</p>
<p>E a parte em azul é o viés de seleção porque reflete a diferença média (no percentual de votos seguindo o governo) entre as pessoas que escolheram ser da base do governo <span class="math inline">\(|B_i = 1\)</span> e as que escolheram não ser <span class="math inline">\(|B_i = 0\)</span> no mundo de resultados potenciais em que ambos não foram tratados (<span class="math inline">\(Y_{0i}\)</span>). Ou seja, se pudéssemos observar o mundo contrafactual em que deputados da base estão fora do governo e computar o percentual médio de voto deles seguindo o governo, e comparar com o observado para os deputados fora da base, se houver diferença, isso é o viés de seleção.</p>
<p>Quando o viés de seleção é diferente de zero, então a nossa comparação ingênua da diferença média de comportamento entre governo e oposição não recupera o efeito causal médio. Por exemplo, se deputados de esquerda possuem maior chance de fazer parte do governo Lula e, pelo fato de serem mais próximos ideologicamente, tendem a votar com o governo por esse motivo, então teriam um comportamento médio diferente da oposição, mesmo se não estivessem na base do governo. Nesse exemplo, a diferença média entre governo e oposição superestima o efeito causal médio de ser da base do governo.</p>
<p>Esse resultado permite visualizar também porque, em um contexto experimental, podemos garantir que o viés de seleção é zero em média. Se cada pessoa é atribuída ao tratamento ou controle aleatoriamente (exemplo fictício, se der cara, é da base do governo, se der coroa, não é da base), então não há diferença média entre um grupo e outro. Obviamente, temos de supor que há compliance perfeito (isto é, um Bolsonarista alocado aleatorimnte para compor o governo deveria aceitar fazê-lo e, similarmente, um petista alocado na oposição deveria aceitar isso e serem ambos tratados assim pelo governo). Quando o compliance não é perfeito, há formas de tratar isso, mas se torna mais complicado.</p>
<p>Em estudos observacionais, o mecanismo de alocação de pessoas entre tratamento e controle não está sob controle do pesquisador e, portanto, não podemos garantir que o viés de seleção é zero. Em um contexto dos assim chamados experimentos naturais ou quase experimentos, a aleatorização existe, mas não é feita pelo pesquisador (caso de uma política governamental usada segundo alguma regra aleatória, como no caso do <strong>draft do Vietnam</strong>) ou a aleatorização não existe, mas é plausível supor que, para um certo subconjunto dos dados, a alocação entre tratamento e controle é como se fosse aleatório (exemplo, quando da introdução da urna eletrônica de acordo com tamanho da população, cidades com um eleitor acima do ponto de corte versus com um abaixo possui diferença aleatória em relação a, por exemplo, percentual de votos nulos. Então é possível estimar o efeito causal da urna eletrônica sobre percentual de votos nulos nesse subgrupo de cidades próximas do ponto de corte).</p>
<p>E em contextos mais gerais de estudos observacionais, para além de contextos quasi-experimentais, o efeito causal só pode ser recuperado (identificado) se a suposição de <strong>Conditional Independence Assumption</strong> (CIA) for válida. Essa suposição diz que, condicional a variáveis de controle, não há relação entre a alocação de tratamento e os resultados potenciais. No nosso exemplo, isso significa que, condicional a, por exemplo, a ideologia do deputado, não há correlação entre alocação para tratamento e controle e resultados potenciais. Ou seja, o viés de seleção seria zero em média. Se houver alguma variável que causa quem éselecionado (ou se seleciona) entre tratamento e controle e tmbém causa os resultados potenciais, o viés de seleção não é zero e o efeito causal não é estimável. Por exemplo, digamos que a execução de emendas parlamentares fosse diferente entre governo e oposição e que essa variável também influencia a votação. Ao não controlar para essa variável, a suposição de CIA não é atendida.</p>
</div>
</div>
<div id="modelo-estrutural-e-modelo-de-regressão" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Modelo estrutural e modelo de regressão<a href="causalidade.html#modelo-estrutural-e-modelo-de-regressão" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A distinção entre CEF e CEF causal é um ponto muito importante mas no geral negligenciado. Chen &amp; Pearl (2013), ao avaliaram livros de econometria, notaram que a maioria não fazia a distinção adequada entre modelo de regressão e modelo estrutural de regressão. Como a compreensão desse ponto é crítica para qualquer análise causal com regressão e frequentemente não feita, quero insistir nesse aspecto.</p>
<p>Vamos recapitular o que nós aprendemos sobre regressão e sobre causalidade.</p>
<p>O erro da regressão (na população) é definido como a diferença entre o <span class="math inline">\(Y\)</span> observado e a esperança condicional <span class="math inline">\(\mathbb{E}[Y|X]\)</span>. Uma consequência dessa definição é que o erro é não correlacionado com o regressor <span class="math inline">\(X\)</span>, sejam os dados observacionais ou não.</p>
<p>A regressão linear pode ser jusitifcada de três modos distintos: 1. se a CEF for linear (como em um modelo saturado); 2. se queremos minimizar o erro quadrático médio das previsões; 3. é a melhor aproximação linear que existe para a CEF, seja linear ou não.</p>
<p>Em estudos observacionais, a análise de regressão linear identifica o modelo causal se o viés de seleção for zero. Isso requer que a suposição de indepenência (ou independência condicional) seja verdade, isto é, que a correlação entre o erro e os regressores seja zero. Ou seja, é uma suposição do modelo (e não uma propriedade ou consequência da definição do erro).</p>
<p>Para a suposição ser plausível, precisamos ter um modelo estrutural (como o de Resultados Potenciais) em que seja plausível (é uma suposição não testável) a independência condicional.</p>
<p>Muitos livros textos de regressão não diferenciam as propriedades da CEF e as suposições de um modelo estrutural (causal). Vamos ilustrar, por meio de um exemplo, o ponto de como é possível o erro da CEF ser não correlacionado com o regressor e o modelo estrutural ter erro e regressor correlacionados (e portanto a causalidade não identificada se não controlarmos para variável que garanta independência condicional.</p>
<div id="exemplo-de-cef-e-cef-estrutural" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Exemplo de CEF e CEF estrutural<a href="causalidade.html#exemplo-de-cef-e-cef-estrutural" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suponha que estou interessado em estimar o efeito causal de uma variável, que vou designar por tratamento. Meus dados são observacionais e há viés de seleção nos dados. Uma outra variável, <span class="math inline">\(X\)</span>, causa tanto o tratamento quando minha variável dependente, <span class="math inline">\(Y\)</span>. Porém, condicional a <span class="math inline">\(X\)</span>, o tratamento é independente dos resultados potenciais, ou seja, é válida a suposição de independência condicional. Vou mostrar que a o erro da CEF é independente dos regressores e, por outro lado, uma regressão sem controlar para <span class="math inline">\(X\)</span> tem resíduo correlacionado com o regressor e, portanto, não identifica o efeito causal. Por fim, uma regressão que controle para <span class="math inline">\(X\)</span> identifica o efeito causal.</p>
<p>Chen, B., &amp; Pearl, J. (2013). Regression and causation: a critical examination of six econometrics textbooks. Real-World Economics Review, Issue, (65), 2-20.</p>
</div>
</div>
<div id="simulação-de-resultados-potenciais-e-causalidade" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Simulação de Resultados Potenciais e Causalidade<a href="causalidade.html#simulação-de-resultados-potenciais-e-causalidade" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos rodar uma simulação
Fonte da simulação: <a href="https://stats.stackexchange.com/questions/554113/potential-outcomes-selection-bias" class="uri">https://stats.stackexchange.com/questions/554113/potential-outcomes-selection-bias</a></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="causalidade.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb101-2"><a href="causalidade.html#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="causalidade.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># U affects both treatment and outcome (Y). </span></span>
<span id="cb101-4"><a href="causalidade.html#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="causalidade.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation #</span></span>
<span id="cb101-6"><a href="causalidade.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb101-7"><a href="causalidade.html#cb101-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb101-8"><a href="causalidade.html#cb101-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">1</span>, <span class="dv">1</span>) <span class="co"># generate latent variable affecting treatment selection</span></span>
<span id="cb101-9"><a href="causalidade.html#cb101-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">plogis</span>(u)) <span class="co"># treatment</span></span>
<span id="cb101-10"><a href="causalidade.html#cb101-10" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb101-11"><a href="causalidade.html#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="causalidade.html#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># homogenous causal effect #</span></span>
<span id="cb101-13"><a href="causalidade.html#cb101-13" aria-hidden="true" tabindex="-1"></a>causal_effect <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb101-14"><a href="causalidade.html#cb101-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-15"><a href="causalidade.html#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Y(0)</span></span>
<span id="cb101-16"><a href="causalidade.html#cb101-16" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">=</span> u <span class="sc">+</span> e</span>
<span id="cb101-17"><a href="causalidade.html#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Y(1)</span></span>
<span id="cb101-18"><a href="causalidade.html#cb101-18" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> causal_effect <span class="sc">+</span> u <span class="sc">+</span> e</span>
<span id="cb101-19"><a href="causalidade.html#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed Y</span></span>
<span id="cb101-20"><a href="causalidade.html#cb101-20" aria-hidden="true" tabindex="-1"></a>yobs <span class="ot">=</span> d<span class="sc">*</span>causal_effect <span class="sc">+</span> u <span class="sc">+</span> e</span>
<span id="cb101-21"><a href="causalidade.html#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb101-22"><a href="causalidade.html#cb101-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(u, d, y0, y1, yobs)</span>
<span id="cb101-23"><a href="causalidade.html#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb101-24"><a href="causalidade.html#cb101-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-25"><a href="causalidade.html#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="co"># individual causal effect #</span></span>
<span id="cb101-26"><a href="causalidade.html#cb101-26" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>y1y0 <span class="ot">=</span> df<span class="sc">$</span>y1 <span class="sc">-</span> df<span class="sc">$</span>y0</span>
<span id="cb101-27"><a href="causalidade.html#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="co"># grand mean #</span></span>
<span id="cb101-28"><a href="causalidade.html#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df<span class="sc">$</span>y1y0)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="causalidade.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATT / ATC #</span></span>
<span id="cb103-2"><a href="causalidade.html#cb103-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(d) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y1 <span class="sc">-</span> y0))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##       d `mean(y1 - y0)`
##   &lt;int&gt;           &lt;dbl&gt;
## 1     0               2
## 2     1               2</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="causalidade.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># naive group comparison #</span></span>
<span id="cb105-2"><a href="causalidade.html#cb105-2" aria-hidden="true" tabindex="-1"></a>naive_group_comparison <span class="ot">=</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(d) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">m =</span> <span class="fu">mean</span>(yobs)) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(m[d <span class="sc">==</span> <span class="dv">1</span>] <span class="sc">-</span> m[d <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb105-3"><a href="causalidade.html#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="causalidade.html#cb105-4" aria-hidden="true" tabindex="-1"></a>naive_group_comparison</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   `m[d == 1] - m[d == 0]`
##                     &lt;dbl&gt;
## 1                    2.76</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="causalidade.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ATT</span></span>
<span id="cb107-2"><a href="causalidade.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(1) Y(0) | D =1</span><span class="st">`</span> <span class="ot">=</span> df[df<span class="sc">$</span>d<span class="sc">==</span><span class="dv">1</span>,] <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y1 <span class="sc">-</span> y0))</span>
<span id="cb107-3"><a href="causalidade.html#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="causalidade.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ATC</span></span>
<span id="cb107-5"><a href="causalidade.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(1) Y(0) | D =0</span><span class="st">`</span> <span class="ot">=</span> df[df<span class="sc">$</span>d<span class="sc">==</span><span class="dv">0</span>,] <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y1 <span class="sc">-</span> y0))</span>
<span id="cb107-6"><a href="causalidade.html#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="causalidade.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># unobserved quantities #</span></span>
<span id="cb107-8"><a href="causalidade.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(0) | D =1</span><span class="st">`</span> <span class="ot">=</span> df[df<span class="sc">$</span>d<span class="sc">==</span><span class="dv">1</span>,] <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y0))</span>
<span id="cb107-9"><a href="causalidade.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(1) | D =0</span><span class="st">`</span> <span class="ot">=</span> df[df<span class="sc">$</span>d<span class="sc">==</span><span class="dv">0</span>,] <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y1))</span>
<span id="cb107-10"><a href="causalidade.html#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="causalidade.html#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co"># observed</span></span>
<span id="cb107-12"><a href="causalidade.html#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(1) | D =1</span><span class="st">`</span> <span class="ot">=</span> df[df<span class="sc">$</span>d<span class="sc">==</span><span class="dv">1</span>,] <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y1))</span>
<span id="cb107-13"><a href="causalidade.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(0) | D =0</span><span class="st">`</span> <span class="ot">=</span> df[df<span class="sc">$</span>d<span class="sc">==</span><span class="dv">0</span>,] <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(y0))</span>
<span id="cb107-14"><a href="causalidade.html#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="causalidade.html#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ATT</span></span>
<span id="cb107-16"><a href="causalidade.html#cb107-16" aria-hidden="true" tabindex="-1"></a>selection_bias_1 <span class="ot">=</span> <span class="st">`</span><span class="at">Y(0) | D =1</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Y(0) | D =0</span><span class="st">`</span></span>
<span id="cb107-17"><a href="causalidade.html#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ATT + selection bias 1 #</span></span>
<span id="cb107-18"><a href="causalidade.html#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(1) Y(0) | D =1</span><span class="st">`</span> <span class="sc">+</span> selection_bias_1</span></code></pre></div>
<pre><code>##   mean(y1 - y0)
## 1      2.757471</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="causalidade.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We get the correct result as </span></span>
<span id="cb109-2"><a href="causalidade.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># naive_group_comparison</span></span>
<span id="cb109-3"><a href="causalidade.html#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="causalidade.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ATC</span></span>
<span id="cb109-5"><a href="causalidade.html#cb109-5" aria-hidden="true" tabindex="-1"></a>selection_bias_2 <span class="ot">=</span> <span class="st">`</span><span class="at">Y(1) | D =0</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Y(1) | D =1</span><span class="st">`</span></span>
<span id="cb109-6"><a href="causalidade.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ATC + selection bias 1 #</span></span>
<span id="cb109-7"><a href="causalidade.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Y(1) Y(0) | D =1</span><span class="st">`</span> <span class="sc">+</span> selection_bias_2</span></code></pre></div>
<pre><code>##   mean(y1 - y0)
## 1      1.242529</code></pre>

</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="estimação.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mgaldino/book-regression/edit/main/08-Causalidade.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mgaldino/book-regression/blob/main/08-Causalidade.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
