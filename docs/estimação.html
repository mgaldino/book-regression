<!DOCTYPE html>
<html lang="pt" xml:lang="pt">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais</title>
  <meta name="description" content="Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2025-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cef-1.html"/>
<link rel="next" href="causalidade.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Regressão</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="07-estimacao.html"><a href="#pref%C3%A1cio"><i class="fa fa-check"></i><b>1</b> - Prefácio</a></li>
<li class="chapter" data-level="2" data-path="07-estimacao.html"><a href="#revis%C3%A3o-de-r"><i class="fa fa-check"></i><b>2</b> - Revisão de R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html"><i class="fa fa-check"></i><b>2.1</b> R e Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-como-calculadora"><i class="fa fa-check"></i><b>2.2</b> R como calculadora</a></li>
<li class="chapter" data-level="2.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#objetos-no-r"><i class="fa fa-check"></i><b>2.3</b> Objetos no R</a></li>
<li class="chapter" data-level="2.4" data-path="revisão-de-r.html"><a href="revisão-de-r.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.4</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#numeric"><i class="fa fa-check"></i><b>2.4.1</b> Numeric</a></li>
<li class="chapter" data-level="2.4.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#character"><i class="fa fa-check"></i><b>2.4.2</b> character</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="revisão-de-r.html"><a href="revisão-de-r.html#armazenando-dados"><i class="fa fa-check"></i><b>2.5</b> Armazenando dados</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#vetor"><i class="fa fa-check"></i><b>2.5.1</b> Vetor</a></li>
<li class="chapter" data-level="2.5.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#matriz"><i class="fa fa-check"></i><b>2.5.2</b> Matriz</a></li>
<li class="chapter" data-level="2.5.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-frame"><i class="fa fa-check"></i><b>2.5.3</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="revisão-de-r.html"><a href="revisão-de-r.html#bibliotecaspacotes"><i class="fa fa-check"></i><b>2.6</b> Bibliotecas/pacotes</a></li>
<li class="chapter" data-level="2.7" data-path="revisão-de-r.html"><a href="revisão-de-r.html#importando-dados"><i class="fa fa-check"></i><b>2.7</b> importando dados</a></li>
<li class="chapter" data-level="2.8" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-wrangling"><i class="fa fa-check"></i><b>2.8</b> Data wrangling</a></li>
<li class="chapter" data-level="2.9" data-path="07-estimacao.html"><a href="#visualiza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.9</b> Visualização</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="07-estimacao.html"><a href="#revis%C3%A3o-de-estat%C3%ADstica-e-probabilidade"><i class="fa fa-check"></i><b>3</b> - Revisão de estatística e probabilidade</a>
<ul>
<li class="chapter" data-level="3.1" data-path="07-estimacao.html"><a href="#vari%C3%A1vel-aleat%C3%B3ria"><i class="fa fa-check"></i><b>3.1</b> Variável Aleatória</a></li>
<li class="chapter" data-level="3.2" data-path="07-estimacao.html"><a href="#esperan%C3%A7a-matem%C3%A1tica"><i class="fa fa-check"></i><b>3.2</b> Esperança matemática</a></li>
<li class="chapter" data-level="3.3" data-path="07-estimacao.html"><a href="#vari%C3%A2ncia"><i class="fa fa-check"></i><b>3.3</b> Variância</a></li>
<li class="chapter" data-level="3.4" data-path="07-estimacao.html"><a href="#%C3%A1lgebra-com-esperan%C3%A7a-vari%C3%A2ncia-e-covari%C3%A2ncia"><i class="fa fa-check"></i><b>3.4</b> Álgebra com Esperança, Variância e Covariância</a></li>
<li class="chapter" data-level="3.5" data-path="07-estimacao.html"><a href="#prova-da-identidade-da-vari%C3%A2ncia"><i class="fa fa-check"></i><b>3.5</b> Prova da identidade da variância</a></li>
<li class="chapter" data-level="3.6" data-path="07-estimacao.html"><a href="#distribui%C3%A7%C3%A3o-de-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.6</b> Distribuição de Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.7" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html"><i class="fa fa-check"></i><b>3.7</b> Probabilidade Condicional</a></li>
<li class="chapter" data-level="3.8" data-path="07-estimacao.html"><a href="#esperan%C3%A7a-condicional"><i class="fa fa-check"></i><b>3.8</b> Esperança Condicional</a></li>
<li class="chapter" data-level="3.9" data-path="07-estimacao.html"><a href="#proje%C3%A7%C3%A3o-linear"><i class="fa fa-check"></i><b>3.9</b> Projeção Linear</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="07-estimacao.html"><a href="#adi%C3%A7%C3%A3o-de-vetores"><i class="fa fa-check"></i><b>3.9.1</b> Adição de vetores</a></li>
<li class="chapter" data-level="3.9.2" data-path="07-estimacao.html"><a href="#proje%C3%A7%C3%A3o-linear-1"><i class="fa fa-check"></i><b>3.9.2</b> Projeção linear</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="07-estimacao.html"><a href="#introdu%C3%A7%C3%A3o-%C3%A0-simula%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4</b> Introdução à Simulação</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html"><i class="fa fa-check"></i><b>4.1</b> Objetivos</a></li>
<li class="chapter" data-level="4.2" data-path="07-estimacao.html"><a href="#introdu%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4.2</b> Introdução</a></li>
<li class="chapter" data-level="4.3" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#dgp-processo-gerador-de-dados"><i class="fa fa-check"></i><b>4.3</b> DGP — Processo Gerador de Dados</a></li>
<li class="chapter" data-level="4.4" data-path="07-estimacao.html"><a href="#simula%C3%A7%C3%A3o-de-monte-carlo"><i class="fa fa-check"></i><b>4.4</b> Simulação de Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simulando-um-dado"><i class="fa fa-check"></i><b>4.4.1</b> Simulando um dado</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="07-estimacao.html"><a href="#configura%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4.5</b> Configuração</a></li>
<li class="chapter" data-level="4.6" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simular"><i class="fa fa-check"></i><b>4.6</b> Simular</a></li>
<li class="chapter" data-level="4.7" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#resumir"><i class="fa fa-check"></i><b>4.7</b> Resumir</a></li>
<li class="chapter" data-level="4.8" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#lgn-e-tcl"><i class="fa fa-check"></i><b>4.8</b> LGN e TCL</a></li>
<li class="chapter" data-level="4.9" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#cobertura-de-um-ic"><i class="fa fa-check"></i><b>4.9</b> Cobertura de um IC</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="07-estimacao.html"><a href="#o-modelo-de-regress%C3%A3o"><i class="fa fa-check"></i><b>5</b> O Modelo de Regressão</a>
<ul>
<li class="chapter" data-level="5.1" data-path="07-estimacao.html"><a href="#modelo-de-regress%C3%A3o---teoria"><i class="fa fa-check"></i><b>5.1</b> Modelo de Regressão - Teoria</a></li>
<li class="chapter" data-level="5.2" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html"><i class="fa fa-check"></i><b>5.2</b> CEF</a></li>
<li class="chapter" data-level="5.3" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#cef-e-voto"><i class="fa fa-check"></i><b>5.3</b> CEF e voto</a></li>
<li class="chapter" data-level="5.4" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#algumas-propriedades-da-cef"><i class="fa fa-check"></i><b>5.4</b> Algumas Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="07-estimacao.html"><a href="#cef-%C3%A9-a-melhor-aproxima%C3%A7%C3%A3o-aos-dados"><i class="fa fa-check"></i><b>5.4.1</b> CEF é a melhor aproximação aos dados</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="07-estimacao.html"><a href="#regress%C3%A3o-linear"><i class="fa fa-check"></i><b>5.5</b> Regressão Linear</a></li>
<li class="chapter" data-level="5.6" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#logaritmos"><i class="fa fa-check"></i><b>5.6</b> Logaritmos</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="07-estimacao.html"><a href="#logartimos-como-diferen%C3%A7a-de-porcentagens"><i class="fa fa-check"></i><b>5.6.1</b> Logartimos como diferença de porcentagens</a></li>
<li class="chapter" data-level="5.6.2" data-path="07-estimacao.html"><a href="#logaritmos-e-m%C3%A9dia-geom%C3%A9trica"><i class="fa fa-check"></i><b>5.6.2</b> Logaritmos e média geométrica</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="07-estimacao.html"><a href="#prevendo-a-partir-da-esperan%C3%A7a-condicional"><i class="fa fa-check"></i><b>5.7</b> Prevendo a partir da esperança condicional</a></li>
<li class="chapter" data-level="5.8" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#preditores-lineares"><i class="fa fa-check"></i><b>5.8</b> Preditores lineares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cef-1.html"><a href="cef-1.html"><i class="fa fa-check"></i><b>6</b> - CEF</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cef-1.html"><a href="cef-1.html#erro-da-cef"><i class="fa fa-check"></i><b>6.1</b> Erro da CEF</a></li>
<li class="chapter" data-level="6.2" data-path="cef-1.html"><a href="cef-1.html#simulando-para-entender-a-cef"><i class="fa fa-check"></i><b>6.2</b> Simulando para entender a CEF</a></li>
<li class="chapter" data-level="6.3" data-path="cef-1.html"><a href="cef-1.html#propriedades-da-cef"><i class="fa fa-check"></i><b>6.3</b> Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="07-estimacao.html"><a href="#a-esperan%C3%A7a-do-erro-condicional-a-x-%C3%A9-zero"><i class="fa fa-check"></i><b>6.3.1</b> A Esperança do Erro Condicional a X é zero</a></li>
<li class="chapter" data-level="6.3.2" data-path="07-estimacao.html"><a href="#a-esperan%C3%A7a-n%C3%A3o-condicional-do-erro-%C3%A9-zero."><i class="fa fa-check"></i><b>6.3.2</b> A esperança (não-condicional) do erro é zero.</a></li>
<li class="chapter" data-level="6.3.3" data-path="07-estimacao.html"><a href="#o-erro-da-cef-%C3%A9-n%C3%A3o-correlacionado-com-x"><i class="fa fa-check"></i><b>6.3.3</b> O erro da CEF é não-correlacionado com X</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="07-estimacao.html"><a href="#regress%C3%A3o-linear-e-a-cef"><i class="fa fa-check"></i><b>6.4</b> Regressão Linear e a CEF</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="07-estimacao.html"><a href="#m%C3%ADnimos-quadrados-ordin%C3%A1rios"><i class="fa fa-check"></i><b>6.4.1</b> Mínimos Quadrados Ordinários</a></li>
<li class="chapter" data-level="6.4.2" data-path="07-estimacao.html"><a href="#suponha-que-a-cef-%C3%A9-linear-justificativa-i"><i class="fa fa-check"></i><b>6.4.2</b> Suponha que a CEF é Linear (Justificativa I)</a></li>
<li class="chapter" data-level="6.4.3" data-path="07-estimacao.html"><a href="#%C3%A9-o-melhor-preditor-linear-do-y-justificativa-ii"><i class="fa fa-check"></i><b>6.4.3</b> É o melhor preditor linear do <span class="math inline">\(Y\)</span> (justificativa II)</a></li>
<li class="chapter" data-level="6.4.4" data-path="07-estimacao.html"><a href="#a-reta-de-regress%C3%A3o-%C3%A9-a-aproxima%C3%A7%C3%A3o-com-o-menor-erro-quadr%C3%A1tico-m%C3%A9dio-justificativa-iii"><i class="fa fa-check"></i><b>6.4.4</b> A reta de regressão é a aproximação com o menor erro quadrático médio (justificativa III)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cef-1.html"><a href="cef-1.html#linearidade-e-causalidade"><i class="fa fa-check"></i><b>6.5</b> Linearidade e Causalidade</a></li>
<li class="chapter" data-level="6.6" data-path="07-estimacao.html"><a href="#modelo-s%C3%B3-com-intercepto"><i class="fa fa-check"></i><b>6.6</b> Modelo só com intercepto</a></li>
<li class="chapter" data-level="6.7" data-path="07-estimacao.html"><a href="#vari%C3%A2ncia-da-regress%C3%A3o"><i class="fa fa-check"></i><b>6.7</b> Variância da Regressão</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="cef-1.html"><a href="cef-1.html#chuva-na-jamaica"><i class="fa fa-check"></i><b>6.7.1</b> Chuva na Jamaica</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="07-estimacao.html"><a href="#vari%C3%A2ncia-condicional"><i class="fa fa-check"></i><b>6.8</b> Variância condicional</a></li>
<li class="chapter" data-level="6.9" data-path="cef-1.html"><a href="cef-1.html#efeito-marginal"><i class="fa fa-check"></i><b>6.9</b> Efeito Marginal</a></li>
<li class="chapter" data-level="6.10" data-path="07-estimacao.html"><a href="#cef-linear-com-preditores-n%C3%A3o-lineares"><i class="fa fa-check"></i><b>6.10</b> CEF linear com preditores não-lineares</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-estimacao.html"><a href="#estima%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7</b> - Estimação</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimação.html"><a href="estimação.html"><i class="fa fa-check"></i><b>7.1</b> Plug-in estimators</a></li>
<li class="chapter" data-level="7.2" data-path="estimação.html"><a href="estimação.html#simulando-de-uma-normal-bivariada"><i class="fa fa-check"></i><b>7.2</b> Simulando de uma Normal Bivariada</a></li>
<li class="chapter" data-level="7.3" data-path="07-estimacao.html"><a href="#suposi%C3%A7%C3%B5es-amostrais-de-mqo"><i class="fa fa-check"></i><b>7.3</b> Suposições amostrais de MQO</a></li>
<li class="chapter" data-level="7.4" data-path="07-estimacao.html"><a href="#modelo-de-m%C3%A9dia-amostral"><i class="fa fa-check"></i><b>7.4</b> Modelo de Média amostral</a></li>
<li class="chapter" data-level="7.5" data-path="07-estimacao.html"><a href="#modelo-de-regress%C3%A3o-linear-com-preditores"><i class="fa fa-check"></i><b>7.5</b> Modelo de Regressão Linear com preditores</a></li>
<li class="chapter" data-level="7.6" data-path="07-estimacao.html"><a href="#estimando-um-modelo-de-regress%C3%A3o-real"><i class="fa fa-check"></i><b>7.6</b> Estimando um modelo de regressão real</a></li>
<li class="chapter" data-level="7.7" data-path="07-estimacao.html"><a href="#limita%C3%A7%C3%B5es-de-mqo"><i class="fa fa-check"></i><b>7.7</b> Limitações de MQO</a></li>
<li class="chapter" data-level="7.8" data-path="07-estimacao.html"><a href="#distra%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>7.8</b> Distrações</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="estimação.html"><a href="estimação.html#r-quadrado"><i class="fa fa-check"></i><b>7.8.1</b> R-quadrado</a></li>
<li class="chapter" data-level="7.8.2" data-path="estimação.html"><a href="estimação.html#r-quadrado-ajustado"><i class="fa fa-check"></i><b>7.8.2</b> R-quadrado ajustado</a></li>
<li class="chapter" data-level="7.8.3" data-path="estimação.html"><a href="estimação.html#limites-do-r-quadrado"><i class="fa fa-check"></i><b>7.8.3</b> Limites do R-quadrado</a></li>
<li class="chapter" data-level="7.8.4" data-path="estimação.html"><a href="estimação.html#para-que-serve"><i class="fa fa-check"></i><b>7.8.4</b> Para que serve?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="causalidade.html"><a href="causalidade.html"><i class="fa fa-check"></i><b>8</b> - Causalidade</a>
<ul>
<li class="chapter" data-level="8.1" data-path="causalidade.html"><a href="causalidade.html#resultados-potenciais"><i class="fa fa-check"></i><b>8.1</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="07-estimacao.html"><a href="#decomposi%C3%A7%C3%A3o-do-efeito-causal"><i class="fa fa-check"></i><b>8.1.1</b> Decomposição do Efeito Causal</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="07-estimacao.html"><a href="#modelo-estrutural-e-modelo-de-regress%C3%A3o"><i class="fa fa-check"></i><b>8.2</b> Modelo estrutural e modelo de regressão</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="causalidade.html"><a href="causalidade.html#exemplo-de-cef-e-cef-estrutural"><i class="fa fa-check"></i><b>8.2.1</b> Exemplo de CEF e CEF estrutural</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="07-estimacao.html"><a href="#simula%C3%A7%C3%A3o-de-resultados-potenciais-e-causalidade"><i class="fa fa-check"></i><b>8.3</b> Simulação de Resultados Potenciais e Causalidade</a></li>
<li class="chapter" data-level="8.4" data-path="07-estimacao.html"><a href="#refer%C3%AAncias"><i class="fa fa-check"></i><b>8.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mle.html"><a href="mle.html"><i class="fa fa-check"></i><b>9</b> - MLE</a>
<ul>
<li class="chapter" data-level="9.1" data-path="07-estimacao.html"><a href="#estima%C3%A7%C3%A3o-por-m%C3%A1xima-verossimilhan%C3%A7a"><i class="fa fa-check"></i><b>9.1</b> Estimação por Máxima Verossimilhança</a></li>
<li class="chapter" data-level="9.2" data-path="07-estimacao.html"><a href="#teste-de-hip%C3%B3tese"><i class="fa fa-check"></i><b>9.2</b> Teste de hipótese</a></li>
<li class="chapter" data-level="9.3" data-path="07-estimacao.html"><a href="#regress%C3%A3o"><i class="fa fa-check"></i><b>9.3</b> regressão</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="checagem.html"><a href="checagem.html"><i class="fa fa-check"></i><b>10</b> - Checagem</a>
<ul>
<li class="chapter" data-level="10.1" data-path="07-estimacao.html"><a href="#res%C3%ADduos"><i class="fa fa-check"></i><b>10.1</b> Resíduos</a></li>
<li class="chapter" data-level="10.2" data-path="checagem.html"><a href="checagem.html#modelo-no-r"><i class="fa fa-check"></i><b>10.2</b> Modelo no R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="07-estimacao.html"><a href="#res%C3%ADduos-contra-o-preditor"><i class="fa fa-check"></i><b>10.2.1</b> Resíduos contra o preditor</a></li>
<li class="chapter" data-level="10.2.2" data-path="07-estimacao.html"><a href="#magnitude-dos-res%C3%ADduos-contra-o-preditor"><i class="fa fa-check"></i><b>10.2.2</b> Magnitude dos Resíduos Contra o Preditor</a></li>
<li class="chapter" data-level="10.2.3" data-path="07-estimacao.html"><a href="#res%C3%ADduos-com-dados-temporais-eou-espaciais"><i class="fa fa-check"></i><b>10.2.3</b> Resíduos com dados Temporais e/ou Espaciais</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="07-estimacao.html"><a href="#normalidade-dos-res%C3%ADduos"><i class="fa fa-check"></i><b>10.3</b> Normalidade dos resíduos</a></li>
<li class="chapter" data-level="10.4" data-path="07-estimacao.html"><a href="#generaliza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>10.4</b> Generalização</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inferencia.html"><a href="inferencia.html"><i class="fa fa-check"></i><b>11</b> - Inferencia</a>
<ul>
<li class="chapter" data-level="11.1" data-path="inferencia.html"><a href="inferencia.html#normal"><i class="fa fa-check"></i><b>11.1</b> Normal</a></li>
<li class="chapter" data-level="11.2" data-path="inferencia.html"><a href="inferencia.html#t-student"><i class="fa fa-check"></i><b>11.2</b> T-student</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="07-estimacao.html"><a href="#avan%C3%A7ado---deriva%C3%A7%C3%A3o-da-t--de-student"><i class="fa fa-check"></i><b>11.2.1</b> Avançado - Derivação da t- de student</a></li>
<li class="chapter" data-level="11.2.2" data-path="inferencia.html"><a href="inferencia.html#teste-t"><i class="fa fa-check"></i><b>11.2.2</b> Teste t</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="07-estimacao.html"><a href="#teste-de-hip%C3%B3tese-e-ic"><i class="fa fa-check"></i><b>11.3</b> Teste de Hipótese e IC</a></li>
<li class="chapter" data-level="11.4" data-path="07-estimacao.html"><a href="#propriedades-assint%C3%B3ticas"><i class="fa fa-check"></i><b>11.4</b> Propriedades Assintóticas</a></li>
<li class="chapter" data-level="11.5" data-path="07-estimacao.html"><a href="#infer%C3%AAncia-preditiva"><i class="fa fa-check"></i><b>11.5</b> Inferência Preditiva</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="regressao-multipla.html"><a href="regressao-multipla.html"><i class="fa fa-check"></i><b>12</b> - Regressao Multipla</a>
<ul>
<li class="chapter" data-level="12.1" data-path="07-estimacao.html"><a href="#revis%C3%A3o-de-matriz-e-vetores"><i class="fa fa-check"></i><b>12.1</b> Revisão de Matriz e Vetores</a></li>
<li class="chapter" data-level="12.2" data-path="07-estimacao.html"><a href="#modelo-b%C3%A1sico"><i class="fa fa-check"></i><b>12.2</b> Modelo básico</a></li>
<li class="chapter" data-level="12.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#modelo-com-matrizes"><i class="fa fa-check"></i><b>12.3</b> Modelo com matrizes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#estimador-de-mqo"><i class="fa fa-check"></i><b>12.3.1</b> Estimador de MQO</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="07-estimacao.html"><a href="#interpreta%C3%A7%C3%A3o-dos-coeficientes"><i class="fa fa-check"></i><b>12.4</b> Interpretação dos coeficientes</a></li>
<li class="chapter" data-level="12.5" data-path="07-estimacao.html"><a href="#regress%C3%A3o-m%C3%BAltipla-versus-m%C3%BAltiplas-regress%C3%B5es-separadas-ou-vi%C3%A9s-de-vari%C3%A1vel-omitida"><i class="fa fa-check"></i><b>12.5</b> Regressão múltipla versus Múltiplas Regressões Separadas ou Viés de variável omitida</a></li>
<li class="chapter" data-level="12.6" data-path="07-estimacao.html"><a href="#matriz-chap%C3%A9u"><i class="fa fa-check"></i><b>12.6</b> Matriz chapéu</a></li>
<li class="chapter" data-level="12.7" data-path="regressao-multipla.html"><a href="regressao-multipla.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.8" data-path="07-estimacao.html"><a href="#erro-padr%C3%A3o-robusto"><i class="fa fa-check"></i><b>12.8</b> Erro padrão Robusto</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="07-estimacao.html"><a href="#entendendo-o-erro-padr%C3%A3o-robusto"><i class="fa fa-check"></i><b>12.8.1</b> Entendendo o erro padrão robusto</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="07-estimacao.html"><a href="#termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9</b> Termo de interação</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="07-estimacao.html"><a href="#vari%C3%A2ncia-do-termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9.1</b> Variância do termo de interação</a></li>
<li class="chapter" data-level="12.9.2" data-path="07-estimacao.html"><a href="#calculando-o-erro-padr%C3%A3o-do-termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9.2</b> Calculando o erro padrão do termo de interação</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="07-estimacao.html"><a href="#an%C3%A1lise-de-sensibilidade-causal"><i class="fa fa-check"></i><b>12.10</b> Análise de sensibilidade causal</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="07-estimacao.html"><a href="#deriva%C3%A7%C3%A3o-do-r-quadrado"><i class="fa fa-check"></i><b>12.10.1</b> Derivação do R-quadrado</a></li>
<li class="chapter" data-level="12.10.2" data-path="07-estimacao.html"><a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida"><i class="fa fa-check"></i><b>12.10.2</b> Viés de variável omitida</a></li>
<li class="chapter" data-level="12.10.3" data-path="07-estimacao.html"><a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida-em-fun%C3%A7%C3%A3o-do-r-quadrado"><i class="fa fa-check"></i><b>12.10.3</b> Viés de variável omitida em função do R-quadrado</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="07-estimacao.html"><a href="#refer%C3%AAncias-1"><i class="fa fa-check"></i><b>12.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>13</b> - GLM</a>
<ul>
<li class="chapter" data-level="13.1" data-path="glm.html"><a href="glm.html#plm"><i class="fa fa-check"></i><b>13.1</b> PLM</a></li>
<li class="chapter" data-level="13.2" data-path="07-estimacao.html"><a href="#log%C3%ADstica"><i class="fa fa-check"></i><b>13.2</b> Logística</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="07-estimacao.html"><a href="#log%C3%ADstica-como-melhoria-em-rela%C3%A7%C3%A3o-ao-mpl"><i class="fa fa-check"></i><b>13.2.1</b> Logística como melhoria em relação ao MPL</a></li>
<li class="chapter" data-level="13.2.2" data-path="glm.html"><a href="glm.html#logito"><i class="fa fa-check"></i><b>13.2.2</b> Logito</a></li>
<li class="chapter" data-level="13.2.3" data-path="07-estimacao.html"><a href="#odds-ratio---raz%C3%A3o-de-chances"><i class="fa fa-check"></i><b>13.2.3</b> Odds Ratio - Razão de chances</a></li>
<li class="chapter" data-level="13.2.4" data-path="07-estimacao.html"><a href="#coeficientes-e-erros-padr%C3%B5es"><i class="fa fa-check"></i><b>13.2.4</b> Coeficientes e erros padrões</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="07-estimacao.html"><a href="#log%C3%ADstica-como-vari%C3%A1vel-latente"><i class="fa fa-check"></i><b>13.3</b> Logística como variável latente</a></li>
<li class="chapter" data-level="13.4" data-path="glm.html"><a href="glm.html#probit"><i class="fa fa-check"></i><b>13.4</b> Probit</a></li>
<li class="chapter" data-level="13.5" data-path="07-estimacao.html"><a href="#log%C3%ADstica-como-glm"><i class="fa fa-check"></i><b>13.5</b> Logística como GLM</a></li>
<li class="chapter" data-level="13.6" data-path="07-estimacao.html"><a href="#log%C3%ADstica-com-m%C3%BAltiplos-preditores"><i class="fa fa-check"></i><b>13.6</b> Logística com múltiplos preditores</a></li>
<li class="chapter" data-level="13.7" data-path="glm.html"><a href="glm.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>13.7</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="13.8" data-path="07-estimacao.html"><a href="#regress%C3%A3o-com-dados-ordenados"><i class="fa fa-check"></i><b>13.8</b> Regressão com dados Ordenados</a></li>
<li class="chapter" data-level="13.9" data-path="07-estimacao.html"><a href="#refer%C3%AAncias-2"><i class="fa fa-check"></i><b>13.9</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="07-estimacao.html"><a href="#ap%C3%AAndice"><i class="fa fa-check"></i><b>14</b> - Apêndice</a>
<ul>
<li class="chapter" data-level="14.1" data-path="07-estimacao.html"><a href="#importa%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>14.1</b> Importação</a></li>
<li class="chapter" data-level="14.2" data-path="07-estimacao.html"><a href="#gr%C3%A1ficos-e-tabelas"><i class="fa fa-check"></i><b>14.2</b> Gráficos e Tabelas</a></li>
<li class="chapter" data-level="14.3" data-path="apêndice.html"><a href="apêndice.html"><i class="fa fa-check"></i><b>14.3</b> Limpeza de dados</a></li>
<li class="chapter" data-level="14.4" data-path="apêndice.html"><a href="apêndice.html#modelagem-de-dados"><i class="fa fa-check"></i><b>14.4</b> Modelagem de dados</a></li>
<li class="chapter" data-level="14.5" data-path="apêndice.html"><a href="apêndice.html#outros"><i class="fa fa-check"></i><b>14.5</b> Outros</a></li>
<li class="chapter" data-level="14.6" data-path="07-estimacao.html"><a href="#%C3%A1lgebra-linear"><i class="fa fa-check"></i><b>14.6</b> Álgebra Linear</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="07-estimacao.html"><a href="#espa%C3%A7o-de-vetores-e-subspa%C3%A7o"><i class="fa fa-check"></i><b>14.6.1</b> Espaço de vetores e subspaço</a></li>
<li class="chapter" data-level="14.6.2" data-path="07-estimacao.html"><a href="#proje%C3%A7%C3%A3o-linear-2"><i class="fa fa-check"></i><b>14.6.2</b> Projeção linear</a></li>
<li class="chapter" data-level="14.6.3" data-path="apêndice.html"><a href="apêndice.html#load-required-libraries"><i class="fa fa-check"></i><b>14.6.3</b> 2. <strong>Load Required Libraries</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="teoremas.html"><a href="teoremas.html"><i class="fa fa-check"></i><b>15</b> - Teoremas</a>
<ul>
<li class="chapter" data-level="15.1" data-path="07-estimacao.html"><a href="#independ%C3%AAncia-e-correla%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>15.1</b> Independência e Correlação</a></li>
<li class="chapter" data-level="15.2" data-path="teoremas.html"><a href="teoremas.html#propriedade-de-estimadores"><i class="fa fa-check"></i><b>15.2</b> Propriedade de estimadores</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="07-estimacao.html"><a href="#vi%C3%A9s"><i class="fa fa-check"></i><b>15.2.1</b> Viés</a></li>
<li class="chapter" data-level="15.2.2" data-path="07-estimacao.html"><a href="#vari%C3%A2ncia-1"><i class="fa fa-check"></i><b>15.2.2</b> Variância</a></li>
<li class="chapter" data-level="15.2.3" data-path="07-estimacao.html"><a href="#efici%C3%AAncia"><i class="fa fa-check"></i><b>15.2.3</b> Eficiência</a></li>
<li class="chapter" data-level="15.2.4" data-path="07-estimacao.html"><a href="#consist%C3%AAncia"><i class="fa fa-check"></i><b>15.2.4</b> Consistência</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="07-estimacao.html"><a href="#exerc%C3%ADcios-para-o-leitor"><i class="fa fa-check"></i><b>15.3</b> Exercícios para o leitor</a></li>
<li class="chapter" data-level="15.4" data-path="07-estimacao.html"><a href="#lei-das-esperan%C3%A7as-iteradas"><i class="fa fa-check"></i><b>15.4</b> Lei das Esperanças Iteradas</a></li>
<li class="chapter" data-level="15.5" data-path="teoremas.html"><a href="teoremas.html#teorema-do-condicionamento"><i class="fa fa-check"></i><b>15.5</b> Teorema do Condicionamento</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à Regresssão para Ciências Sociais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimação" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Capítulo 7</span> - Estimação<a href="#estima%C3%A7%C3%A3o" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Nós já vimos que é possível mostrar que o preditor linear ótimo com um único regressor possui intercepto
<span class="math inline">\(\alpha = \mathbb{E}[Y] - \beta*\mathbb{E}[X]\)</span> e inclinação <span class="math inline">\(\beta = Cov(X,Y)/Var(X)\)</span>. Isso significa que, se nós considerarmos o modelo de regressão <span class="math inline">\(y_i = \alpha + \beta*x_i + e_i\)</span>, e usarmos essas fórmulas para calcular os valores de <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> em uma população, obteríamos uma reta ajustada que é o melhor preditor linear.</p>
<p>Até o momento, estávamos trabalhando com a população. Porém, na prática estaremos sempre lidando com uma amostra, de forma que precisamos entender como funciona a estimação de uma regressão a partir de uma amostra.</p>
<div id="plug-in-estimators" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Plug-in estimators<a href="estimação.html#plug-in-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se tivermos uma amostra, e não a população, é razoável pensar que uma boa estimativa para os valores populacionais de <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> são justamente essas fórmulas, calculadas para os dados amostrais. Esse estimador dos parâmetros populacionais nós chamamos de <strong>plug-in estimates</strong>, pois sem maiores teorias, assumimos que o que vale para a população vale para a amostra. Para diferenciar as estimativas amostrais dos valores populacionais, é comum usarmos <span class="math inline">\(\hat{\beta}\)</span> em vez de <span class="math inline">\(\beta\)</span>, ou então letras latinas <span class="math inline">\(b\)</span> em vez das gregas <span class="math inline">\(\beta\)</span>. Vou usar letras gregas com o “chapéu”, mas outros textos utilizam letras latinas .</p>
<p>Ou seja, <span class="math inline">\(\hat{\beta} = \frac{\sum{(x_i - \bar{x})(y_i - \bar{y})}}{\hat{\sigma_x}^2}\)</span></p>
<p>No caso da variância amostral de <span class="math inline">\(x\)</span>, também é comum designá-la por <span class="math inline">\(S_x^2\)</span>.</p>
</div>
<div id="simulando-de-uma-normal-bivariada" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Simulando de uma Normal Bivariada<a href="estimação.html#simulando-de-uma-normal-bivariada" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma distribuição de probabilidade de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> é Normal bivariada quando <span class="math inline">\(aX + bY\)</span> é Normal também, para quaisquer <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>. Para nós, importa aqui que <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> são normais cada uma, e a conjunta deles também é Normal.</p>
<p>E diferentemente da Normal univariada, preciso representar os parâmetros por meio de vetores. A média, que antes era um escalar, agora será representada por um vetor: <span class="math inline">\(\mu = (\mu_x, \mu_y)\)</span>. Mesmo que <span class="math inline">\(\mu_x = \mu_y\)</span>, ainda assim preciso representar por um vetor. E a variância também não consegue especificartudo que preciso saber sobre a variação nos dados. Eu preciso saber, a variância de <span class="math inline">\(X\)</span>, dada por <span class="math inline">\(\sigma_x\)</span>, a variância de <span class="math inline">\(Y\)</span>, <span class="math inline">\(\sigma_x\)</span> e a covariância entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> e <span class="math inline">\(Y\)</span> e <span class="math inline">\(X\)</span>, dadas respectivamente por <span class="math inline">\(\mathbb{Cov}[X,Y]\)</span> e <span class="math inline">\(\mathbb{Cov}[Y,X]\)</span>, que obviamente serão iguais. E nós representamos essas quatro informações por meio de uma matriz, chamada de matriz de covariância ou matriz de variância-covariância:</p>
<p><span class="math display">\[
\Sigma =
\begin{bmatrix}
\sigma_x &amp; \mathbb{Cov}[Y,X] \\
\mathbb{Cov}[X,Y] &amp; \sigma_y
\end{bmatrix}
\]</span>
Essa matriz precisa ser positiva-definida, que é uma característica de matrizes, mas que basicamente tem a ver com o fato de que não existe variância negativa e dadas as variâncias de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, existem limites para o que a covariância pode ser.</p>
<p>Como escolher os valores para essa matriz não é nada intuitivo, vamos trabalhar com a correlação, que temos uma noção melhor. Para isso, utilizaremos a seguinte relação:</p>
<p><span class="math display">\[
\Sigma =
\begin{bmatrix}
\sigma_x^2 &amp; \rho \cdot \sigma_x \cdot \sigma_y \\
\rho \cdot \sigma_x\cdot \sigma_y &amp; \sigma_y
\end{bmatrix}
\]</span>
Ou seja, a matriz de variância-covariância pode ser parametrizada apenas em função dos desvios-padrões e da correlação entre as duas variáveis.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="estimação.html#cb124-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb124-2"><a href="estimação.html#cb124-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb124-3"><a href="estimação.html#cb124-3" tabindex="-1"></a></span>
<span id="cb124-4"><a href="estimação.html#cb124-4" tabindex="-1"></a><span class="co"># vetor de médias</span></span>
<span id="cb124-5"><a href="estimação.html#cb124-5" tabindex="-1"></a>vetor_media <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb124-6"><a href="estimação.html#cb124-6" tabindex="-1"></a></span>
<span id="cb124-7"><a href="estimação.html#cb124-7" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb124-8"><a href="estimação.html#cb124-8" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb124-9"><a href="estimação.html#cb124-9" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb124-10"><a href="estimação.html#cb124-10" tabindex="-1"></a></span>
<span id="cb124-11"><a href="estimação.html#cb124-11" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb124-12"><a href="estimação.html#cb124-12" tabindex="-1"></a></span>
<span id="cb124-13"><a href="estimação.html#cb124-13" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb124-14"><a href="estimação.html#cb124-14" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<pre><code>## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<pre><code>## Warning in attr(x, &quot;format&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<tbody>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">2.4</td>
</tr>
<tr class="even">
<td align="right">2.4</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="estimação.html#cb127-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb127-2"><a href="estimação.html#cb127-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb127-3"><a href="estimação.html#cb127-3" tabindex="-1"></a></span>
<span id="cb127-4"><a href="estimação.html#cb127-4" tabindex="-1"></a>bivariada_tibble1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb127-5"><a href="estimação.html#cb127-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb127-6"><a href="estimação.html#cb127-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb127-7"><a href="estimação.html#cb127-7" tabindex="-1"></a></span>
<span id="cb127-8"><a href="estimação.html#cb127-8" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb127-9"><a href="estimação.html#cb127-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-normal-bivariada-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="estimação.html#cb128-1" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="estimação.html#cb128-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(y)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-normal-bivariada-2.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="estimação.html#cb129-1" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="estimação.html#cb129-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_density_2d</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-normal-bivariada-3.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="estimação.html#cb130-1" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="estimação.html#cb130-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-normal-bivariada-4.png" width="900" style="display: block; margin: auto;" /></p>
<p>Vamos usar esses dados para fazer uma regressão.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="estimação.html#cb131-1" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble1)</span>
<span id="cb131-2"><a href="estimação.html#cb131-2" tabindex="-1"></a></span>
<span id="cb131-3"><a href="estimação.html#cb131-3" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = bivariada_tibble1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7942 -1.0639 -0.0067  1.0740  6.4187 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.014913   0.015907  -0.937    0.349    
## x            0.588264   0.008073  72.870   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.591 on 9998 degrees of freedom
## Multiple R-squared:  0.3469, Adjusted R-squared:  0.3468 
## F-statistic:  5310 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>A fórmula do <span class="math inline">\(\beta\)</span> nós sabemos que depende da covariância entre as variáveis e o desvio-padrão de <span class="math inline">\(X\)</span>. Vamos então simular os dados novamente, mudando as correlações e variâncias, para entender como isso impacta a regressão a partir da fórmula da inclinação da reta.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="estimação.html#cb133-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb133-2"><a href="estimação.html#cb133-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb133-3"><a href="estimação.html#cb133-3" tabindex="-1"></a></span>
<span id="cb133-4"><a href="estimação.html#cb133-4" tabindex="-1"></a><span class="co"># vetor de médias</span></span>
<span id="cb133-5"><a href="estimação.html#cb133-5" tabindex="-1"></a>vetor_media <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb133-6"><a href="estimação.html#cb133-6" tabindex="-1"></a></span>
<span id="cb133-7"><a href="estimação.html#cb133-7" tabindex="-1"></a><span class="co"># cov menor, dp o mesmo</span></span>
<span id="cb133-8"><a href="estimação.html#cb133-8" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb133-9"><a href="estimação.html#cb133-9" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb133-10"><a href="estimação.html#cb133-10" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb133-11"><a href="estimação.html#cb133-11" tabindex="-1"></a></span>
<span id="cb133-12"><a href="estimação.html#cb133-12" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb133-13"><a href="estimação.html#cb133-13" tabindex="-1"></a></span>
<span id="cb133-14"><a href="estimação.html#cb133-14" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb133-15"><a href="estimação.html#cb133-15" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<pre><code>## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<pre><code>## Warning in attr(x, &quot;format&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<tbody>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">1.2</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="estimação.html#cb136-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb136-2"><a href="estimação.html#cb136-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb136-3"><a href="estimação.html#cb136-3" tabindex="-1"></a></span>
<span id="cb136-4"><a href="estimação.html#cb136-4" tabindex="-1"></a>bivariada_tibble2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb136-5"><a href="estimação.html#cb136-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb136-6"><a href="estimação.html#cb136-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb136-7"><a href="estimação.html#cb136-7" tabindex="-1"></a></span>
<span id="cb136-8"><a href="estimação.html#cb136-8" tabindex="-1"></a>bivariada_tibble2 <span class="sc">%&gt;%</span></span>
<span id="cb136-9"><a href="estimação.html#cb136-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-new_bivariada-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="estimação.html#cb137-1" tabindex="-1"></a><span class="co"># cov igual, dp de x maior</span></span>
<span id="cb137-2"><a href="estimação.html#cb137-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb137-3"><a href="estimação.html#cb137-3" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb137-4"><a href="estimação.html#cb137-4" tabindex="-1"></a></span>
<span id="cb137-5"><a href="estimação.html#cb137-5" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb137-6"><a href="estimação.html#cb137-6" tabindex="-1"></a></span>
<span id="cb137-7"><a href="estimação.html#cb137-7" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb137-8"><a href="estimação.html#cb137-8" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<pre><code>## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)
## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<tbody>
<tr class="odd">
<td align="right">16.0</td>
<td align="right">2.4</td>
</tr>
<tr class="even">
<td align="right">2.4</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="estimação.html#cb139-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb139-2"><a href="estimação.html#cb139-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb139-3"><a href="estimação.html#cb139-3" tabindex="-1"></a></span>
<span id="cb139-4"><a href="estimação.html#cb139-4" tabindex="-1"></a>bivariada_tibble3 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-5"><a href="estimação.html#cb139-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb139-6"><a href="estimação.html#cb139-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb139-7"><a href="estimação.html#cb139-7" tabindex="-1"></a></span>
<span id="cb139-8"><a href="estimação.html#cb139-8" tabindex="-1"></a>bivariada_tibble3 <span class="sc">%&gt;%</span></span>
<span id="cb139-9"><a href="estimação.html#cb139-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-new_bivariada-2.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="estimação.html#cb140-1" tabindex="-1"></a><span class="co"># cov maor, dp de x maior</span></span>
<span id="cb140-2"><a href="estimação.html#cb140-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">15</span></span>
<span id="cb140-3"><a href="estimação.html#cb140-3" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb140-4"><a href="estimação.html#cb140-4" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb140-5"><a href="estimação.html#cb140-5" tabindex="-1"></a></span>
<span id="cb140-6"><a href="estimação.html#cb140-6" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb140-7"><a href="estimação.html#cb140-7" tabindex="-1"></a></span>
<span id="cb140-8"><a href="estimação.html#cb140-8" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb140-9"><a href="estimação.html#cb140-9" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<pre><code>## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)
## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<tbody>
<tr class="odd">
<td align="right">16.0</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">1.2</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="estimação.html#cb142-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb142-2"><a href="estimação.html#cb142-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb142-3"><a href="estimação.html#cb142-3" tabindex="-1"></a></span>
<span id="cb142-4"><a href="estimação.html#cb142-4" tabindex="-1"></a>bivariada_tibble4 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb142-5"><a href="estimação.html#cb142-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb142-6"><a href="estimação.html#cb142-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb142-7"><a href="estimação.html#cb142-7" tabindex="-1"></a></span>
<span id="cb142-8"><a href="estimação.html#cb142-8" tabindex="-1"></a>bivariada_tibble4 <span class="sc">%&gt;%</span></span>
<span id="cb142-9"><a href="estimação.html#cb142-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap7-new_bivariada-3.png" width="900" style="display: block; margin: auto;" /></p>
<p>O R mostra os resultados da regressão desse jeito, e vamos aprender a interpretá-lo, mas vamos também apresentar em um formato mais amigável e, caso vocês utilizem o rmarkdown, poderão utilizar em trabalhos acadêmicos. Para isso, utilizaremos o pacote stargazer</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="estimação.html#cb143-1" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble2)</span>
<span id="cb143-2"><a href="estimação.html#cb143-2" tabindex="-1"></a></span>
<span id="cb143-3"><a href="estimação.html#cb143-3" tabindex="-1"></a>reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble3)</span>
<span id="cb143-4"><a href="estimação.html#cb143-4" tabindex="-1"></a></span>
<span id="cb143-5"><a href="estimação.html#cb143-5" tabindex="-1"></a>reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble4)</span></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="estimação.html#cb144-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stargazer&quot;</span>)</span>
<span id="cb144-2"><a href="estimação.html#cb144-2" tabindex="-1"></a></span>
<span id="cb144-3"><a href="estimação.html#cb144-3" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(<span class="fu">list</span>(reg1, reg2, reg3, reg4), <span class="at">type =</span>  <span class="st">&quot;html&quot;</span>, <span class="at">style =</span> <span class="st">&quot;ajps&quot;</span>,</span>
<span id="cb144-4"><a href="estimação.html#cb144-4" tabindex="-1"></a>                     <span class="at">title =</span> <span class="st">&quot;Regressão linear&quot;</span>, <span class="at">omit.stat =</span> <span class="st">&quot;f&quot;</span>,</span>
<span id="cb144-5"><a href="estimação.html#cb144-5" tabindex="-1"></a>                     <span class="at">column.labels=</span><span class="fu">c</span>(<span class="st">&quot;cov = 2.4, s_x = 2&quot;</span>, <span class="st">&quot;cov = 1.2, s_x = 2&quot;</span>, <span class="st">&quot;cov = 2.4, s_x = 4&quot;</span>, <span class="st">&quot;cov = 1.2, s_x = 4&quot;</span> ))</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Regressão linear</strong>
</caption>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
<strong>y</strong>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<strong>cov = 2.4, s= 2</strong>
</td>
<td>
<strong>cov = 1.2, s= 2</strong>
</td>
<td>
<strong>cov = 2.4, s= 4</strong>
</td>
<td>
<strong>cov = 1.2, s= 4</strong>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<strong>Model 1</strong>
</td>
<td>
<strong>Model 2</strong>
</td>
<td>
<strong>Model 3</strong>
</td>
<td>
<strong>Model 4</strong>
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
x
</td>
<td>
0.588<sup>***</sup>
</td>
<td>
0.284<sup>***</sup>
</td>
<td>
0.148<sup>***</sup>
</td>
<td>
0.073<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.008)
</td>
<td>
(0.010)
</td>
<td>
(0.005)
</td>
<td>
(0.005)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.015
</td>
<td>
-0.019
</td>
<td>
0.014
</td>
<td>
0.014
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.016)
</td>
<td>
(0.019)
</td>
<td>
(0.019)
</td>
<td>
(0.020)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
10000
</td>
<td>
10000
</td>
<td>
10000
</td>
<td>
10000
</td>
</tr>
<tr>
<td style="text-align:left">
R-squared
</td>
<td>
0.347
</td>
<td>
0.081
</td>
<td>
0.085
</td>
<td>
0.021
</td>
</tr>
<tr>
<td style="text-align:left">
Adj. R-squared
</td>
<td>
0.347
</td>
<td>
0.081
</td>
<td>
0.085
</td>
<td>
0.021
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 9998)
</td>
<td>
1.591
</td>
<td>
1.892
</td>
<td>
1.904
</td>
<td>
1.974
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="5" style="text-align:left">
<sup><em><strong></sup>p &lt; .01; <sup></strong></sup>p &lt; .05; <sup></em></sup>p &lt; .1
</td>
</tr>
</table>
</div>
<div id="suposições-amostrais-de-mqo" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Suposições amostrais de MQO<a href="#suposi%C3%A7%C3%B5es-amostrais-de-mqo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quando temos uma amostra, é comum supormos que os dados são <strong>i</strong>ndependentes e <strong>i</strong>denticamente <strong>d</strong>istribuídos, <strong>i.i.d</strong>. Esse tipo de amostra às vezes é chamada de amostra aleatória simples. Isso é tipicamente válido em dados de corte transversal (cross-section) como uma pesquisa de opinião (survey) de intenção de voto, amostra pequena (mil, dois mil) de alunos do Brasil a partir de dados doe Censo Escolar e assim por diante. O ponto é que os dados precisam ser dispersos. Se você coletar alunos de uma mesma escola, eles não tenderão a ser independentes. Se amostrar eleitores de um mesmo bairro, tampouco haverá independência. Há formas de lidar com isso, e aprenderemos mais tarde. Por enquanto, tratemos do caso mais simples.</p>
<p>A suposição de que dados são i.i.d significa que, em uma amostra com duas variáveis, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, o par <span class="math inline">\(x_i, y_i\)</span> é independente de <span class="math inline">\(x_j, y_j\)</span>, com <span class="math inline">\(i \neq j\)</span> e identicamente distribuídos, isto é, com a mesma distribuição. Essa suposição é importante para calcular a variância dos nossos estimadores, não para a estimativa pontual deles.</p>
</div>
<div id="modelo-de-média-amostral" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Modelo de Média amostral<a href="#modelo-de-m%C3%A9dia-amostral" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como vimos, o modelo de regressão mais simples é aquele sem preditores, em que <span class="math inline">\(Y = \mu + e\)</span>. O estimador de mínimos quadrados para <span class="math inline">\(\hat{\mu}\)</span> é a média amostral, <span class="math inline">\(\bar{y}\)</span>. Notem que <span class="math inline">\(\mathbb{E}[Y]\)</span> é a esperança populacional e <span class="math inline">\(\mu\)</span> é o valor da esperança, já que a esperança do erro <span class="math inline">\(e\)</span> é zero. Vamos então calcular a média de nosso estimador <span class="math inline">\(\bar{y}\)</span> e sua variância.</p>
<p><span class="math display">\[
\mathbb{E}[\bar{y}] = \mathbb{E}[\sum{y_i}/n] = (1/n) \cdot \sum{\mathbb{E}[y_i]} = (1/n)\cdot \mu \cdot n = \mu
\]</span></p>
<p>Portanto, o valor esperando do estimador de mínimos quadrados (a média amostral) é igual à média populacional. Quando isso acontece, isto é, quando a esperança de um estimador é igual ao parâmetro populacional dizemos que o estimador é não-viesado.</p>
<p>Definição 7.4. Um estimador <span class="math inline">\(\hat{\theta}\)</span> é não-viesado quando <span class="math inline">\(\mathbb{E}[\hat{\theta}] = \theta\)</span>.</p>
<p>Agora, vamos calcular a variância da média amostral sob a suposição de que a amostra é i.i.d. Considerando <span class="math inline">\(y_i = \mu + e_i\)</span>, temos:</p>
<p><span class="math display">\[
\bar{y} = \sum{y_i}/n = \sum{(\mu + e_i)}/n = \sum{\mu}/n + \sum{e_i}/n = \mu + \sum{e_i}/n
\]</span></p>
<p>Rearranjando, temos: <span class="math inline">\(\bar{y} - \mu = \sum{e_i}/n\)</span></p>
<p>A variância então pode ser calculada como:</p>
<p><span class="math display">\[
\mathbb{Var}[\bar{y}] = \mathbb{E}[(\bar{y} - \mu)^2]
\]</span>
<span class="math display">\[
= \mathbb{E}[( \sum\limits_{i=1}^n {e_i}/n)*( \sum\limits_{j=1}^n{e_j}/n)] = (1/n^2)* \sum\limits_{i=1}^n{} \sum\limits_{j=1}^n{}\mathbb{E}[e_ie_j]
\]</span>
Se nós somarmos o somatório indexado no <span class="math inline">\(j\)</span>, o primeiro erro fica constante (indexado no i) e vamos passar por todo os erros de <span class="math inline">\(1\)</span> até <span class="math inline">\(n\)</span>. Eventualmente, vamos passar por <span class="math inline">\(i\)</span> e todos os outros diferentes de <span class="math inline">\(i\)</span>. Sabendo que os erros são i.i.d, isso significa que erros diferentes são não correlacionados e possuem esperança zero, ou seja, <span class="math inline">\(\mathbb{E}[e_ie_j] = 0, i \neq j\)</span>, e erros iguais, por serem da mesma distribuição, têm <span class="math inline">\(\mathbb{E}[e_ie_i] = \sigma^2\)</span>. Então o resultado do último somatório é uma soma de zeros, exceto para o caso em que <span class="math inline">\(i = j\)</span>, em que dá <span class="math inline">\(\sigma^2\)</span>. De forma que a equação fica:</p>
<p><span class="math display">\[
(1/n^2)* \sum\limits_{i=1}^n{}\sigma^2 = (1/n^2)*n*\sigma^2 = \sigma^2/n
\]</span>
Ou seja, a variância de nosso estimador é igual à variância populacional dividida pelo tamanho da amostra. O desvio-padrão (raiz quadrada da variância) amostral do estimador também é chamada de erro padrão.</p>
</div>
<div id="modelo-de-regressão-linear-com-preditores" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Modelo de Regressão Linear com preditores<a href="#modelo-de-regress%C3%A3o-linear-com-preditores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tendo mostrado que o estimador é não-viesado e calculado a variância amostral para o caso mais simples, sem preditor, vamos agora fazer o mesmo cálculo com um preditor.</p>
<p>Vamos assumir que o modelo de regressão linear é uma boa aproximação para CEF. Portanto, vamos supor que:</p>
<ol style="list-style-type: decimal">
<li><p>O modelo linear <span class="math inline">\(y_i = \alpha + \beta*x_i + e_i\)</span> é adequado.</p></li>
<li><p><span class="math inline">\(\mathbb{E}[e|X] = 0\)</span>, isto é, o erro é não correlacionado com x.</p></li>
</ol>
<p>Para essa demonstração, vamos utilizar uma parametrização alternativa para o modelo de regressão linear em torno da média de <span class="math inline">\(x\)</span>. Para isso, vamos usar nosso truque matemático de adicionar e subtrair
Lembremos que a fórmula para o <span class="math inline">\(\hat{\beta}\)</span> é <span class="math inline">\(\mathbb{Cov}[X,Y]/\mathbb{Var}[X]\)</span>.</p>
<p>Notem que:
<span class="math display">\[
\hat{\beta} = \frac{\sum({x_i - \bar{x}}) \cdot ({y_i - \bar{y}})}{\sum({x_i - \bar{x}})^2} = \frac{\sum({x_i - \bar{x}}) \cdot ({y_i - \bar{y}})}{n \cdot S^2_x} = \frac{n^{-1}\sum({x_i - \bar{x}}) \cdot ({y_i - \bar{y}})}{\cdot S^2_x}
\]</span></p>
<p>Vamos então usar essa última parametrização para reescrever minha equação do <span class="math inline">\(\hat{\beta}\)</span> e então mostrar que ele é não-viesado e calcular sua variância.</p>
<p>Substituindo nossa equação de regressão na fórmula, temos:</p>
<p><span class="math display">\[
\hat{\beta} = \frac{n^{-1}\sum({x_i - \bar{x}}) \cdot ({y_i - \bar{y}})}{S^2_x} = \\
\frac{\sum{(x_i - \bar{x}) \cdot y_i - (x_i - \bar{x})\bar{y}}}{n \cdot S^2_x} = \\
\frac{n^{-1}\sum({x_i - \bar{x}}) \cdot y_i - \sum({x_i -\bar{x}}) \cdot\bar{y}}{S^2_x}
\]</span></p>
<p>Vamos agora usar o fato de que, para qualquer variável <span class="math inline">\(z\)</span>, a diferença média de <span class="math inline">\(z\)</span> para a média amostral de <span class="math inline">\(\bar{z}\)</span> é zero, isto é, <span class="math inline">\(n^{-1}*\sum\limits_{i=1}^n{}z_i - \bar{z} = 0\)</span></p>
<p>Por fim, segue-se disso que, para qualquer constante <span class="math inline">\(w\)</span> que não varia com <span class="math inline">\(i\)</span>, podemos escrever:
<span class="math inline">\(n^{-1} \cdot \sum\limits_{i=1}^n{}(z_i - \bar{z})*w = 0\)</span></p>
<p>Portanto, <span class="math inline">\(n^{-1} \cdot \sum({x_i -\bar{x}})*\bar{y} = 0\)</span>.</p>
<p>Logo,</p>
<p><span class="math display">\[
\hat{\beta} =  \frac{n^{-1}\sum({x - \bar{x}})*y_i}{S^2_x}
\]</span></p>
<p>Lembremos que, <span class="math inline">\(y_i = \alpha + \beta*x_i + e_i\)</span>. Se eu adicionar e subtrair <span class="math inline">\(\beta*\bar{x}\)</span> da equação, não altero ela. Utilizando esse truque e rearranjando, temos o seguinte:</p>
<p><span class="math display">\[
y_i = \alpha + \beta*X_i + e_i = \\
\alpha + \beta*\bar{x} + \beta*X_i - \beta*\bar{x} + e_i = \\
\alpha + \beta*\bar{x} + \beta*(x_i - \bar{x}) + e_i
\]</span></p>
<p>Substituindo na equação anterior, temos:</p>
<p><span class="math display">\[
\hat{\beta} =  \frac{n^{-1}\sum({x_i - \bar{x}})*(\alpha + \beta*\bar{x} + \beta*(x_i - \bar{x}) + e_i)}{S^2_x}
\]</span></p>
<p><span class="math display">\[
\hat{\beta} =  \frac{ n^{-1} \cdot (\alpha + \beta)\bar{x}\sum({x_i - \bar{x}}) + \sum({x_i - \bar{x}}) \cdot [\beta \cdot (x_i - \bar{x}) + e_i]}{S^2_x}
\]</span></p>
<p><span class="math display">\[
\hat{\beta} = \frac{ n^{-1} \cdot (\alpha + \beta) \cdot \bar{x}\sum({x_i - \bar{x}}) + n^{-1} \beta\sum(x_i - \bar{x})^2 + n^{-1} \sum({x_i - \bar{x}})*e_i} {S^2_x}
\]</span>
A primeira soma é uma constante, vezes o somatório de <span class="math inline">\(x_i\)</span> menos sua média, o que é zero. Posso então eliminar da equação, resultando em:
<span class="math display">\[
\hat{\beta} = \frac{\beta \cdot n^{-1} \cdot\sum({x_i - \bar{x}})^2 +  n^{-1}\sum({x_i - \bar{x}})*e_i}{S^2_x}
\]</span></p>
<p>Agora, a primeira soma é a variância de <span class="math inline">\(x\)</span> multiplicada por <span class="math inline">\(\beta\)</span>. Reescrevendo a equação de outro modo, temos:</p>
<p><span class="math display">\[
\hat{\beta} =  \frac{\beta \cdot \sigma^2_x}{S^2_x} + \frac{n^{-1}\sum({x_i - \bar{x}})*e_i}{S^2_x}
\]</span>
Simplificando, chegamos a:</p>
<p><span class="math display">\[
\hat{\beta} =  \beta  + \frac{n^{-1}\sum({x_i - \bar{x}})*e_i}{S^2_x}
\]</span></p>
<p>Portanto, nós mostramos que o estimador <span class="math inline">\(\hat{\beta}\)</span> pode ser decomposto no parâmetro populacional <span class="math inline">\(\beta\)</span> mais uma soma ponderada do termo de erro. Uma vez que nossa amostra é i.i.d., sabemos que é uma média ponderada dos erros não-correlacionados. Podemos agora mostrar que o estimador é não-viesado.</p>
<p>Essa interpretação dos erros como uma média ponderada é útil para nós aqui por causa do seguinte. Se eu chamar meus pesos (a ponderação) de <span class="math inline">\(a_i\)</span>, posso pensar que a esperança da média ponderada de erros não-correlacionados pode ser pensada como:</p>
<p><span class="math display">\[
\mathbb{E}[ \sum{a_i*e_i}] = \mathbb{E}[a_1 \cdot e_1 + a_2 \cdot e_2 + ... + a_n \cdot e_n] =
a_1 \cdot \mathbb{E}[e_1] + a_2 \cdot \mathbb{E}[ e_2] + ... + a_n \cdot \mathbb{E}[ e_n]
\]</span>
<span class="math display">\[
\mathbb{E}[ \sum{a_i*e_i}] = \sum{a_i} \cdot \mathbb{E}[e_i]
\]</span></p>
<p>Primeiro, lembremos nossa suposição de que <span class="math inline">\(\mathbb{E}[e|X] = 0\)</span>. Isso significa que, para qualquer valor de <span class="math inline">\(x\)</span> que eu condicionar, a esperança do erro é zero. Portanto, se a esperança do erro é sempre zero, temos:</p>
<p><span class="math display">\[
n^{-1}\sum({x_i - \bar{x}}) \cdot \mathbb{E}[e] = 0
\]</span></p>
<p><span class="math display">\[
\mathbb{E}[\hat{\beta}] = \beta +  \mathbb{E}[ \frac{ \sum({x_i - \bar{x}})*e_i}{n \cdot S^2}] = \\
\beta +\frac{\sum({x_i - \bar{x}})}{S^2_x} \cdot \mathbb{E}[e] = \beta
\]</span>
Podemos similarmente calcular a variância do nosso estimador, e mostrar que ela é a variância do erro dividida pela variância de <span class="math inline">\(x\)</span> vezes o tamanho da amostra, <span class="math inline">\(n\)</span>.</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = \mathbb{Var}[\beta +  n^{-1}\sum({x - \bar{x}})*e_i)/\mathbb{Var}[x]]
\]</span></p>
<p>Sabemos que <span class="math inline">\(\mathbb{Var}[x + a] = \mathbb{Var}[x]\)</span>. Então, podemos eliminar o <span class="math inline">\(\beta\)</span> da equação.</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = \frac{\mathbb{Var}[\frac{\sum({x - \bar{x}})*e_i}{n}]}{\mathbb{Var}[x]}
\]</span></p>
<p>Todas as observações do <span class="math inline">\(x\)</span> foram observadas e, portanto, a soma da diferença para a média é uma constante. Sabemos que <span class="math inline">\(\mathbb{Var}[x*a] = a^2\mathbb{Var}[x]\)</span>. Então:</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = (n^{-1}\sum({x - \bar{x}}))^2*\mathbb{Var}[e_i/\sigma^2_x]
\]</span></p>
<p>Supondo homocedasticidade, <span class="math inline">\(\mathbb{Var}[e_i] = \sigma^2\)</span></p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = (n^{-1}\sum({x_i - \bar{x}}))^2*\mathbb{Var}[e_i/S^2_x]
\]</span>
<span class="math display">\[
\mathbb{Var}[\hat{\beta}] = \frac{n^{-2}\sum({x_i - \bar{x}})^2}{S^4_x} \cdot \mathbb{Var}[e_i]
\]</span>
<span class="math display">\[
\mathbb{Var}[\hat{\beta}] = \frac{n^{-1}S^2_x}{S^4_x} \cdot \mathbb{Var}[e_i] = \frac{\mathbb{Var}[e_i]}{nS^2_x}
\]</span></p>
<p>Ou seja, a variância de nosso estimador é a variância do erro dividida pela variância de <span class="math inline">\(x\)</span> multiplicada pelo tamanho da amostra. Isso significa que quando mais disperso o <span class="math inline">\(Y\)</span>, maior a variância do meu estimador, quanto maior a amostra, menor a variância e, por fim, quanto mais espalhado o <span class="math inline">\(X\)</span>, menor a variância do estimador.</p>
<p>Por fim, o erro padrão de uma estimativa é apenas o desvio padrão da variância. Portanto:</p>
<p><span class="math display">\[
se(\hat{\beta}) = \frac{\sigma}{\sqrt{nS^2_x}}
\]</span></p>
</div>
<div id="estimando-um-modelo-de-regressão-real" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Estimando um modelo de regressão real<a href="#estimando-um-modelo-de-regress%C3%A3o-real" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos começar com um exemplo, importando dados do site Base de Dados, que possui muitas bases de dados públicas, já tratadas. Para tanto, precisaremos criar um projeto no Google cloud, conforme os passos aqui: <a href="https://basedosdados.github.io/mais/access_data_packages/" class="uri">https://basedosdados.github.io/mais/access_data_packages/</a></p>
<p>Depois, só escolher quais dos dados iremos olhar
<a href="https://basedosdados.org/" class="uri">https://basedosdados.org/</a></p>
<p>Escolhi mexer com dados do censo escolar</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="estimação.html#cb145-1" tabindex="-1"></a><span class="co"># instalando a biblioteca</span></span>
<span id="cb145-2"><a href="estimação.html#cb145-2" tabindex="-1"></a><span class="co"># install.packages(&#39;basedosdados&#39;)</span></span>
<span id="cb145-3"><a href="estimação.html#cb145-3" tabindex="-1"></a></span>
<span id="cb145-4"><a href="estimação.html#cb145-4" tabindex="-1"></a><span class="co"># carregando a biblioteca na sessão</span></span>
<span id="cb145-5"><a href="estimação.html#cb145-5" tabindex="-1"></a><span class="fu">library</span>(basedosdados)</span>
<span id="cb145-6"><a href="estimação.html#cb145-6" tabindex="-1"></a><span class="fu">library</span>(bigrquery)</span>
<span id="cb145-7"><a href="estimação.html#cb145-7" tabindex="-1"></a><span class="co"># para importar os dadosdiretamente no R, precisamos criar um id para acessar a base de dados</span></span>
<span id="cb145-8"><a href="estimação.html#cb145-8" tabindex="-1"></a><span class="fu">set_billing_id</span>(<span class="st">&quot;aula-reg-manoel&quot;</span>)</span>
<span id="cb145-9"><a href="estimação.html#cb145-9" tabindex="-1"></a></span>
<span id="cb145-10"><a href="estimação.html#cb145-10" tabindex="-1"></a><span class="co">#bq_auth()</span></span>
<span id="cb145-11"><a href="estimação.html#cb145-11" tabindex="-1"></a><span class="co"># se autenticação falhar</span></span>
<span id="cb145-12"><a href="estimação.html#cb145-12" tabindex="-1"></a></span>
<span id="cb145-13"><a href="estimação.html#cb145-13" tabindex="-1"></a><span class="co"># importando dados</span></span>
<span id="cb145-14"><a href="estimação.html#cb145-14" tabindex="-1"></a></span>
<span id="cb145-15"><a href="estimação.html#cb145-15" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">here</span>(<span class="st">&quot;imagens&quot;</span>, <span class="st">&quot;autenticacao base dados.jpg&quot;</span>))</span></code></pre></div>
<p><img src="imagens/autenticacao%20base%20dados.jpg" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="estimação.html#cb146-1" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&quot;SELECT * FROM `basedosdados.br_inep_censo_escolar.escola` where sigla_uf = &#39;AL&#39; and id_municipio = &#39;2704302&#39; and ano = 2019&quot;</span> </span>
<span id="cb146-2"><a href="estimação.html#cb146-2" tabindex="-1"></a>escola <span class="ot">&lt;-</span> basedosdados<span class="sc">::</span><span class="fu">read_sql</span>(query)</span>
<span id="cb146-3"><a href="estimação.html#cb146-3" tabindex="-1"></a></span>
<span id="cb146-4"><a href="estimação.html#cb146-4" tabindex="-1"></a></span>
<span id="cb146-5"><a href="estimação.html#cb146-5" tabindex="-1"></a><span class="co"># query &lt;- &quot;SELECT count(*) as contagem, id_municipio FROM `basedosdados.br_inep_censo_escolar.escola` where sigla_uf = &#39;AL&#39; and ano = 2019 group by id_municipio&quot; </span></span>
<span id="cb146-6"><a href="estimação.html#cb146-6" tabindex="-1"></a><span class="co"># escola &lt;- read_sql(query)</span></span>
<span id="cb146-7"><a href="estimação.html#cb146-7" tabindex="-1"></a></span>
<span id="cb146-8"><a href="estimação.html#cb146-8" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&quot;SELECT * FROM `basedosdados.br_inep_censo_escolar.dicionario`&quot;</span></span>
<span id="cb146-9"><a href="estimação.html#cb146-9" tabindex="-1"></a>dicionario <span class="ot">&lt;-</span> basedosdados<span class="sc">::</span><span class="fu">read_sql</span>(query)</span>
<span id="cb146-10"><a href="estimação.html#cb146-10" tabindex="-1"></a></span>
<span id="cb146-11"><a href="estimação.html#cb146-11" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&quot;SELECT * FROM `basedosdados.br_inep_censo_escolar.matricula` where sigla_uf = &#39;AL&#39; and id_municipio = &#39;2704302&#39; and ano = 2019&quot;</span></span>
<span id="cb146-12"><a href="estimação.html#cb146-12" tabindex="-1"></a></span>
<span id="cb146-13"><a href="estimação.html#cb146-13" tabindex="-1"></a>aluno <span class="ot">&lt;-</span> basedosdados<span class="sc">::</span><span class="fu">read_sql</span>(query)</span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="estimação.html#cb147-1" tabindex="-1"></a><span class="co"># dicionário de gênero e raça</span></span>
<span id="cb147-2"><a href="estimação.html#cb147-2" tabindex="-1"></a><span class="co"># dicionario %&gt;%</span></span>
<span id="cb147-3"><a href="estimação.html#cb147-3" tabindex="-1"></a><span class="co">#   dplyr::filter(id_tabela == &quot;matricula&quot;, nome_coluna %in% c(&quot;sexo&quot;, &quot;raca_cor&quot;))</span></span>
<span id="cb147-4"><a href="estimação.html#cb147-4" tabindex="-1"></a></span>
<span id="cb147-5"><a href="estimação.html#cb147-5" tabindex="-1"></a></span>
<span id="cb147-6"><a href="estimação.html#cb147-6" tabindex="-1"></a>aluno_gen <span class="ot">&lt;-</span> aluno <span class="sc">%&gt;%</span></span>
<span id="cb147-7"><a href="estimação.html#cb147-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(regular <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-8"><a href="estimação.html#cb147-8" tabindex="-1"></a>  <span class="fu">group_by</span>(id_escola, sexo) <span class="sc">%&gt;%</span></span>
<span id="cb147-9"><a href="estimação.html#cb147-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_aluno_gen =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb147-10"><a href="estimação.html#cb147-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">gsub</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;Male&quot;</span>, sexo),</span>
<span id="cb147-11"><a href="estimação.html#cb147-11" tabindex="-1"></a>         <span class="at">sexo =</span> <span class="fu">gsub</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;Female&quot;</span>, sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb147-12"><a href="estimação.html#cb147-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(num_aluno_gen),</span>
<span id="cb147-13"><a href="estimação.html#cb147-13" tabindex="-1"></a>            <span class="at">percent =</span> num_aluno_gen<span class="sc">/</span>total) <span class="sc">%&gt;%</span></span>
<span id="cb147-14"><a href="estimação.html#cb147-14" tabindex="-1"></a>  <span class="fu">filter</span>(sexo <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-15"><a href="estimação.html#cb147-15" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">percent_female =</span> percent) <span class="sc">%&gt;%</span></span>
<span id="cb147-16"><a href="estimação.html#cb147-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id_escola, percent_female)</span>
<span id="cb147-17"><a href="estimação.html#cb147-17" tabindex="-1"></a>         </span>
<span id="cb147-18"><a href="estimação.html#cb147-18" tabindex="-1"></a>aluno_raca <span class="ot">&lt;-</span> aluno <span class="sc">%&gt;%</span></span>
<span id="cb147-19"><a href="estimação.html#cb147-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(regular <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-20"><a href="estimação.html#cb147-20" tabindex="-1"></a>  <span class="fu">group_by</span>(id_escola, raca_cor) <span class="sc">%&gt;%</span></span>
<span id="cb147-21"><a href="estimação.html#cb147-21" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_aluno_raca =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb147-22"><a href="estimação.html#cb147-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;Branca&quot;</span>, raca_cor),</span>
<span id="cb147-23"><a href="estimação.html#cb147-23" tabindex="-1"></a>         <span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;Preta&quot;</span>, raca_cor),</span>
<span id="cb147-24"><a href="estimação.html#cb147-24" tabindex="-1"></a>         <span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;3&quot;</span>, <span class="st">&quot;Parda&quot;</span>, raca_cor)) <span class="sc">%&gt;%</span></span>
<span id="cb147-25"><a href="estimação.html#cb147-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(num_aluno_raca),</span>
<span id="cb147-26"><a href="estimação.html#cb147-26" tabindex="-1"></a>         <span class="at">percent =</span> num_aluno_raca<span class="sc">/</span>total) <span class="sc">%&gt;%</span></span>
<span id="cb147-27"><a href="estimação.html#cb147-27" tabindex="-1"></a>  <span class="fu">filter</span>(raca_cor <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Branca&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;Preta&quot;</span>, <span class="st">&quot;Parda&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb147-28"><a href="estimação.html#cb147-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;não_declarado&quot;</span>, raca_cor)) <span class="sc">%&gt;%</span></span>
<span id="cb147-29"><a href="estimação.html#cb147-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id_escola, raca_cor, percent) <span class="sc">%&gt;%</span></span>
<span id="cb147-30"><a href="estimação.html#cb147-30" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> raca_cor , <span class="at">values_from =</span> percent )</span>
<span id="cb147-31"><a href="estimação.html#cb147-31" tabindex="-1"></a></span>
<span id="cb147-32"><a href="estimação.html#cb147-32" tabindex="-1"></a></span>
<span id="cb147-33"><a href="estimação.html#cb147-33" tabindex="-1"></a></span>
<span id="cb147-34"><a href="estimação.html#cb147-34" tabindex="-1"></a>aluno_escola <span class="ot">&lt;-</span> aluno_gen <span class="sc">%&gt;%</span></span>
<span id="cb147-35"><a href="estimação.html#cb147-35" tabindex="-1"></a>  <span class="fu">inner_join</span>(aluno_raca,  <span class="at">by =</span> <span class="st">&quot;id_escola&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-36"><a href="estimação.html#cb147-36" tabindex="-1"></a>  <span class="fu">inner_join</span>(escola, <span class="at">by =</span> <span class="st">&quot;id_escola&quot;</span>)</span>
<span id="cb147-37"><a href="estimação.html#cb147-37" tabindex="-1"></a></span>
<span id="cb147-38"><a href="estimação.html#cb147-38" tabindex="-1"></a>aluno_escola_reg <span class="ot">&lt;-</span> aluno_escola <span class="sc">%&gt;%</span></span>
<span id="cb147-39"><a href="estimação.html#cb147-39" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-40"><a href="estimação.html#cb147-40" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">negra =</span> Preta <span class="sc">+</span> Parda) <span class="sc">%&gt;%</span></span>
<span id="cb147-41"><a href="estimação.html#cb147-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(negra, percent_female, tipo_localizacao, agua_potavel, esgoto_rede_publica, </span>
<span id="cb147-42"><a href="estimação.html#cb147-42" tabindex="-1"></a>         lixo_servico_coleta, area_verde, biblioteca, quantidade_profissional_psicologo) <span class="sc">%&gt;%</span></span>
<span id="cb147-43"><a href="estimação.html#cb147-43" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb147-44"><a href="estimação.html#cb147-44" tabindex="-1"></a>  <span class="fu">mutate_if</span>(bit64<span class="sc">::</span>is.integer64, as.factor)</span></code></pre></div>
<pre><code>## Warning: Using `across()` in `filter()` was deprecated in dplyr 1.0.8.
## ℹ Please use `if_any()` or `if_all()` instead.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="estimação.html#cb149-1" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(negra <span class="sc">~</span>  percent_female <span class="sc">+</span> tipo_localizacao <span class="sc">+</span> agua_potavel  <span class="sc">+</span> esgoto_rede_publica <span class="sc">+</span> lixo_servico_coleta <span class="sc">+</span> area_verde <span class="sc">+</span> biblioteca <span class="sc">+</span> quantidade_profissional_psicologo, <span class="at">data=</span> aluno_escola_reg)</span>
<span id="cb149-2"><a href="estimação.html#cb149-2" tabindex="-1"></a></span>
<span id="cb149-3"><a href="estimação.html#cb149-3" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = negra ~ percent_female + tipo_localizacao + agua_potavel + 
##     esgoto_rede_publica + lixo_servico_coleta + area_verde + 
##     biblioteca + quantidade_profissional_psicologo, data = aluno_escola_reg)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.46731 -0.16217 -0.01934  0.17534  0.55176 
## 
## Coefficients:
##                                     Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                         0.070584   0.204310   0.345  0.72991   
## percent_female                      0.400443   0.256195   1.563  0.11880   
## tipo_localizacao2                  -0.251352   0.224599  -1.119  0.26373   
## agua_potavel1                       0.067306   0.052684   1.278  0.20212   
## esgoto_rede_publica1               -0.069037   0.022951  -3.008  0.00279 **
## lixo_servico_coleta1                0.144155   0.158554   0.909  0.36378   
## area_verde1                         0.047138   0.025681   1.836  0.06714 . 
## biblioteca1                         0.009462   0.022531   0.420  0.67473   
## quantidade_profissional_psicologo1 -0.069969   0.033593  -2.083  0.03787 * 
## quantidade_profissional_psicologo2 -0.120828   0.092870  -1.301  0.19396   
## quantidade_profissional_psicologo3 -0.306991   0.130754  -2.348  0.01935 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2222 on 418 degrees of freedom
## Multiple R-squared:  0.07237,    Adjusted R-squared:  0.05017 
## F-statistic: 3.261 on 10 and 418 DF,  p-value: 0.0004498</code></pre>
</div>
<div id="limitações-de-mqo" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Limitações de MQO<a href="#limita%C3%A7%C3%B5es-de-mqo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Os estimadores de MQO, nossos <span class="math inline">\(\hat{\beta}\)</span> e <span class="math inline">\(\hat{\alpha}\)</span>, são não-viesados e conseguimos derivar a variância amostral deles. Porém, não há muito mais que possamos dizer sobre eles a partir apenas das suposições que fizemos, ou seja, de que o modelo linear (nos parâmetros) é adequado, e que a espereança do erro, condicional ao preditor, é zero (e assumimos, em certo momento, homecedasticidade). O que não podemos dizer a mais que gostaríamos de poder fazer?</p>
<p>Uma aspecto importante da inferência é, por exemplo, calcular o intervalo de confiança. Para isso, contudo, precisaremos de mais suposições do que o que fizemos até aqui. Portanto, tanto cálculos de intervalo de confiança como o p-valor e condução de testes de hipótese estão vedados com as suposições de MQO.</p>
</div>
<div id="distrações" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Distrações<a href="#distra%C3%A7%C3%B5es" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quando nós imprimimos o resultado de uma regressão no R, além dos coeficientes e o erro padrão, há uma série de outras informações apresentadas. Muitas delas são apenas distrações, mas como existem e muita gente ainda as utiliza (às vezes com bom uso), vou falar rapidamente de uma delas, o que já é possível com nosso conhecimento atual.</p>
<div id="r-quadrado" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> R-quadrado<a href="estimação.html#r-quadrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Uma das estatísticas apresentadas é o chamado <span class="math inline">\(R^2\)</span>, também denominado coeficiente de determinação, que pode ser definido de várias maneiras distintas e uma delas é a razão entre a variância dos valores preditos <span class="math inline">\(\hat{Y}\)</span> e a variância dos dados observados, <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[
R^2 \equiv \frac{\hat{\sigma^2_{\hat{y}}}}{\sigma^2}
\]</span></p>
<p>Uma definição alternartiva é que o R-quadrado é a razão entre a covariância de <span class="math inline">\(y\)</span> e <span class="math inline">\(\hat{y}\)</span> e a variância de <span class="math inline">\(Y\)</span>:
<span class="math display">\[
R^2 \equiv \frac{\mathbb{Cov}[Y,\hat{Y}]}{\sigma^2}
\]</span>
Por fim, o R-quadrado pode ser escrito como o quadrado da covariância entee <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> dividido pelo produto dos desvios-pdrãos de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.
<span class="math display">\[
R^2 \equiv \left(\frac{\mathbb{Cov}[X,Y]}{\sigma_x \cdot \sigma_y}\right)^2
\]</span></p>
<p>Essa última parametrização é o que permite interpretar o R-quadrado como a correlação (entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>) ao quadrado. É fácil ver também que uma regressão de <span class="math inline">\(X\)</span> sobre <span class="math inline">\(Y\)</span> gera o mesmo R-quadrado que uma regressão de <span class="math inline">\(Y\)</span> sobre <span class="math inline">\(X\)</span>.</p>
</div>
<div id="r-quadrado-ajustado" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> R-quadrado ajustado<a href="estimação.html#r-quadrado-ajustado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O estimador <span class="math inline">\(\hat{\sigma^2}\)</span> é viesado com relação ao parâmetro <span class="math inline">\(\sigma^2\)</span>. Então, o R-quadrado ajustado usa <span class="math inline">\(\frac{n \cdot \hat{\sigma^2}}{n-2}\)</span> como estimador de <span class="math inline">\(\sigma^2\)</span>. Uma interpretação dada é que adicionar preditores no modelo em geral reduz a variância “não-explicada” <span class="math inline">\(\sigma^2\)</span> (lembrem-se do “chuva na Jamaica”). E isso induz um viés da estimativa do <span class="math inline">\(R^2\)</span>, que é corrigida pelo desconto no número de preditores + 1.</p>
</div>
<div id="limites-do-r-quadrado" class="section level3 hasAnchor" number="7.8.3">
<h3><span class="header-section-number">7.8.3</span> Limites do R-quadrado<a href="estimação.html#limites-do-r-quadrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pela primeira parametrização, éfácil ver que o <span class="math inline">\(R^2\)</span> jamais será negativo, pois a variância é sempre não-negativa. Além disso, jamais será mais que 1, pois a variância dos valores preditors será no máximo igual à variância observada, quando as previsões forem perfeitas.</p>
</div>
<div id="para-que-serve" class="section level3 hasAnchor" number="7.8.4">
<h3><span class="header-section-number">7.8.4</span> Para que serve?<a href="estimação.html#para-que-serve" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Por muito tempo foi utilizada como uma medida do ajuste do modelo e, portanto, quanto maior o R-quadrado, melhor (ou quanto maior o R-quadrado ajustado). Hoje em dia, contudo, sabemos que é uma péssima medida de ajuste do modelo.</p>
<ol style="list-style-type: decimal">
<li><p>O modelo pode estar correto e produzir um R-quadrado pequeno, a depender a da variância de <span class="math inline">\(Y\)</span>.</p></li>
<li><p>O modelo pode estar totalmente errado e o R-quadrado ser próximo de 1. Quando o verdadeiro modelo é não-linear e a variância de <span class="math inline">\(X\)</span> é muito grande, isso pode acontecer se a reta de regressão ajustada não tiver <span class="math inline">\(\beta = 0\)</span>.</p></li>
<li><p>Há também quem use o <span class="math inline">\(R^2\)</span> como medida de capacidade preditiva do modelo. Quanto mais espalhado o <span class="math inline">\(X\)</span>, melhor o <span class="math inline">\(R^2\)</span>. A simulação abaixo mostra isso:</p></li>
</ol>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="estimação.html#cb151-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb151-2"><a href="estimação.html#cb151-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb151-3"><a href="estimação.html#cb151-3" tabindex="-1"></a></span>
<span id="cb151-4"><a href="estimação.html#cb151-4" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb151-5"><a href="estimação.html#cb151-5" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb151-6"><a href="estimação.html#cb151-6" tabindex="-1"></a></span>
<span id="cb151-7"><a href="estimação.html#cb151-7" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span>x1))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.6679 -1.3320  0.0043  1.3645  6.9227 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.020922   0.064504   31.33   &lt;2e-16 ***
## x1          2.993065   0.006303  474.89   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.04 on 998 degrees of freedom
## Multiple R-squared:  0.9956, Adjusted R-squared:  0.9956 
## F-statistic: 2.255e+05 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="estimação.html#cb153-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y2<span class="sc">~</span>x2))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y2 ~ x2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.9993 -1.4044  0.1023  1.2666  6.2683 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.89141    0.06275   30.14   &lt;2e-16 ***
## x2           2.98833    0.03186   93.81   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.984 on 998 degrees of freedom
## Multiple R-squared:  0.8981, Adjusted R-squared:  0.898 
## F-statistic:  8799 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><p>Não é possível comparar o <span class="math inline">\(R^2\)</span> entre amostras distintas, como a simulação acima também mostra. O modelo é o mesmo, mas os dados são distintos e produzem <span class="math inline">\(R^2\)</span> distintos.</p></li>
<li><p>Não faz sentido comparar o <span class="math inline">\(R^2\)</span> entre transformações da nossa variável dependente (com e sem log, por exemplo).</p></li>
<li><p>Quando a amostra é a mesma e o <span class="math inline">\(y\)</span> é o mesmo, é possível comparar modelos com o <span class="math inline">\(R^2\)</span> e um R-quadrado maior significa um Erro Quadrático Médio menor. Mas nesse caso, é melhor usar direto o EQM.</p></li>
<li><p>É fácil ver, por tudo isso, que o <span class="math inline">\(R^2\)</span> não é uma medida da variância explicada, com ou sem aspas. Eu não consigo entender o que é “explicar”, assim com aspas, e como é distinto de sem aspas. Portanto, melhor seria não usar e deixar de lado. Mas como é usado e os softwares mostram, tenho de perder tempo falando sobre ele para vocês.</p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cef-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="causalidade.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mgaldino/book-regression/edit/main/07-estimacao.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mgaldino/book-regression/blob/main/07-estimacao.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
