<!DOCTYPE html>
<html lang="pt" xml:lang="pt">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais</title>
  <meta name="description" content="Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 - Estimação | Introdução à Regresssão para Ciências Sociais" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2023-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cef-1.html"/>
<link rel="next" href="causalidade.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Regressão</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> - Prefácio</a></li>
<li class="chapter" data-level="2" data-path="revisão-de-r.html"><a href="revisão-de-r.html"><i class="fa fa-check"></i><b>2</b> - Revisão de R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-e-rstudio"><i class="fa fa-check"></i><b>2.1</b> R e Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-como-calculadora"><i class="fa fa-check"></i><b>2.2</b> R como calculadora</a></li>
<li class="chapter" data-level="2.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#objetos-no-r"><i class="fa fa-check"></i><b>2.3</b> Objetos no R</a></li>
<li class="chapter" data-level="2.4" data-path="revisão-de-r.html"><a href="revisão-de-r.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.4</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#numeric"><i class="fa fa-check"></i><b>2.4.1</b> Numeric</a></li>
<li class="chapter" data-level="2.4.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#character"><i class="fa fa-check"></i><b>2.4.2</b> character</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="revisão-de-r.html"><a href="revisão-de-r.html#armazenando-dados"><i class="fa fa-check"></i><b>2.5</b> Armazenando dados</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#vetor"><i class="fa fa-check"></i><b>2.5.1</b> Vetor</a></li>
<li class="chapter" data-level="2.5.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#matriz"><i class="fa fa-check"></i><b>2.5.2</b> Matriz</a></li>
<li class="chapter" data-level="2.5.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-frame"><i class="fa fa-check"></i><b>2.5.3</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="revisão-de-r.html"><a href="revisão-de-r.html#bibliotecaspacotes"><i class="fa fa-check"></i><b>2.6</b> Bibliotecas/pacotes</a></li>
<li class="chapter" data-level="2.7" data-path="revisão-de-r.html"><a href="revisão-de-r.html#importando-dados"><i class="fa fa-check"></i><b>2.7</b> importando dados</a></li>
<li class="chapter" data-level="2.8" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-wrangling"><i class="fa fa-check"></i><b>2.8</b> Data wrangling</a></li>
<li class="chapter" data-level="2.9" data-path="revisão-de-r.html"><a href="revisão-de-r.html#visualização"><i class="fa fa-check"></i><b>2.9</b> Visualização</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html"><i class="fa fa-check"></i><b>3</b> - Revisão de estatística e probabilidade</a>
<ul>
<li class="chapter" data-level="3.1" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#variável-aleatória"><i class="fa fa-check"></i><b>3.1</b> Variável Aleatória</a></li>
<li class="chapter" data-level="3.2" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#esperança-matemática"><i class="fa fa-check"></i><b>3.2</b> Esperança matemática</a></li>
<li class="chapter" data-level="3.3" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#variância"><i class="fa fa-check"></i><b>3.3</b> Variância</a></li>
<li class="chapter" data-level="3.4" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#algebra-com-esperança-variância-e-covariância"><i class="fa fa-check"></i><b>3.4</b> Algebra com Esperança, Variância e Covariância</a></li>
<li class="chapter" data-level="3.5" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#distribuição-de-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.5</b> Distribuição de Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.6" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#pobabilidade-condicional"><i class="fa fa-check"></i><b>3.6</b> Pobabilidade Condicional</a></li>
<li class="chapter" data-level="3.7" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html#esperança-condicional"><i class="fa fa-check"></i><b>3.7</b> Esperança Condicional</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html"><i class="fa fa-check"></i><b>4</b> Introdução à Simulação</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#configuração"><i class="fa fa-check"></i><b>4.1</b> Configuração</a></li>
<li class="chapter" data-level="4.2" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simular"><i class="fa fa-check"></i><b>4.2</b> Simular</a></li>
<li class="chapter" data-level="4.3" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#resumir"><i class="fa fa-check"></i><b>4.3</b> Resumir</a></li>
<li class="chapter" data-level="4.4" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#análise-de-sensibilidade"><i class="fa fa-check"></i><b>4.4</b> Análise de sensibilidade</a></li>
<li class="chapter" data-level="4.5" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#aplicação-de-simulação"><i class="fa fa-check"></i><b>4.5</b> Aplicação de simulação</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html"><i class="fa fa-check"></i><b>5</b> O Modelo de Regressão</a>
<ul>
<li class="chapter" data-level="5.1" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#modelo-de-regressão---teoria"><i class="fa fa-check"></i><b>5.1</b> Modelo de Regressão - Teoria</a></li>
<li class="chapter" data-level="5.2" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#esperança-condicional-1"><i class="fa fa-check"></i><b>5.2</b> Esperança Condicional</a></li>
<li class="chapter" data-level="5.3" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#cef"><i class="fa fa-check"></i><b>5.3</b> CEF</a></li>
<li class="chapter" data-level="5.4" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#objetivos-de-aprendizagem-ao-final-do-capítulo"><i class="fa fa-check"></i><b>5.4</b> Objetivos de aprendizagem ao final do capítulo</a></li>
<li class="chapter" data-level="5.5" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#distribuição-dos-salários"><i class="fa fa-check"></i><b>5.5</b> Distribuição dos salários</a></li>
<li class="chapter" data-level="5.6" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#distribuição-condicional-dos-salários"><i class="fa fa-check"></i><b>5.6</b> Distribuição Condicional dos salários</a></li>
<li class="chapter" data-level="5.7" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#logaritmos"><i class="fa fa-check"></i><b>5.7</b> Logaritmos</a></li>
<li class="chapter" data-level="5.8" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#gênero-e-raça"><i class="fa fa-check"></i><b>5.8</b> Gênero e Raça</a></li>
<li class="chapter" data-level="5.9" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#prevendo-a-partir-da-esperança-condicional"><i class="fa fa-check"></i><b>5.9</b> Prevendo a partir da esperança condicional</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cef-1.html"><a href="cef-1.html"><i class="fa fa-check"></i><b>6</b> - CEF</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cef-1.html"><a href="cef-1.html#erro-da-cef"><i class="fa fa-check"></i><b>6.1</b> Erro da CEF</a></li>
<li class="chapter" data-level="6.2" data-path="cef-1.html"><a href="cef-1.html#simulando-para-entender-a-cef"><i class="fa fa-check"></i><b>6.2</b> Simulando para entender a CEF</a></li>
<li class="chapter" data-level="6.3" data-path="cef-1.html"><a href="cef-1.html#propriedades-da-cef"><i class="fa fa-check"></i><b>6.3</b> Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="cef-1.html"><a href="cef-1.html#a-esperança-do-erro-condicional-a-x-é-zero"><i class="fa fa-check"></i><b>6.3.1</b> A Esperança do Erro Condicional a X é zero</a></li>
<li class="chapter" data-level="6.3.2" data-path="cef-1.html"><a href="cef-1.html#a-esperança-não-condicional-do-erro-é-zero."><i class="fa fa-check"></i><b>6.3.2</b> A esperança (não-condicional) do erro é zero.</a></li>
<li class="chapter" data-level="6.3.3" data-path="cef-1.html"><a href="cef-1.html#o-erro-da-cef-é-não-correlacionado-com-x"><i class="fa fa-check"></i><b>6.3.3</b> O erro da CEF é não-correlacionado com X</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="cef-1.html"><a href="cef-1.html#a-esperança-condicional-é-o-melhor-preditor"><i class="fa fa-check"></i><b>6.4</b> A esperança condicional é o melhor preditor</a></li>
<li class="chapter" data-level="6.5" data-path="cef-1.html"><a href="cef-1.html#regressão-linear-e-a-cef"><i class="fa fa-check"></i><b>6.5</b> Regressão Linear e a CEF</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="cef-1.html"><a href="cef-1.html#mínimos-quadrados-ordinários"><i class="fa fa-check"></i><b>6.5.1</b> Mínimos Quadrados Ordinários</a></li>
<li class="chapter" data-level="6.5.2" data-path="cef-1.html"><a href="cef-1.html#suponha-que-a-cef-é-linear-justificativa-i"><i class="fa fa-check"></i><b>6.5.2</b> Suponha que a CEF é Linear (Justificativa I)</a></li>
<li class="chapter" data-level="6.5.3" data-path="cef-1.html"><a href="cef-1.html#é-o-melhor-preditor-linear-do-y-justificativa-ii"><i class="fa fa-check"></i><b>6.5.3</b> É o melhor preditor linear do <span class="math inline">\(Y\)</span> (justificativa II)</a></li>
<li class="chapter" data-level="6.5.4" data-path="cef-1.html"><a href="cef-1.html#a-reta-de-regressão-é-a-aproximação-com-o-menor-erro-quadrático-médio-justificativa-iii"><i class="fa fa-check"></i><b>6.5.4</b> A reta de regressão é a aproximação com o menor erro quadrático médio (justificativa III)</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="cef-1.html"><a href="cef-1.html#linearidade-e-causalidade"><i class="fa fa-check"></i><b>6.6</b> Linearidade e Causalidade</a></li>
<li class="chapter" data-level="6.7" data-path="cef-1.html"><a href="cef-1.html#modelo-só-com-intercepto"><i class="fa fa-check"></i><b>6.7</b> Modelo só com intercepto</a></li>
<li class="chapter" data-level="6.8" data-path="cef-1.html"><a href="cef-1.html#variância-da-regressão"><i class="fa fa-check"></i><b>6.8</b> Variância da Regressão</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="cef-1.html"><a href="cef-1.html#chuva-na-jamaica"><i class="fa fa-check"></i><b>6.8.1</b> Chuva na Jamaica</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="cef-1.html"><a href="cef-1.html#variância-condicional"><i class="fa fa-check"></i><b>6.9</b> Variância condicional</a></li>
<li class="chapter" data-level="6.10" data-path="cef-1.html"><a href="cef-1.html#efeito-marginal"><i class="fa fa-check"></i><b>6.10</b> Efeito Marginal</a></li>
<li class="chapter" data-level="6.11" data-path="cef-1.html"><a href="cef-1.html#cef-linear-com-preditores-não-lineares"><i class="fa fa-check"></i><b>6.11</b> CEF linear com preditores não-lineares</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimação.html"><a href="estimação.html"><i class="fa fa-check"></i><b>7</b> - Estimação</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimação.html"><a href="estimação.html#plug-in-estimators"><i class="fa fa-check"></i><b>7.1</b> Plug-in estimators</a></li>
<li class="chapter" data-level="7.2" data-path="estimação.html"><a href="estimação.html#simulando-de-uma-normal-bivariada"><i class="fa fa-check"></i><b>7.2</b> Simulando de uma Normal Bivariada</a></li>
<li class="chapter" data-level="7.3" data-path="estimação.html"><a href="estimação.html#suposições-amostrais-de-mqo"><i class="fa fa-check"></i><b>7.3</b> Suposições amostrais de MQO</a></li>
<li class="chapter" data-level="7.4" data-path="estimação.html"><a href="estimação.html#modelo-de-média-amostral"><i class="fa fa-check"></i><b>7.4</b> Modelo de Média amostral</a></li>
<li class="chapter" data-level="7.5" data-path="estimação.html"><a href="estimação.html#modelo-de-regressão-linear-com-preditores"><i class="fa fa-check"></i><b>7.5</b> Modelo de Regressão Linear com preditores</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="causalidade.html"><a href="causalidade.html"><i class="fa fa-check"></i><b>8</b> - Causalidade</a>
<ul>
<li class="chapter" data-level="8.1" data-path="causalidade.html"><a href="causalidade.html#resultados-potenciais"><i class="fa fa-check"></i><b>8.1</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="causalidade.html"><a href="causalidade.html#decomposição-do-efeito-causal"><i class="fa fa-check"></i><b>8.1.1</b> Decomposição do Efeito Causal</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="causalidade.html"><a href="causalidade.html#modelo-estrutural-e-modelo-de-regressão"><i class="fa fa-check"></i><b>8.2</b> Modelo estrutural e modelo de regressão</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="causalidade.html"><a href="causalidade.html#exemplo-de-cef-e-cef-estrutural"><i class="fa fa-check"></i><b>8.2.1</b> Exemplo de CEF e CEF estrutural</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="causalidade.html"><a href="causalidade.html#simulação-de-resultados-potenciais-e-causalidade"><i class="fa fa-check"></i><b>8.3</b> Simulação de Resultados Potenciais e Causalidade</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à Regresssão para Ciências Sociais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimação" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Capítulo 7</span> - Estimação<a href="estimação.html#estimação" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Nós já vimos que é possível mostrar que o preditor linear ótimo com um único regressor possui intercepto
<span class="math inline">\(\alpha = \mathbb{E}[Y] - \beta*\mathbb{E}[X]\)</span> e inclinação <span class="math inline">\(\beta = Cov(X,Y)/Var(X)\)</span>. Isso significa que, se nós considerarmos o modelo de regressão <span class="math inline">\(y_i = \alpha + \beta*x_i + e_i\)</span>, e usarmos essas fórmulas para calcular os valores de <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> em uma população, obteríamos uma reta ajustada que é o melhor preditor linear.</p>
<p>Até o momento, estávamos trabalhando com a população. Porém, na prática estaremos sempre lidando com uma amostra, de forma que precisamos entender como funciona a estimação de uma regressão a partir de uma amostra.</p>
<div id="plug-in-estimators" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Plug-in estimators<a href="estimação.html#plug-in-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se tivermos uma amostra, e não a população, é razoável pensar que uma boa estimativa para os valores populacionais de <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> são justamente essas fórmulas, calculadas para os dados amostrais. Esse estimador dos parâmetros populacionais nós chamamos de <strong>plug-in estimates</strong>, pois sem maiores teorias, assumimos que o que vale para a população vale para a amostra. Para diferenciar as estimativas amostrais dos valores populacionais, é comum usarmos <span class="math inline">\(\hat{\beta}\)</span> em vez de <span class="math inline">\(\beta\)</span>, ou então letras latinas <span class="math inline">\(b\)</span> em vez das gregas <span class="math inline">\(\beta\)</span>. Vou usar letras gregas com o “chapéu”, mas outros textos utilizam letras latinas .</p>
<p>Ou seja, <span class="math inline">\(\hat{\beta} = \frac{\sum{(x_i - \bar{x})(y_i - \bar{y})}}{\hat{\sigma_x}^2}\)</span></p>
</div>
<div id="simulando-de-uma-normal-bivariada" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Simulando de uma Normal Bivariada<a href="estimação.html#simulando-de-uma-normal-bivariada" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma distribuição de probabilidade de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> é Normal bivariada quando <span class="math inline">\(aX + bY\)</span> é Normal também, para quaisquer <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span>. Para nós, importa aqui que <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> são normais cada uma, e a conjunta deles também é Normal.</p>
<p>E diferentemente da Normal univariada, preciso representar os parâmetros por meio de vetores. A média, que antes era um escalar, agora será representada por um vetor: <span class="math inline">\(\mu = (\mu_x, \mu_y)\)</span>. Mesmo que <span class="math inline">\(\mu_x = \mu_y\)</span>, ainda assim preciso representar por um vetor. E a variância também não consegue especificartudo que preciso saber sobre a variação nos dados. Eu preciso saber, a variância de <span class="math inline">\(X\)</span>, dada por <span class="math inline">\(\sigma_x\)</span>, a variância de <span class="math inline">\(Y\)</span>, <span class="math inline">\(\sigma_x\)</span> e a covariância entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> e <span class="math inline">\(Y\)</span> e <span class="math inline">\(X\)</span>, dadas respectivamente por <span class="math inline">\(\mathbb{Cov}[X,Y]\)</span> e <span class="math inline">\(\mathbb{Cov}[Y,X]\)</span>, que obviamente serão iguais. E nós representamos essas quatro informações por meio de uma matriz, chamada de matriz de covariância ou matriz de variância-covariância:</p>
<p><span class="math display">\[
\Sigma =
\begin{bmatrix}
\sigma_x &amp; \mathbb{Cov}[Y,X] \\
\mathbb{Cov}[X,Y] &amp; \sigma_y
\end{bmatrix}
\]</span>
Essa matriz precisa ser positiva-definida, que é uma característica de matrizes, mas que basicamente tem a ver com o fato de que não existe variância negativa e dadas as variâncias de <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, existem limites para o que a covariância pode ser.</p>
<p>Como escolher os valores para essa matriz não é nada intuitivo, vamos trabalhar com a correlação, que temos ma noção melhor. Para isso, utilizaremos a seguinte relação:</p>
<p><span class="math display">\[
\Sigma =
\begin{bmatrix}
\sigma_x^2 &amp; \rho \cdot \sigma_x \cdot \sigma_y \\
\rho \cdot \sigma_x\cdot \sigma_y &amp; \sigma_y
\end{bmatrix}
\]</span>
Ou seja, a matriz de variância-covariância pode ser parametrizada apenas em função dos desvios-padrões e da correlação entre as duas variáveis.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="estimação.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="estimação.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="estimação.html#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="estimação.html#cb1-4" tabindex="-1"></a><span class="co"># vetor de médias</span></span>
<span id="cb1-5"><a href="estimação.html#cb1-5" tabindex="-1"></a>vetor_media <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb1-6"><a href="estimação.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="estimação.html#cb1-7" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-8"><a href="estimação.html#cb1-8" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-9"><a href="estimação.html#cb1-9" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb1-10"><a href="estimação.html#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="estimação.html#cb1-11" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb1-12"><a href="estimação.html#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="estimação.html#cb1-13" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="estimação.html#cb1-14" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">2.4</td>
</tr>
<tr class="even">
<td align="right">2.4</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="estimação.html#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb2-2"><a href="estimação.html#cb2-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb2-3"><a href="estimação.html#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="estimação.html#cb2-4" tabindex="-1"></a>bivariada_tibble1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="estimação.html#cb2-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb2-6"><a href="estimação.html#cb2-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb2-7"><a href="estimação.html#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="estimação.html#cb2-8" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="estimação.html#cb2-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/normal-bivariada-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="estimação.html#cb3-1" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="estimação.html#cb3-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(y)) <span class="sc">+</span> <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/normal-bivariada-2.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="estimação.html#cb4-1" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="estimação.html#cb4-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_density_2d</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/normal-bivariada-3.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="estimação.html#cb5-1" tabindex="-1"></a>bivariada_tibble1 <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="estimação.html#cb5-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/normal-bivariada-4.png" width="672" /></p>
<p>Vamos usar esses dados para fazer uma regressão.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="estimação.html#cb6-1" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble1)</span>
<span id="cb6-2"><a href="estimação.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="estimação.html#cb6-3" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = bivariada_tibble1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7942 -1.0639 -0.0067  1.0740  6.4187 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.014913   0.015907  -0.937    0.349    
## x            0.588264   0.008073  72.870   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.591 on 9998 degrees of freedom
## Multiple R-squared:  0.3469, Adjusted R-squared:  0.3468 
## F-statistic:  5310 on 1 and 9998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>A fórmula do <span class="math inline">\(\beta\)</span> nós sabemos que depende da covariância entre as variáveis e o desvio-padrão de <span class="math inline">\(X\)</span>. Vamos então simular os dados novamente, mudando as correlações e variâncias, para entender como isso impacta a regressão a partir da fórmula da inclinação da reta.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="estimação.html#cb8-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="estimação.html#cb8-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-3"><a href="estimação.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="estimação.html#cb8-4" tabindex="-1"></a><span class="co"># vetor de médias</span></span>
<span id="cb8-5"><a href="estimação.html#cb8-5" tabindex="-1"></a>vetor_media <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb8-6"><a href="estimação.html#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="estimação.html#cb8-7" tabindex="-1"></a><span class="co"># cov menor, dp o mesmo</span></span>
<span id="cb8-8"><a href="estimação.html#cb8-8" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-9"><a href="estimação.html#cb8-9" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-10"><a href="estimação.html#cb8-10" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb8-11"><a href="estimação.html#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="estimação.html#cb8-12" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb8-13"><a href="estimação.html#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="estimação.html#cb8-14" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="estimação.html#cb8-15" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">4.0</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">1.2</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="estimação.html#cb9-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb9-2"><a href="estimação.html#cb9-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb9-3"><a href="estimação.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="estimação.html#cb9-4" tabindex="-1"></a>bivariada_tibble2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="estimação.html#cb9-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb9-6"><a href="estimação.html#cb9-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb9-7"><a href="estimação.html#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="estimação.html#cb9-8" tabindex="-1"></a>bivariada_tibble2 <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="estimação.html#cb9-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/new_bivariada-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="estimação.html#cb10-1" tabindex="-1"></a><span class="co"># cov igual, dp de x maior</span></span>
<span id="cb10-2"><a href="estimação.html#cb10-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">3</span></span>
<span id="cb10-3"><a href="estimação.html#cb10-3" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-4"><a href="estimação.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="estimação.html#cb10-5" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb10-6"><a href="estimação.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="estimação.html#cb10-7" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="estimação.html#cb10-8" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">16.0</td>
<td align="right">2.4</td>
</tr>
<tr class="even">
<td align="right">2.4</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="estimação.html#cb11-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb11-2"><a href="estimação.html#cb11-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb11-3"><a href="estimação.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="estimação.html#cb11-4" tabindex="-1"></a>bivariada_tibble3 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="estimação.html#cb11-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb11-6"><a href="estimação.html#cb11-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb11-7"><a href="estimação.html#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="estimação.html#cb11-8" tabindex="-1"></a>bivariada_tibble3 <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="estimação.html#cb11-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/new_bivariada-2.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="estimação.html#cb12-1" tabindex="-1"></a><span class="co"># cov maor, dp de x maior</span></span>
<span id="cb12-2"><a href="estimação.html#cb12-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">15</span></span>
<span id="cb12-3"><a href="estimação.html#cb12-3" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb12-4"><a href="estimação.html#cb12-4" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-5"><a href="estimação.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="estimação.html#cb12-6" tabindex="-1"></a>matriz_var_cov <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y, rho<span class="sc">*</span>sigma_x<span class="sc">*</span>sigma_y,  sigma_y<span class="sc">^</span><span class="dv">2</span> ), <span class="at">byrow=</span>T, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb12-7"><a href="estimação.html#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="estimação.html#cb12-8" tabindex="-1"></a>matriz_var_cov <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="estimação.html#cb12-9" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">16.0</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">1.2</td>
<td align="right">4.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="estimação.html#cb13-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb13-2"><a href="estimação.html#cb13-2" tabindex="-1"></a>norm_bivariada <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> vetor_media, <span class="at">Sigma  =</span> matriz_var_cov)</span>
<span id="cb13-3"><a href="estimação.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="estimação.html#cb13-4" tabindex="-1"></a>bivariada_tibble4 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(norm_bivariada, <span class="at">.name_repair =</span> <span class="st">&quot;universal&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="estimação.html#cb13-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x =</span> <span class="st">&#39;...1&#39;</span>, </span>
<span id="cb13-6"><a href="estimação.html#cb13-6" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&#39;...2&#39;</span>)</span>
<span id="cb13-7"><a href="estimação.html#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="estimação.html#cb13-8" tabindex="-1"></a>bivariada_tibble4 <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="estimação.html#cb13-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/new_bivariada-3.png" width="672" /></p>
<p>O R mostra os resultados da regressão desse jeito, e vamos aprender a interpretá-lo, mas vamos também apresentar em um formato mais amigável e, caso vocês utilizem o rmarkdown, poderão utilizar em trabalhos acadêmicos. Para isso, utilizaremos o pacote stargazer</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="estimação.html#cb14-1" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble2)</span>
<span id="cb14-2"><a href="estimação.html#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="estimação.html#cb14-3" tabindex="-1"></a>reg3 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble3)</span>
<span id="cb14-4"><a href="estimação.html#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="estimação.html#cb14-5" tabindex="-1"></a>reg4 <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span>x , <span class="at">data =</span> bivariada_tibble4)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="estimação.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stargazer&quot;</span>)</span>
<span id="cb15-2"><a href="estimação.html#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="estimação.html#cb15-3" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(<span class="fu">list</span>(reg1, reg2, reg3, reg4), <span class="at">type =</span>  <span class="st">&quot;html&quot;</span>, </span>
<span id="cb15-4"><a href="estimação.html#cb15-4" tabindex="-1"></a>                     <span class="at">title =</span> <span class="st">&quot;Regressão linear&quot;</span>, <span class="at">omit.stat =</span> <span class="st">&quot;f&quot;</span>,</span>
<span id="cb15-5"><a href="estimação.html#cb15-5" tabindex="-1"></a>                     <span class="at">column.labels=</span><span class="fu">c</span>(<span class="st">&quot;cov = 2.4, s_x = 2&quot;</span>, <span class="st">&quot;cov = 1.2, s_x = 2&quot;</span>, <span class="st">&quot;cov = 2.4, s_x = 4&quot;</span>, <span class="st">&quot;cov = 1.2, s_x = 4&quot;</span> ))</span></code></pre></div>
<table style="text-align:center">
<caption>
<strong>Regressão linear</strong>
</caption>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
y
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
cov = 2.4, s= 2
</td>
<td>
cov = 1.2, s= 2
</td>
<td>
cov = 2.4, s= 4
</td>
<td>
cov = 1.2, s= 4
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
x
</td>
<td>
0.588<sup>***</sup>
</td>
<td>
0.284<sup>***</sup>
</td>
<td>
0.148<sup>***</sup>
</td>
<td>
0.073<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.008)
</td>
<td>
(0.010)
</td>
<td>
(0.005)
</td>
<td>
(0.005)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.015
</td>
<td>
-0.019
</td>
<td>
0.014
</td>
<td>
0.014
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.016)
</td>
<td>
(0.019)
</td>
<td>
(0.019)
</td>
<td>
(0.020)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
10,000
</td>
<td>
10,000
</td>
<td>
10,000
</td>
<td>
10,000
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.347
</td>
<td>
0.081
</td>
<td>
0.085
</td>
<td>
0.021
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.347
</td>
<td>
0.081
</td>
<td>
0.085
</td>
<td>
0.021
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 9998)
</td>
<td>
1.591
</td>
<td>
1.892
</td>
<td>
1.904
</td>
<td>
1.974
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="4" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<div id="suposições-amostrais-de-mqo" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Suposições amostrais de MQO<a href="estimação.html#suposições-amostrais-de-mqo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quando temos uma amostra, é comum supormos que os dados são <em>i</em>ndependentes e <em>i</em>denticamente <em>d</em>istribuídos, <em>i.i.d</em>. Esse tipo de amostra às vezes é chamada de amostra aleatória simples. Isso é tipicamente válido em dados de corte transversal (cross-section) como uma pesquisa de opinião (survey) de intenção de voto, amostra pequena (mil, dois mil) de alunos do Brasil a partir de dados doe Censo Escolar e assim por diante. O ponto é que os dados precisam ser dispersos. Se você coletar alunos de uma mesma escola, eles não tenderão a ser independentes. Se amostrar eleitores de um mesmo bairro, tampouco haverá independência. Há formas de lidar com isso, e aprenderemos mais tarde. Por enquanto, tratemos do caso mais simples.</p>
<p>A suposição de que dados são i.i.d significa que, em uma amostra com duas variáveis, <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, o par <span class="math inline">\(x_i, y_i\)</span> é independente de <span class="math inline">\(x_j, y_j\)</span>, com <span class="math inline">\(i \neq j\)</span> e identicamente distribuídos, isto é, com a mesma distribuição. Essa suposição é importante para calcular a variância dos nossos estimadores, não para a estimativa pontual deles.</p>
</div>
<div id="modelo-de-média-amostral" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Modelo de Média amostral<a href="estimação.html#modelo-de-média-amostral" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como vimos, o modelo de regressão mais simples é aquele sem preditores, em que <span class="math inline">\(Y = \mu + e\)</span>. O estimador de mínimos quadrados para <span class="math inline">\(\hat{\mu}\)</span> é a média amostral, <span class="math inline">\(\bar{y}\)</span>. Notem que <span class="math inline">\(\mathbb{E}[Y]\)</span> é a esperança populacional e <span class="math inline">\(\mu\)</span> é o valor da esperança, já que a esperança do erro <span class="math inline">\(e\)</span> é zero. Vamos então calcular a média de nosso estimador <span class="math inline">\(\bar{y}\)</span> e sua variância.</p>
<p><span class="math display">\[
\mathbb{E}[\bar{y}] = \mathbb{E}[\sum{y_i}/n] = (1/n) * \sum{\mathbb{E}[y_i]} = (1/n)*\mu*n = \mu
\]</span></p>
<p>Portanto, o valor esperando do estimador de mínimos quadrados (a média amostral) é igual à média populacional. Quando isso acontece, isto é, quando a esperança de um estimador é igual ao parâmetro populacional dizemos que o estimador é não-viesado.</p>
<p>Definição 7.1. Um estimador <span class="math inline">\(\hat{\theta}\)</span> é não-viesado quando <span class="math inline">\(\mathbb{E}[\hat{\theta}] = \theta\)</span>.</p>
<p>Agora, vamos calcular a variância da média amostral sob a suposição de que a amostra é i.i.d. Considerando <span class="math inline">\(Y_i = \mu + e_i\)</span>, temos:</p>
<p><span class="math display">\[
\bar{y} = \sum{y_i}/n = \sum{(\mu + e_i)}/n = \sum{\mu}/n + \sum{e_i}/n = \mu + \sum{e_i}/n
\]</span></p>
<p>Rearranjando, temos: <span class="math inline">\(\bar{y} - \mu = \sum{e_i}/n\)</span></p>
<p>A variância então pode ser calculada como:</p>
<p><span class="math display">\[
\mathbb{Var}[\bar{y}] = \mathbb{E}[(\bar{y} - mu)^2]
\]</span>
<span class="math display">\[
= \mathbb{E}[( \sum\limits_{i=1}^n {e_i}/n)*( \sum\limits_{j=1}^n{e_j}/n)] = (1/n^2)* \sum\limits_{i=1}^n{} \sum\limits_{j=1}^n{}\mathbb{E}[e_ie_j]
\]</span>
Se nós somarmos o somatório indexado no <span class="math inline">\(j\)</span>, o primeiro erro fica constante (indexado no i) e vamos passar por todo os erros de <span class="math inline">\(1\)</span> até <span class="math inline">\(n\)</span>. Eventualmente, vamos passar por <span class="math inline">\(i\)</span> e todos os outros diferentes de <span class="math inline">\(i\)</span>. Sabendo que os erros são i.i.d, isso significa que erros diferentes são não correlacionados e possuem esperança zero, ou seja, <span class="math inline">\(\mathbb{E}[e_ie_j] = 0, i \neq j\)</span>, e erros iguais, por serem da mesma distribuição, têm <span class="math inline">\(\mathbb{E}[e_ie_i] = \sigma^2\)</span>. Então o resultado do último somatório é uma soma de zeros, exceto para o caso em que <span class="math inline">\(i = j\)</span>, em que dá <span class="math inline">\(\sigma^2\)</span>. De forma que a equação fica:</p>
<p><span class="math display">\[
(1/n^2)* \sum\limits_{i=1}^n{}\sigma^2 = (1/n^2)*n*\sigma^2 = \sigma^2/n
\]</span>
Ou seja, a variância de nosso estimador é igual à variância populacional dividida pelo tamanho da amostra. A variância amostral do estimador também é chamada de erro padrão.</p>
</div>
<div id="modelo-de-regressão-linear-com-preditores" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Modelo de Regressão Linear com preditores<a href="estimação.html#modelo-de-regressão-linear-com-preditores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tendo mostrado que o estimador é não-viesado e calculado a variância amostral para o caso mais simples, sem preditor, vamos agora fazer o mesmo cálculo com um preditor.</p>
<p>Vamos assumir que o modelo de regressão linear é uma boa aproximação para CEF. Portanto, vamos supor que:</p>
<ol style="list-style-type: decimal">
<li><p>O modelo linear <span class="math inline">\(y_i = \alpha + \beta*x_i + e_i\)</span> é adequado.</p></li>
<li><p><span class="math inline">\(\mathbb{E}[e|X] = 0\)</span>, isto é, o erro é não correlacionado com x.</p></li>
</ol>
<p>Para essa demonstração, vamos utilizar uma parametrização alternativa para o modelo de regressão linear em torno da média de <span class="math inline">\(x\)</span>. Para isso, vamos usar nosso truque matemático de adicionar e subtrair
Lembremos que a fórmula para o <span class="math inline">\(\hat{\beta}\)</span> é <span class="math inline">\(\mathbb{Cov}[X,Y]/\mathbb{Var}[X]\)</span>. Substituindo nossa equação de regressão na fórmula, temos:</p>
<p><span class="math display">\[
\hat{\beta} = \sum({x_i - \bar{x}})*({y_i - \bar{y}})/\mathbb{Var}[x] = (\sum({x - \bar{x}})*y_i + \sum({x -\bar{x}})*\bar{y})/\mathbb{Var}[x]
\]</span></p>
<p>Vamos agora usar o fato de que, para qualquer variável <span class="math inline">\(z\)</span>, a diferença média de <span class="math inline">\(z\)</span> para a média amostral de <span class="math inline">\(z\)</span> é zero, isto é, <span class="math inline">\(n^{-1}*\sum\limits_{i=1}^n{}z - \bar{z} = 0\)</span></p>
<p>Por fim, segue-se disso que, para qualquer constante <span class="math inline">\(w\)</span> que não varia com <span class="math inline">\(i\)</span>, podemos escrever:
<span class="math inline">\(n^{-1}*\sum\limits_{i=1}^n{}(z - \bar{z})*w = 0\)</span></p>
<p>Portanto, <span class="math inline">\(\sum({x -\bar{x}})*\bar{y}) = 0\)</span>.</p>
<p>Logo,</p>
<p><span class="math display">\[
\hat{\beta} =  n^{-1}*\sum({x - \bar{x}})*y_i/\mathbb{Var}[x]
\]</span>
Lembremos que, <span class="math inline">\(y_i = \alpha + \beta*X_i + e_i\)</span>. Se eu adicionar e subtrair <span class="math inline">\(\beta*\bar{x}\)</span> da equação, não altero ela. Utilizando esse truque e rearranjando, temos:</p>
<p><span class="math display">\[
y_i = \alpha + \beta*X_i + e_i = \alpha + \beta*\bar{x} + \beta*X_i - \beta*\bar{x} + e_i = \alpha + \beta*\bar{x} + \beta*(x_i - \bar{x}) + e_i
\]</span>
Substituindo na equação anterior, temos:</p>
<p><span class="math display">\[
\hat{\beta} =  n^{-1}*\sum({x - \bar{x}})*(\alpha + \beta*\bar{x} + \beta*(x_i - \bar{x}) + e_i)/\mathbb{Var}[x]
\]</span>
<span class="math display">\[
\hat{\beta} =  n^{-1}*(\alpha + \beta)\bar{x}\sum({x - \bar{x}})*(\beta*(x_i - \bar{x}) + e_i)/\mathbb{Var}[x]
\]</span>
<span class="math display">\[
\hat{\beta} =  n^{-1}*(\alpha + \beta)\bar{x}\sum({x - \bar{x}}) +  n^{-1}\beta\sum(x_i - \bar{x})^2 + n^{-1}\sum({x - \bar{x}})*e_i)/\mathbb{Var}[x]
\]</span>
A priemria soma é uma constante, vezes o somatório de <span class="math inline">\(x_i\)</span> menos sua média, o que é zero. A segunda soma é a variância de x multiplicada por <span class="math inline">\(\beta\)</span>. Então, simplifcando, temos:</p>
<p><span class="math display">\[
\hat{\beta} =  \beta +  n^{-1}\sum({x - \bar{x}})*e_i)/\mathbb{Var}[x]
\]</span></p>
<p>Portanto, nós mostramos que o estimador <span class="math inline">\(\hat{\beta}\)</span> pode ser decomposto no parâmetro populacional <span class="math inline">\(\beta\)</span> mais uma soma ponderada do termo de erro. Uma vez que nossa amostra é i.i.d., sabemos que é uma média ponderada dos erros não-correlacionados. Podemos agora mostrar que o estimador é não-viesado.</p>
<p><span class="math display">\[
\mathbb{E}[\hat{\beta}] =  \beta +  n^{-1}\mathbb{E}[\sum({x - \bar{x}})*e_i)]/\mathbb{Var}[x] = \beta +\mathbb{E}[e]*\mathbb{E}[\sum({x - \bar{x}})]\mathbb{Var}[x] = \beta
\]</span></p>
<p>Podemos similarmente calcular a variância do nosso estimador, e mostrar que ela é a variância do erro dividida pela variância de x vezes o tamanho da amostra, <span class="math inline">\(n\)</span>.</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = \mathbb{Var}[\beta +  n^{-1}\sum({x - \bar{x}})*e_i)/\mathbb{Var}[x]]
\]</span></p>
<p>Sabemos que <span class="math inline">\(\mathbb{Var}[x + a] = \mathbb{Var}[x]\)</span>. Então, podemos eliminar o <span class="math inline">\(\beta\)</span> da equação.</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = \mathbb{Var}[n^{-1}\sum({x - \bar{x}})*e_i)/\mathbb{Var}[x]]
\]</span></p>
<p>Todas as observações do <span class="math inline">\(x\)</span> foram observadas e, portanto, a soma da diferença para a média é uma constante. Sabemos que <span class="math inline">\(\mathbb{Var}[x*a] = a^2\mathbb{Var}[x]\)</span></p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = (n^{-1}\sum({x - \bar{x}}))^2*\mathbb{Var}[e_i/\mathbb{Var}[x]]
\]</span>
Supondo homocedasticidade, [e_i] = ^2$</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta}] = (n^{-1}\sum({x - \bar{x}}))^2*\mathbb{Var}[e_i/\mathbb{Var}[x]]
\]</span></p>
<p>Vamos começar com um exemplo, importando dados do site Base de Dados, que possui muitas bases de dados públicas, já tratadas. Para tanto, precisaremos criar um projeto no Google cloud, conforme os passos aqui: <a href="https://basedosdados.github.io/mais/access_data_packages/" class="uri">https://basedosdados.github.io/mais/access_data_packages/</a></p>
<p>Depois, só escolher quais dos dados iremos olhar
<a href="https://basedosdados.org/" class="uri">https://basedosdados.org/</a></p>
<p>Escolhi mexer com dados do censo escolar</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="estimação.html#cb16-1" tabindex="-1"></a><span class="co"># instalando a biblioteca</span></span>
<span id="cb16-2"><a href="estimação.html#cb16-2" tabindex="-1"></a><span class="co"># install.packages(&#39;basedosdados&#39;)</span></span>
<span id="cb16-3"><a href="estimação.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="estimação.html#cb16-4" tabindex="-1"></a><span class="co"># carregando a biblioteca na sessão</span></span>
<span id="cb16-5"><a href="estimação.html#cb16-5" tabindex="-1"></a><span class="fu">library</span>(basedosdados)</span>
<span id="cb16-6"><a href="estimação.html#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="estimação.html#cb16-7" tabindex="-1"></a><span class="co"># para importar os dadosdiretamente no R, precisamos criar um id para acessar a base de dados</span></span>
<span id="cb16-8"><a href="estimação.html#cb16-8" tabindex="-1"></a><span class="fu">set_billing_id</span>(<span class="st">&quot;aula-reg-manoel&quot;</span>)</span>
<span id="cb16-9"><a href="estimação.html#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="estimação.html#cb16-10" tabindex="-1"></a><span class="co"># checando que deu certo</span></span>
<span id="cb16-11"><a href="estimação.html#cb16-11" tabindex="-1"></a><span class="fu">get_billing_id</span>()</span></code></pre></div>
<pre><code>## [1] &quot;aula-reg-manoel&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="estimação.html#cb18-1" tabindex="-1"></a><span class="co"># importando dados</span></span>
<span id="cb18-2"><a href="estimação.html#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="estimação.html#cb18-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">here</span>(<span class="st">&quot;imagens&quot;</span>, <span class="st">&quot;autenticacao base dados.jpg&quot;</span>))</span></code></pre></div>
<p><img src="imagens/autenticacao%20base%20dados.jpg" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="estimação.html#cb19-1" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&quot;SELECT * FROM `basedosdados.br_inep_censo_escolar.escola` where sigla_uf = &#39;AL&#39; and id_municipio = &#39;2704302&#39; and ano = 2019&quot;</span> </span>
<span id="cb19-2"><a href="estimação.html#cb19-2" tabindex="-1"></a>escola <span class="ot">&lt;-</span> <span class="fu">read_sql</span>(query)</span>
<span id="cb19-3"><a href="estimação.html#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="estimação.html#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="estimação.html#cb19-5" tabindex="-1"></a><span class="co"># query &lt;- &quot;SELECT count(*) as contagem, id_municipio FROM `basedosdados.br_inep_censo_escolar.escola` where sigla_uf = &#39;AL&#39; and ano = 2019 group by id_municipio&quot; </span></span>
<span id="cb19-6"><a href="estimação.html#cb19-6" tabindex="-1"></a><span class="co"># escola &lt;- read_sql(query)</span></span>
<span id="cb19-7"><a href="estimação.html#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="estimação.html#cb19-8" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&quot;SELECT * FROM `basedosdados.br_inep_censo_escolar.dicionario`&quot;</span></span>
<span id="cb19-9"><a href="estimação.html#cb19-9" tabindex="-1"></a>dicionario <span class="ot">&lt;-</span> <span class="fu">read_sql</span>(query)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="estimação.html#cb20-1" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">&quot;SELECT * FROM `basedosdados.br_inep_censo_escolar.matricula` where sigla_uf = &#39;AL&#39; and id_municipio = &#39;2704302&#39; and ano = 2019&quot;</span></span>
<span id="cb20-2"><a href="estimação.html#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="estimação.html#cb20-3" tabindex="-1"></a>aluno <span class="ot">&lt;-</span> <span class="fu">read_sql</span>(query)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="estimação.html#cb21-1" tabindex="-1"></a><span class="co"># dicionário de gênero e raça</span></span>
<span id="cb21-2"><a href="estimação.html#cb21-2" tabindex="-1"></a><span class="co"># dicionario %&gt;%</span></span>
<span id="cb21-3"><a href="estimação.html#cb21-3" tabindex="-1"></a><span class="co">#   dplyr::filter(id_tabela == &quot;matricula&quot;, nome_coluna %in% c(&quot;sexo&quot;, &quot;raca_cor&quot;))</span></span>
<span id="cb21-4"><a href="estimação.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="estimação.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="estimação.html#cb21-6" tabindex="-1"></a>aluno_gen <span class="ot">&lt;-</span> aluno <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="estimação.html#cb21-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(regular <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="estimação.html#cb21-8" tabindex="-1"></a>  <span class="fu">group_by</span>(id_escola, sexo) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="estimação.html#cb21-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_aluno_gen =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="estimação.html#cb21-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">gsub</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;Male&quot;</span>, sexo),</span>
<span id="cb21-11"><a href="estimação.html#cb21-11" tabindex="-1"></a>         <span class="at">sexo =</span> <span class="fu">gsub</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;Female&quot;</span>, sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="estimação.html#cb21-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(num_aluno_gen),</span>
<span id="cb21-13"><a href="estimação.html#cb21-13" tabindex="-1"></a>            <span class="at">percent =</span> num_aluno_gen<span class="sc">/</span>total) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="estimação.html#cb21-14" tabindex="-1"></a>  <span class="fu">filter</span>(sexo <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="estimação.html#cb21-15" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">percent_female =</span> percent) <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="estimação.html#cb21-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id_escola, percent_female)</span>
<span id="cb21-17"><a href="estimação.html#cb21-17" tabindex="-1"></a>         </span>
<span id="cb21-18"><a href="estimação.html#cb21-18" tabindex="-1"></a>aluno_raca <span class="ot">&lt;-</span> aluno <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="estimação.html#cb21-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(regular <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="estimação.html#cb21-20" tabindex="-1"></a>  <span class="fu">group_by</span>(id_escola, raca_cor) <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="estimação.html#cb21-21" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_aluno_raca =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-22"><a href="estimação.html#cb21-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;Branca&quot;</span>, raca_cor),</span>
<span id="cb21-23"><a href="estimação.html#cb21-23" tabindex="-1"></a>         <span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;Preta&quot;</span>, raca_cor),</span>
<span id="cb21-24"><a href="estimação.html#cb21-24" tabindex="-1"></a>         <span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;3&quot;</span>, <span class="st">&quot;Parda&quot;</span>, raca_cor)) <span class="sc">%&gt;%</span></span>
<span id="cb21-25"><a href="estimação.html#cb21-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(num_aluno_raca),</span>
<span id="cb21-26"><a href="estimação.html#cb21-26" tabindex="-1"></a>         <span class="at">percent =</span> num_aluno_raca<span class="sc">/</span>total) <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="estimação.html#cb21-27" tabindex="-1"></a>  <span class="fu">filter</span>(raca_cor <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Branca&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;Preta&quot;</span>, <span class="st">&quot;Parda&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-28"><a href="estimação.html#cb21-28" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">raca_cor =</span> <span class="fu">gsub</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;não_declarado&quot;</span>, raca_cor)) <span class="sc">%&gt;%</span></span>
<span id="cb21-29"><a href="estimação.html#cb21-29" tabindex="-1"></a>  <span class="fu">select</span>(id_escola, raca_cor, percent) <span class="sc">%&gt;%</span></span>
<span id="cb21-30"><a href="estimação.html#cb21-30" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> raca_cor , <span class="at">values_from =</span> percent )</span>
<span id="cb21-31"><a href="estimação.html#cb21-31" tabindex="-1"></a></span>
<span id="cb21-32"><a href="estimação.html#cb21-32" tabindex="-1"></a></span>
<span id="cb21-33"><a href="estimação.html#cb21-33" tabindex="-1"></a></span>
<span id="cb21-34"><a href="estimação.html#cb21-34" tabindex="-1"></a>aluno_escola <span class="ot">&lt;-</span> aluno_gen <span class="sc">%&gt;%</span></span>
<span id="cb21-35"><a href="estimação.html#cb21-35" tabindex="-1"></a>  <span class="fu">inner_join</span>(aluno_raca,  <span class="at">by =</span> <span class="st">&quot;id_escola&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-36"><a href="estimação.html#cb21-36" tabindex="-1"></a>  <span class="fu">inner_join</span>(escola, <span class="at">by =</span> <span class="st">&quot;id_escola&quot;</span>)</span>
<span id="cb21-37"><a href="estimação.html#cb21-37" tabindex="-1"></a></span>
<span id="cb21-38"><a href="estimação.html#cb21-38" tabindex="-1"></a>aluno_escola_reg <span class="ot">&lt;-</span> aluno_escola <span class="sc">%&gt;%</span></span>
<span id="cb21-39"><a href="estimação.html#cb21-39" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-40"><a href="estimação.html#cb21-40" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">negra =</span> Preta <span class="sc">+</span> Parda) <span class="sc">%&gt;%</span></span>
<span id="cb21-41"><a href="estimação.html#cb21-41" tabindex="-1"></a>  <span class="fu">select</span>(negra, percent_female, tipo_localizacao, agua_potavel, esgoto_rede_publica, </span>
<span id="cb21-42"><a href="estimação.html#cb21-42" tabindex="-1"></a>         lixo_servico_coleta, area_verde, biblioteca, quantidade_profissional_psicologo) <span class="sc">%&gt;%</span></span>
<span id="cb21-43"><a href="estimação.html#cb21-43" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb21-44"><a href="estimação.html#cb21-44" tabindex="-1"></a>  <span class="fu">mutate_if</span>(bit64<span class="sc">::</span>is.integer64, as.factor)</span>
<span id="cb21-45"><a href="estimação.html#cb21-45" tabindex="-1"></a></span>
<span id="cb21-46"><a href="estimação.html#cb21-46" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(negra <span class="sc">~</span>  percent_female <span class="sc">+</span> tipo_localizacao <span class="sc">+</span> agua_potavel  <span class="sc">+</span> esgoto_rede_publica <span class="sc">+</span> lixo_servico_coleta <span class="sc">+</span> area_verde <span class="sc">+</span> biblioteca <span class="sc">+</span> quantidade_profissional_psicologo, <span class="at">data=</span> aluno_escola_reg)</span>
<span id="cb21-47"><a href="estimação.html#cb21-47" tabindex="-1"></a></span>
<span id="cb21-48"><a href="estimação.html#cb21-48" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = negra ~ percent_female + tipo_localizacao + agua_potavel + 
##     esgoto_rede_publica + lixo_servico_coleta + area_verde + 
##     biblioteca + quantidade_profissional_psicologo, data = aluno_escola_reg)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.46731 -0.16217 -0.01934  0.17534  0.55176 
## 
## Coefficients:
##                                     Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                         0.070584   0.204310   0.345  0.72991   
## percent_female                      0.400443   0.256195   1.563  0.11880   
## tipo_localizacao2                  -0.251352   0.224599  -1.119  0.26373   
## agua_potavel1                       0.067306   0.052684   1.278  0.20212   
## esgoto_rede_publica1               -0.069037   0.022951  -3.008  0.00279 **
## lixo_servico_coleta1                0.144155   0.158554   0.909  0.36378   
## area_verde1                         0.047138   0.025681   1.836  0.06714 . 
## biblioteca1                         0.009462   0.022531   0.420  0.67473   
## quantidade_profissional_psicologo1 -0.069969   0.033593  -2.083  0.03787 * 
## quantidade_profissional_psicologo2 -0.120828   0.092870  -1.301  0.19396   
## quantidade_profissional_psicologo3 -0.306991   0.130754  -2.348  0.01935 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2222 on 418 degrees of freedom
## Multiple R-squared:  0.07237,    Adjusted R-squared:  0.05017 
## F-statistic: 3.261 on 10 and 418 DF,  p-value: 0.0004498</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cef-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="causalidade.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mgaldino/book-regression/edit/main/07-estimacao.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mgaldino/book-regression/blob/main/07-estimacao.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
