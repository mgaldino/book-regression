<!DOCTYPE html>
<html lang="pt" xml:lang="pt">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 - Checagem | Introdução à Regresssão para Ciências Sociais</title>
  <meta name="description" content="Capítulo 10 - Checagem | Introdução à Regresssão para Ciências Sociais" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 - Checagem | Introdução à Regresssão para Ciências Sociais" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 - Checagem | Introdução à Regresssão para Ciências Sociais" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2025-08-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mle.html"/>
<link rel="next" href="inferencia.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Regressão</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="10-Checagem.html"><a href="#pref%C3%A1cio"><i class="fa fa-check"></i><b>1</b> - Prefácio</a></li>
<li class="chapter" data-level="2" data-path="10-Checagem.html"><a href="#revis%C3%A3o-de-r"><i class="fa fa-check"></i><b>2</b> - Revisão de R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html"><i class="fa fa-check"></i><b>2.1</b> R e Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-como-calculadora"><i class="fa fa-check"></i><b>2.2</b> R como calculadora</a></li>
<li class="chapter" data-level="2.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#objetos-no-r"><i class="fa fa-check"></i><b>2.3</b> Objetos no R</a></li>
<li class="chapter" data-level="2.4" data-path="revisão-de-r.html"><a href="revisão-de-r.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.4</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#numeric"><i class="fa fa-check"></i><b>2.4.1</b> Numeric</a></li>
<li class="chapter" data-level="2.4.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#character"><i class="fa fa-check"></i><b>2.4.2</b> character</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="revisão-de-r.html"><a href="revisão-de-r.html#armazenando-dados"><i class="fa fa-check"></i><b>2.5</b> Armazenando dados</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#vetor"><i class="fa fa-check"></i><b>2.5.1</b> Vetor</a></li>
<li class="chapter" data-level="2.5.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#matriz"><i class="fa fa-check"></i><b>2.5.2</b> Matriz</a></li>
<li class="chapter" data-level="2.5.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-frame"><i class="fa fa-check"></i><b>2.5.3</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="revisão-de-r.html"><a href="revisão-de-r.html#bibliotecaspacotes"><i class="fa fa-check"></i><b>2.6</b> Bibliotecas/pacotes</a></li>
<li class="chapter" data-level="2.7" data-path="revisão-de-r.html"><a href="revisão-de-r.html#importando-dados"><i class="fa fa-check"></i><b>2.7</b> importando dados</a></li>
<li class="chapter" data-level="2.8" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-wrangling"><i class="fa fa-check"></i><b>2.8</b> Data wrangling</a></li>
<li class="chapter" data-level="2.9" data-path="10-Checagem.html"><a href="#visualiza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.9</b> Visualização</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="10-Checagem.html"><a href="#revis%C3%A3o-de-estat%C3%ADstica-e-probabilidade"><i class="fa fa-check"></i><b>3</b> - Revisão de estatística e probabilidade</a>
<ul>
<li class="chapter" data-level="3.1" data-path="10-Checagem.html"><a href="#vari%C3%A1vel-aleat%C3%B3ria"><i class="fa fa-check"></i><b>3.1</b> Variável Aleatória</a></li>
<li class="chapter" data-level="3.2" data-path="10-Checagem.html"><a href="#esperan%C3%A7a-matem%C3%A1tica"><i class="fa fa-check"></i><b>3.2</b> Esperança matemática</a></li>
<li class="chapter" data-level="3.3" data-path="10-Checagem.html"><a href="#vari%C3%A2ncia"><i class="fa fa-check"></i><b>3.3</b> Variância</a></li>
<li class="chapter" data-level="3.4" data-path="10-Checagem.html"><a href="#%C3%A1lgebra-com-esperan%C3%A7a-vari%C3%A2ncia-e-covari%C3%A2ncia"><i class="fa fa-check"></i><b>3.4</b> Álgebra com Esperança, Variância e Covariância</a></li>
<li class="chapter" data-level="3.5" data-path="10-Checagem.html"><a href="#prova-da-identidade-da-vari%C3%A2ncia"><i class="fa fa-check"></i><b>3.5</b> Prova da identidade da variância</a></li>
<li class="chapter" data-level="3.6" data-path="10-Checagem.html"><a href="#distribui%C3%A7%C3%A3o-de-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.6</b> Distribuição de Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.7" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html"><i class="fa fa-check"></i><b>3.7</b> Probabilidade Condicional</a></li>
<li class="chapter" data-level="3.8" data-path="10-Checagem.html"><a href="#esperan%C3%A7a-condicional"><i class="fa fa-check"></i><b>3.8</b> Esperança Condicional</a></li>
<li class="chapter" data-level="3.9" data-path="10-Checagem.html"><a href="#proje%C3%A7%C3%A3o-linear"><i class="fa fa-check"></i><b>3.9</b> Projeção Linear</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="10-Checagem.html"><a href="#adi%C3%A7%C3%A3o-de-vetores"><i class="fa fa-check"></i><b>3.9.1</b> Adição de vetores</a></li>
<li class="chapter" data-level="3.9.2" data-path="10-Checagem.html"><a href="#proje%C3%A7%C3%A3o-linear-1"><i class="fa fa-check"></i><b>3.9.2</b> Projeção linear</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="10-Checagem.html"><a href="#introdu%C3%A7%C3%A3o-%C3%A0-simula%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4</b> Introdução à Simulação</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html"><i class="fa fa-check"></i><b>4.1</b> Objetivos</a></li>
<li class="chapter" data-level="4.2" data-path="10-Checagem.html"><a href="#introdu%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4.2</b> Introdução</a></li>
<li class="chapter" data-level="4.3" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#dgp-processo-gerador-de-dados"><i class="fa fa-check"></i><b>4.3</b> DGP — Processo Gerador de Dados</a></li>
<li class="chapter" data-level="4.4" data-path="10-Checagem.html"><a href="#simula%C3%A7%C3%A3o-de-monte-carlo"><i class="fa fa-check"></i><b>4.4</b> Simulação de Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simulando-um-dado"><i class="fa fa-check"></i><b>4.4.1</b> Simulando um dado</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="10-Checagem.html"><a href="#configura%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4.5</b> Configuração</a></li>
<li class="chapter" data-level="4.6" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simular"><i class="fa fa-check"></i><b>4.6</b> Simular</a></li>
<li class="chapter" data-level="4.7" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#resumir"><i class="fa fa-check"></i><b>4.7</b> Resumir</a></li>
<li class="chapter" data-level="4.8" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#lgn-e-tcl"><i class="fa fa-check"></i><b>4.8</b> LGN e TCL</a></li>
<li class="chapter" data-level="4.9" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#cobertura-de-um-ic"><i class="fa fa-check"></i><b>4.9</b> Cobertura de um IC</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="10-Checagem.html"><a href="#o-modelo-de-regress%C3%A3o"><i class="fa fa-check"></i><b>5</b> O Modelo de Regressão</a>
<ul>
<li class="chapter" data-level="5.1" data-path="10-Checagem.html"><a href="#modelo-de-regress%C3%A3o---teoria"><i class="fa fa-check"></i><b>5.1</b> Modelo de Regressão - Teoria</a></li>
<li class="chapter" data-level="5.2" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html"><i class="fa fa-check"></i><b>5.2</b> CEF</a></li>
<li class="chapter" data-level="5.3" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#cef-e-voto"><i class="fa fa-check"></i><b>5.3</b> CEF e voto</a></li>
<li class="chapter" data-level="5.4" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#algumas-propriedades-da-cef"><i class="fa fa-check"></i><b>5.4</b> Algumas Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="10-Checagem.html"><a href="#cef-%C3%A9-a-melhor-aproxima%C3%A7%C3%A3o-aos-dados"><i class="fa fa-check"></i><b>5.4.1</b> CEF é a melhor aproximação aos dados</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="10-Checagem.html"><a href="#regress%C3%A3o-linear"><i class="fa fa-check"></i><b>5.5</b> Regressão Linear</a></li>
<li class="chapter" data-level="5.6" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#logaritmos"><i class="fa fa-check"></i><b>5.6</b> Logaritmos</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="10-Checagem.html"><a href="#logartimos-como-diferen%C3%A7a-de-porcentagens"><i class="fa fa-check"></i><b>5.6.1</b> Logartimos como diferença de porcentagens</a></li>
<li class="chapter" data-level="5.6.2" data-path="10-Checagem.html"><a href="#logaritmos-e-m%C3%A9dia-geom%C3%A9trica"><i class="fa fa-check"></i><b>5.6.2</b> Logaritmos e média geométrica</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="10-Checagem.html"><a href="#prevendo-a-partir-da-esperan%C3%A7a-condicional"><i class="fa fa-check"></i><b>5.7</b> Prevendo a partir da esperança condicional</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cef-1.html"><a href="cef-1.html"><i class="fa fa-check"></i><b>6</b> - CEF</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cef-1.html"><a href="cef-1.html#erro-da-cef"><i class="fa fa-check"></i><b>6.1</b> Erro da CEF</a></li>
<li class="chapter" data-level="6.2" data-path="cef-1.html"><a href="cef-1.html#simulando-para-entender-a-cef"><i class="fa fa-check"></i><b>6.2</b> Simulando para entender a CEF</a></li>
<li class="chapter" data-level="6.3" data-path="cef-1.html"><a href="cef-1.html#propriedades-da-cef"><i class="fa fa-check"></i><b>6.3</b> Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="10-Checagem.html"><a href="#a-esperan%C3%A7a-do-erro-condicional-a-x-%C3%A9-zero"><i class="fa fa-check"></i><b>6.3.1</b> A Esperança do Erro Condicional a X é zero</a></li>
<li class="chapter" data-level="6.3.2" data-path="10-Checagem.html"><a href="#a-esperan%C3%A7a-n%C3%A3o-condicional-do-erro-%C3%A9-zero."><i class="fa fa-check"></i><b>6.3.2</b> A esperança (não-condicional) do erro é zero.</a></li>
<li class="chapter" data-level="6.3.3" data-path="10-Checagem.html"><a href="#o-erro-da-cef-%C3%A9-n%C3%A3o-correlacionado-com-x"><i class="fa fa-check"></i><b>6.3.3</b> O erro da CEF é não-correlacionado com X</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="10-Checagem.html"><a href="#regress%C3%A3o-linear-e-a-cef"><i class="fa fa-check"></i><b>6.4</b> Regressão Linear e a CEF</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="10-Checagem.html"><a href="#m%C3%ADnimos-quadrados-ordin%C3%A1rios"><i class="fa fa-check"></i><b>6.4.1</b> Mínimos Quadrados Ordinários</a></li>
<li class="chapter" data-level="6.4.2" data-path="10-Checagem.html"><a href="#suponha-que-a-cef-%C3%A9-linear-justificativa-i"><i class="fa fa-check"></i><b>6.4.2</b> Suponha que a CEF é Linear (Justificativa I)</a></li>
<li class="chapter" data-level="6.4.3" data-path="10-Checagem.html"><a href="#%C3%A9-o-melhor-preditor-linear-do-y-justificativa-ii"><i class="fa fa-check"></i><b>6.4.3</b> É o melhor preditor linear do <span class="math inline">\(Y\)</span> (justificativa II)</a></li>
<li class="chapter" data-level="6.4.4" data-path="10-Checagem.html"><a href="#a-reta-de-regress%C3%A3o-%C3%A9-a-aproxima%C3%A7%C3%A3o-com-o-menor-erro-quadr%C3%A1tico-m%C3%A9dio-justificativa-iii"><i class="fa fa-check"></i><b>6.4.4</b> A reta de regressão é a aproximação com o menor erro quadrático médio (justificativa III)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cef-1.html"><a href="cef-1.html#linearidade-e-causalidade"><i class="fa fa-check"></i><b>6.5</b> Linearidade e Causalidade</a></li>
<li class="chapter" data-level="6.6" data-path="10-Checagem.html"><a href="#modelo-s%C3%B3-com-intercepto"><i class="fa fa-check"></i><b>6.6</b> Modelo só com intercepto</a></li>
<li class="chapter" data-level="6.7" data-path="10-Checagem.html"><a href="#vari%C3%A2ncia-da-regress%C3%A3o"><i class="fa fa-check"></i><b>6.7</b> Variância da Regressão</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="cef-1.html"><a href="cef-1.html#chuva-na-jamaica"><i class="fa fa-check"></i><b>6.7.1</b> Chuva na Jamaica</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="10-Checagem.html"><a href="#vari%C3%A2ncia-condicional"><i class="fa fa-check"></i><b>6.8</b> Variância condicional</a></li>
<li class="chapter" data-level="6.9" data-path="cef-1.html"><a href="cef-1.html#efeito-marginal"><i class="fa fa-check"></i><b>6.9</b> Efeito Marginal</a></li>
<li class="chapter" data-level="6.10" data-path="10-Checagem.html"><a href="#cef-linear-com-preditores-n%C3%A3o-lineares"><i class="fa fa-check"></i><b>6.10</b> CEF linear com preditores não-lineares</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="10-Checagem.html"><a href="#estima%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7</b> - Estimação</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimação.html"><a href="estimação.html"><i class="fa fa-check"></i><b>7.1</b> Plug-in estimators</a></li>
<li class="chapter" data-level="7.2" data-path="estimação.html"><a href="estimação.html#simulando-de-uma-normal-bivariada"><i class="fa fa-check"></i><b>7.2</b> Simulando de uma Normal Bivariada</a></li>
<li class="chapter" data-level="7.3" data-path="10-Checagem.html"><a href="#suposi%C3%A7%C3%B5es-amostrais-de-mqo"><i class="fa fa-check"></i><b>7.3</b> Suposições amostrais de MQO</a></li>
<li class="chapter" data-level="7.4" data-path="10-Checagem.html"><a href="#modelo-de-m%C3%A9dia-amostral"><i class="fa fa-check"></i><b>7.4</b> Modelo de Média amostral</a></li>
<li class="chapter" data-level="7.5" data-path="10-Checagem.html"><a href="#modelo-de-regress%C3%A3o-linear-com-preditores"><i class="fa fa-check"></i><b>7.5</b> Modelo de Regressão Linear com preditores</a></li>
<li class="chapter" data-level="7.6" data-path="10-Checagem.html"><a href="#estimando-um-modelo-de-regress%C3%A3o-real"><i class="fa fa-check"></i><b>7.6</b> Estimando um modelo de regressão real</a></li>
<li class="chapter" data-level="7.7" data-path="10-Checagem.html"><a href="#limita%C3%A7%C3%B5es-de-mqo"><i class="fa fa-check"></i><b>7.7</b> Limitações de MQO</a></li>
<li class="chapter" data-level="7.8" data-path="10-Checagem.html"><a href="#distra%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>7.8</b> Distrações</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="estimação.html"><a href="estimação.html#r-quadrado"><i class="fa fa-check"></i><b>7.8.1</b> R-quadrado</a></li>
<li class="chapter" data-level="7.8.2" data-path="estimação.html"><a href="estimação.html#r-quadrado-ajustado"><i class="fa fa-check"></i><b>7.8.2</b> R-quadrado ajustado</a></li>
<li class="chapter" data-level="7.8.3" data-path="estimação.html"><a href="estimação.html#limites-do-r-quadrado"><i class="fa fa-check"></i><b>7.8.3</b> Limites do R-quadrado</a></li>
<li class="chapter" data-level="7.8.4" data-path="estimação.html"><a href="estimação.html#para-que-serve"><i class="fa fa-check"></i><b>7.8.4</b> Para que serve?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="causalidade.html"><a href="causalidade.html"><i class="fa fa-check"></i><b>8</b> - Causalidade</a>
<ul>
<li class="chapter" data-level="8.1" data-path="causalidade.html"><a href="causalidade.html#resultados-potenciais"><i class="fa fa-check"></i><b>8.1</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="10-Checagem.html"><a href="#decomposi%C3%A7%C3%A3o-do-efeito-causal"><i class="fa fa-check"></i><b>8.1.1</b> Decomposição do Efeito Causal</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="10-Checagem.html"><a href="#modelo-estrutural-e-modelo-de-regress%C3%A3o"><i class="fa fa-check"></i><b>8.2</b> Modelo estrutural e modelo de regressão</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="causalidade.html"><a href="causalidade.html#exemplo-de-cef-e-cef-estrutural"><i class="fa fa-check"></i><b>8.2.1</b> Exemplo de CEF e CEF estrutural</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="10-Checagem.html"><a href="#simula%C3%A7%C3%A3o-de-resultados-potenciais-e-causalidade"><i class="fa fa-check"></i><b>8.3</b> Simulação de Resultados Potenciais e Causalidade</a></li>
<li class="chapter" data-level="8.4" data-path="10-Checagem.html"><a href="#refer%C3%AAncias"><i class="fa fa-check"></i><b>8.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mle.html"><a href="mle.html"><i class="fa fa-check"></i><b>9</b> - MLE</a>
<ul>
<li class="chapter" data-level="9.1" data-path="10-Checagem.html"><a href="#estima%C3%A7%C3%A3o-por-m%C3%A1xima-verossimilhan%C3%A7a"><i class="fa fa-check"></i><b>9.1</b> Estimação por Máxima Verossimilhança</a></li>
<li class="chapter" data-level="9.2" data-path="10-Checagem.html"><a href="#teste-de-hip%C3%B3tese"><i class="fa fa-check"></i><b>9.2</b> Teste de hipótese</a></li>
<li class="chapter" data-level="9.3" data-path="10-Checagem.html"><a href="#regress%C3%A3o"><i class="fa fa-check"></i><b>9.3</b> regressão</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="checagem.html"><a href="checagem.html"><i class="fa fa-check"></i><b>10</b> - Checagem</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-Checagem.html"><a href="#res%C3%ADduos"><i class="fa fa-check"></i><b>10.1</b> Resíduos</a></li>
<li class="chapter" data-level="10.2" data-path="checagem.html"><a href="checagem.html#modelo-no-r"><i class="fa fa-check"></i><b>10.2</b> Modelo no R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-Checagem.html"><a href="#res%C3%ADduos-contra-o-preditor"><i class="fa fa-check"></i><b>10.2.1</b> Resíduos contra o preditor</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-Checagem.html"><a href="#magnitude-dos-res%C3%ADduos-contra-o-preditor"><i class="fa fa-check"></i><b>10.2.2</b> Magnitude dos Resíduos Contra o Preditor</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-Checagem.html"><a href="#res%C3%ADduos-com-dados-temporais-eou-espaciais"><i class="fa fa-check"></i><b>10.2.3</b> Resíduos com dados Temporais e/ou Espaciais</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-Checagem.html"><a href="#normalidade-dos-res%C3%ADduos"><i class="fa fa-check"></i><b>10.3</b> Normalidade dos resíduos</a></li>
<li class="chapter" data-level="10.4" data-path="10-Checagem.html"><a href="#generaliza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>10.4</b> Generalização</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inferencia.html"><a href="inferencia.html"><i class="fa fa-check"></i><b>11</b> - Inferencia</a>
<ul>
<li class="chapter" data-level="11.1" data-path="inferencia.html"><a href="inferencia.html#normal"><i class="fa fa-check"></i><b>11.1</b> Normal</a></li>
<li class="chapter" data-level="11.2" data-path="inferencia.html"><a href="inferencia.html#t-student"><i class="fa fa-check"></i><b>11.2</b> T-student</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="10-Checagem.html"><a href="#avan%C3%A7ado---deriva%C3%A7%C3%A3o-da-t--de-student"><i class="fa fa-check"></i><b>11.2.1</b> Avançado - Derivação da t- de student</a></li>
<li class="chapter" data-level="11.2.2" data-path="inferencia.html"><a href="inferencia.html#teste-t"><i class="fa fa-check"></i><b>11.2.2</b> Teste t</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="10-Checagem.html"><a href="#teste-de-hip%C3%B3tese-e-ic"><i class="fa fa-check"></i><b>11.3</b> Teste de Hipótese e IC</a></li>
<li class="chapter" data-level="11.4" data-path="10-Checagem.html"><a href="#propriedades-assint%C3%B3ticas"><i class="fa fa-check"></i><b>11.4</b> Propriedades Assintóticas</a></li>
<li class="chapter" data-level="11.5" data-path="10-Checagem.html"><a href="#infer%C3%AAncia-preditiva"><i class="fa fa-check"></i><b>11.5</b> Inferência Preditiva</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="regressao-multipla.html"><a href="regressao-multipla.html"><i class="fa fa-check"></i><b>12</b> - Regressao Multipla</a>
<ul>
<li class="chapter" data-level="12.1" data-path="10-Checagem.html"><a href="#revis%C3%A3o-de-matriz-e-vetores"><i class="fa fa-check"></i><b>12.1</b> Revisão de Matriz e Vetores</a></li>
<li class="chapter" data-level="12.2" data-path="10-Checagem.html"><a href="#modelo-b%C3%A1sico"><i class="fa fa-check"></i><b>12.2</b> Modelo básico</a></li>
<li class="chapter" data-level="12.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#modelo-com-matrizes"><i class="fa fa-check"></i><b>12.3</b> Modelo com matrizes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#estimador-de-mqo"><i class="fa fa-check"></i><b>12.3.1</b> Estimador de MQO</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="10-Checagem.html"><a href="#interpreta%C3%A7%C3%A3o-dos-coeficientes"><i class="fa fa-check"></i><b>12.4</b> Interpretação dos coeficientes</a></li>
<li class="chapter" data-level="12.5" data-path="10-Checagem.html"><a href="#regress%C3%A3o-m%C3%BAltipla-versus-m%C3%BAltiplas-regress%C3%B5es-separadas-ou-vi%C3%A9s-de-vari%C3%A1vel-omitida"><i class="fa fa-check"></i><b>12.5</b> Regressão múltipla versus Múltiplas Regressões Separadas ou Viés de variável omitida</a></li>
<li class="chapter" data-level="12.6" data-path="10-Checagem.html"><a href="#matriz-chap%C3%A9u"><i class="fa fa-check"></i><b>12.6</b> Matriz chapéu</a></li>
<li class="chapter" data-level="12.7" data-path="regressao-multipla.html"><a href="regressao-multipla.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.8" data-path="10-Checagem.html"><a href="#erro-padr%C3%A3o-robusto"><i class="fa fa-check"></i><b>12.8</b> Erro padrão Robusto</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="10-Checagem.html"><a href="#entendendo-o-erro-padr%C3%A3o-robusto"><i class="fa fa-check"></i><b>12.8.1</b> Entendendo o erro padrão robusto</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="10-Checagem.html"><a href="#termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9</b> Termo de interação</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="10-Checagem.html"><a href="#vari%C3%A2ncia-do-termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9.1</b> Variância do termo de interação</a></li>
<li class="chapter" data-level="12.9.2" data-path="10-Checagem.html"><a href="#calculando-o-erro-padr%C3%A3o-do-termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9.2</b> Calculando o erro padrão do termo de interação</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="10-Checagem.html"><a href="#an%C3%A1lise-de-sensibilidade-causal"><i class="fa fa-check"></i><b>12.10</b> Análise de sensibilidade causal</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="10-Checagem.html"><a href="#deriva%C3%A7%C3%A3o-do-r-quadrado"><i class="fa fa-check"></i><b>12.10.1</b> Derivação do R-quadrado</a></li>
<li class="chapter" data-level="12.10.2" data-path="10-Checagem.html"><a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida"><i class="fa fa-check"></i><b>12.10.2</b> Viés de variável omitida</a></li>
<li class="chapter" data-level="12.10.3" data-path="10-Checagem.html"><a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida-em-fun%C3%A7%C3%A3o-do-r-quadrado"><i class="fa fa-check"></i><b>12.10.3</b> Viés de variável omitida em função do R-quadrado</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="10-Checagem.html"><a href="#refer%C3%AAncias-1"><i class="fa fa-check"></i><b>12.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>13</b> - GLM</a>
<ul>
<li class="chapter" data-level="13.1" data-path="glm.html"><a href="glm.html#plm"><i class="fa fa-check"></i><b>13.1</b> PLM</a></li>
<li class="chapter" data-level="13.2" data-path="10-Checagem.html"><a href="#log%C3%ADstica"><i class="fa fa-check"></i><b>13.2</b> Logística</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="10-Checagem.html"><a href="#log%C3%ADstica-como-melhoria-em-rela%C3%A7%C3%A3o-ao-mpl"><i class="fa fa-check"></i><b>13.2.1</b> Logística como melhoria em relação ao MPL</a></li>
<li class="chapter" data-level="13.2.2" data-path="glm.html"><a href="glm.html#logito"><i class="fa fa-check"></i><b>13.2.2</b> Logito</a></li>
<li class="chapter" data-level="13.2.3" data-path="10-Checagem.html"><a href="#odds-ratio---raz%C3%A3o-de-chances"><i class="fa fa-check"></i><b>13.2.3</b> Odds Ratio - Razão de chances</a></li>
<li class="chapter" data-level="13.2.4" data-path="10-Checagem.html"><a href="#coeficientes-e-erros-padr%C3%B5es"><i class="fa fa-check"></i><b>13.2.4</b> Coeficientes e erros padrões</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="10-Checagem.html"><a href="#log%C3%ADstica-como-vari%C3%A1vel-latente"><i class="fa fa-check"></i><b>13.3</b> Logística como variável latente</a></li>
<li class="chapter" data-level="13.4" data-path="glm.html"><a href="glm.html#probit"><i class="fa fa-check"></i><b>13.4</b> Probit</a></li>
<li class="chapter" data-level="13.5" data-path="10-Checagem.html"><a href="#log%C3%ADstica-como-glm"><i class="fa fa-check"></i><b>13.5</b> Logística como GLM</a></li>
<li class="chapter" data-level="13.6" data-path="10-Checagem.html"><a href="#log%C3%ADstica-com-m%C3%BAltiplos-preditores"><i class="fa fa-check"></i><b>13.6</b> Logística com múltiplos preditores</a></li>
<li class="chapter" data-level="13.7" data-path="glm.html"><a href="glm.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>13.7</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="13.8" data-path="10-Checagem.html"><a href="#regress%C3%A3o-com-dados-ordenados"><i class="fa fa-check"></i><b>13.8</b> Regressão com dados Ordenados</a></li>
<li class="chapter" data-level="13.9" data-path="10-Checagem.html"><a href="#refer%C3%AAncias-2"><i class="fa fa-check"></i><b>13.9</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="10-Checagem.html"><a href="#ap%C3%AAndice"><i class="fa fa-check"></i><b>14</b> - Apêndice</a>
<ul>
<li class="chapter" data-level="14.1" data-path="10-Checagem.html"><a href="#importa%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>14.1</b> Importação</a></li>
<li class="chapter" data-level="14.2" data-path="10-Checagem.html"><a href="#gr%C3%A1ficos-e-tabelas"><i class="fa fa-check"></i><b>14.2</b> Gráficos e Tabelas</a></li>
<li class="chapter" data-level="14.3" data-path="apêndice.html"><a href="apêndice.html"><i class="fa fa-check"></i><b>14.3</b> Limpeza de dados</a></li>
<li class="chapter" data-level="14.4" data-path="apêndice.html"><a href="apêndice.html#modelagem-de-dados"><i class="fa fa-check"></i><b>14.4</b> Modelagem de dados</a></li>
<li class="chapter" data-level="14.5" data-path="apêndice.html"><a href="apêndice.html#outros"><i class="fa fa-check"></i><b>14.5</b> Outros</a></li>
<li class="chapter" data-level="14.6" data-path="10-Checagem.html"><a href="#%C3%A1lgebra-linear"><i class="fa fa-check"></i><b>14.6</b> Álgebra Linear</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="10-Checagem.html"><a href="#espa%C3%A7o-de-vetores-e-subspa%C3%A7o"><i class="fa fa-check"></i><b>14.6.1</b> Espaço de vetores e subspaço</a></li>
<li class="chapter" data-level="14.6.2" data-path="10-Checagem.html"><a href="#proje%C3%A7%C3%A3o-linear-2"><i class="fa fa-check"></i><b>14.6.2</b> Projeção linear</a></li>
<li class="chapter" data-level="14.6.3" data-path="apêndice.html"><a href="apêndice.html#load-required-libraries"><i class="fa fa-check"></i><b>14.6.3</b> 2. <strong>Load Required Libraries</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="teoremas.html"><a href="teoremas.html"><i class="fa fa-check"></i><b>15</b> - Teoremas</a>
<ul>
<li class="chapter" data-level="15.1" data-path="10-Checagem.html"><a href="#independ%C3%AAncia-e-correla%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>15.1</b> Independência e Correlação</a></li>
<li class="chapter" data-level="15.2" data-path="teoremas.html"><a href="teoremas.html#propriedade-de-estimadores"><i class="fa fa-check"></i><b>15.2</b> Propriedade de estimadores</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="10-Checagem.html"><a href="#vi%C3%A9s"><i class="fa fa-check"></i><b>15.2.1</b> Viés</a></li>
<li class="chapter" data-level="15.2.2" data-path="10-Checagem.html"><a href="#vari%C3%A2ncia-1"><i class="fa fa-check"></i><b>15.2.2</b> Variância</a></li>
<li class="chapter" data-level="15.2.3" data-path="10-Checagem.html"><a href="#efici%C3%AAncia"><i class="fa fa-check"></i><b>15.2.3</b> Eficiência</a></li>
<li class="chapter" data-level="15.2.4" data-path="10-Checagem.html"><a href="#consist%C3%AAncia"><i class="fa fa-check"></i><b>15.2.4</b> Consistência</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="10-Checagem.html"><a href="#exerc%C3%ADcios-para-o-leitor"><i class="fa fa-check"></i><b>15.3</b> Exercícios para o leitor</a></li>
<li class="chapter" data-level="15.4" data-path="10-Checagem.html"><a href="#lei-das-esperan%C3%A7as-iteradas"><i class="fa fa-check"></i><b>15.4</b> Lei das Esperanças Iteradas</a></li>
<li class="chapter" data-level="15.5" data-path="teoremas.html"><a href="teoremas.html#teorema-do-condicionamento"><i class="fa fa-check"></i><b>15.5</b> Teorema do Condicionamento</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à Regresssão para Ciências Sociais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="checagem" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Capítulo 10</span> - Checagem<a href="checagem.html#checagem" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Antes de proceder com a parte de inferência estatística, vamos apresentar como realizar checagem do modelo. A razão é que, em geral, a teoria de inferência depende da suposição do modelo ser correta. Então, faz sentido primeiro checar se o modelo satisfaz os pressupostos, e depois fazer inferência.</p>
<p>Vamos então apresentar os principais testes e checagem que devemos fazer com nosso modelo de regressão linear. Aqui vale uma comentário sobre inferência Bayesiana, que não estamos utilizando em nosso curso, mas que eu particularmente utilizo em minha pesquisa aplicada. O prática de modelagem padrão na inferência Bayesiana é escrever formalmente uma verossimilhança (como fizemos com MLE) e estimar distribuições de porbabilidades para os parâmetros, e checar o modelo para ver se essas distribuições fazem sentido. Portanto, a checagem do modelo acontece automaticamente e de maneira integrada, ao contrário do que faremos aqui. Ou seja, recomendo que vocês aprendam a fazer inferência Bayesiana e prescindam de toda essa maquinaria que irei apresentar.</p>
<div id="resíduos" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Resíduos<a href="#res%C3%ADduos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Os resíduo para cada observação <span class="math inline">\(i\)</span> é a diferença entre a previsão do modelo de regressão <span class="math inline">\(\hat{y_i}\)</span> e o valor observado <span class="math inline">\(y_i\)</span>, as vezes chamado de <span class="math inline">\(\hat{e}\)</span>, para diferenciar do erro populacional, <span class="math inline">\(e\)</span>. No caso de nosso modelo de regressão linear com um único preditor, temos:</p>
<p><span class="math display">\[
\hat{e_i} = y_i - (\hat{\alpha} + \hat{\beta} \cdot x_i)
\]</span>
Eis algumas propriedade dos resíduos.</p>
<ol style="list-style-type: decimal">
<li><p>Os resíduos deveriam ter esperança zero, condicional aos preditores. Formalmente, <span class="math inline">\(\mathbb{E}[\hat{e}|X=x] = 0\)</span>. Isso sempre será verdade, e é uma consequência de como calculamos o estimador de mínimos quadrados.</p></li>
<li><p>Se estivermos supondo homecedasticidade, devem ter variância constante (o que raramente será o caso).</p></li>
<li><p>Por se tratar de uma amostra, a probabilidade dos resíduos serem completamente não-correlacionados entre si é zero, contudo a correlação deve ser baixa e convergir para zero à medida que <span class="math inline">\(n\)</span> cresce para infinito.</p></li>
<li><p>Se estamos supondo que o erro é Gaussiano (Normal), como no modelo de MLE, os resíduos devem também ser normais.</p></li>
</ol>
<p>Cada uma dessas propriedades nos leva a um diagnóstico ou checagem.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="checagem.html#cb187-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb187-2"><a href="checagem.html#cb187-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb187-3"><a href="checagem.html#cb187-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb187-4"><a href="checagem.html#cb187-4" tabindex="-1"></a><span class="fu">library</span>(electionsBR)</span>
<span id="cb187-5"><a href="checagem.html#cb187-5" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb187-6"><a href="checagem.html#cb187-6" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb187-7"><a href="checagem.html#cb187-7" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
</div>
<div id="modelo-no-r" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Modelo no R<a href="checagem.html#modelo-no-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para fazer os testes do nosso modelo, vamos fazer um modelo preditivo. Vou utilizar a votação no primeiro turno presidencial de 2018 para prever o voto no segundo turno, no estado de Alagoas. Para tanto, vamos baixar os dados de votação presidencial de 2018 ao nível de seção eleitoral do <a href="https://dadosabertos.tse.jus.br/dataset/resultados-2018">portal de dados abertos do TSE</a>. Podem baixar o arquivo clicando no <a href="https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_secao/votacao_secao_2018_BR.zip">link</a> do dataset. Vamos deszipar e depois filtrar os dados para o estado de Alagoas (para ter uma base de dados pequena).</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="checagem.html#cb188-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb188-2"><a href="checagem.html#cb188-2" tabindex="-1"></a></span>
<span id="cb188-3"><a href="checagem.html#cb188-3" tabindex="-1"></a><span class="co"># lista o nome do arquivo em csv</span></span>
<span id="cb188-4"><a href="checagem.html#cb188-4" tabindex="-1"></a><span class="co"># unzip(here(&quot;dados&quot;, &quot;votacao_secao_2018_BR.zip&quot;), list = TRUE)</span></span>
<span id="cb188-5"><a href="checagem.html#cb188-5" tabindex="-1"></a></span>
<span id="cb188-6"><a href="checagem.html#cb188-6" tabindex="-1"></a></span>
<span id="cb188-7"><a href="checagem.html#cb188-7" tabindex="-1"></a><span class="co">#read data1.csv into data frame</span></span>
<span id="cb188-8"><a href="checagem.html#cb188-8" tabindex="-1"></a>presid_al18 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">here</span>(<span class="st">&quot;dados&quot;</span>,<span class="st">&quot;votacao_secao_2018_BR.csv&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;Latin-1&quot;</span>)</span>
<span id="cb188-9"><a href="checagem.html#cb188-9" tabindex="-1"></a></span>
<span id="cb188-10"><a href="checagem.html#cb188-10" tabindex="-1"></a><span class="co"># filtrando só AL</span></span>
<span id="cb188-11"><a href="checagem.html#cb188-11" tabindex="-1"></a></span>
<span id="cb188-12"><a href="checagem.html#cb188-12" tabindex="-1"></a>presid_al18 <span class="ot">&lt;-</span> presid_al18 <span class="sc">%&gt;%</span></span>
<span id="cb188-13"><a href="checagem.html#cb188-13" tabindex="-1"></a>  <span class="fu">filter</span>(SG_UF <span class="sc">==</span> <span class="st">&quot;AL&quot;</span>)</span>
<span id="cb188-14"><a href="checagem.html#cb188-14" tabindex="-1"></a></span>
<span id="cb188-15"><a href="checagem.html#cb188-15" tabindex="-1"></a><span class="co"># modelo voto em Bolsonaro 1t prediz voto no 2t</span></span>
<span id="cb188-16"><a href="checagem.html#cb188-16" tabindex="-1"></a></span>
<span id="cb188-17"><a href="checagem.html#cb188-17" tabindex="-1"></a><span class="co"># descobre o que é voto nulo e branco</span></span>
<span id="cb188-18"><a href="checagem.html#cb188-18" tabindex="-1"></a>presid_al18 <span class="sc">%&gt;%</span></span>
<span id="cb188-19"><a href="checagem.html#cb188-19" tabindex="-1"></a>  <span class="fu">group_by</span>(NM_VOTAVEL) <span class="sc">%&gt;%</span></span>
<span id="cb188-20"><a href="checagem.html#cb188-20" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">max</span>(NR_VOTAVEL))</span></code></pre></div>
<pre><code>## # A tibble: 15 × 2
##    NM_VOTAVEL                                 `max(NR_VOTAVEL)`
##    &lt;chr&gt;                                                  &lt;int&gt;
##  1 ALVARO FERNANDES DIAS                                     19
##  2 BENEVENUTO DACIOLO FONSECA DOS SANTOS                     51
##  3 CIRO FERREIRA GOMES                                       12
##  4 FERNANDO HADDAD                                           13
##  5 GERALDO JOSÉ RODRIGUES ALCKMIN FILHO                      45
##  6 GUILHERME CASTRO BOULOS                                   50
##  7 HENRIQUE DE CAMPOS MEIRELLES                              15
##  8 JAIR MESSIAS BOLSONARO                                    17
##  9 JOSE MARIA EYMAEL                                         27
## 10 JOÃO DIONISIO FILGUEIRA BARRETO AMOEDO                    30
## 11 JOÃO VICENTE FONTELLA GOULART                             54
## 12 MARIA OSMARINA MARINA DA SILVA VAZ DE LIMA                18
## 13 VERA LUCIA PEREIRA DA SILVA SALGADO                       16
## 14 VOTO BRANCO                                               95
## 15 VOTO NULO                                                 96</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="checagem.html#cb190-1" tabindex="-1"></a><span class="co"># 95 e 96</span></span>
<span id="cb190-2"><a href="checagem.html#cb190-2" tabindex="-1"></a>presid_al18_valido <span class="ot">&lt;-</span> presid_al18 <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="checagem.html#cb190-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>NR_VOTAVEL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">95</span>,<span class="dv">96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="checagem.html#cb190-4" tabindex="-1"></a>  <span class="fu">group_by</span>(NR_SECAO,NR_ZONA, CD_MUNICIPIO,NM_MUNICIPIO, NR_TURNO, NR_VOTAVEL ) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="checagem.html#cb190-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">validos =</span> <span class="fu">sum</span>(QT_VOTOS)) <span class="sc">%&gt;%</span></span>
<span id="cb190-6"><a href="checagem.html#cb190-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bol_bolsonaro =</span> NR_VOTAVEL <span class="sc">==</span> <span class="dv">17</span>,</span>
<span id="cb190-7"><a href="checagem.html#cb190-7" tabindex="-1"></a>         <span class="at">validos_bolsonaro =</span> <span class="fu">sum</span>(validos<span class="sc">*</span>bol_bolsonaro)) <span class="sc">%&gt;%</span></span>
<span id="cb190-8"><a href="checagem.html#cb190-8" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_validos =</span> <span class="fu">sum</span>(validos),</span>
<span id="cb190-9"><a href="checagem.html#cb190-9" tabindex="-1"></a>            <span class="at">validos_bolsonaro =</span> <span class="fu">max</span>(validos_bolsonaro),</span>
<span id="cb190-10"><a href="checagem.html#cb190-10" tabindex="-1"></a>            <span class="at">perc_bolsonaro =</span> validos_bolsonaro<span class="sc">/</span>total_validos) <span class="sc">%&gt;%</span></span>
<span id="cb190-11"><a href="checagem.html#cb190-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>total_validos) <span class="sc">%&gt;%</span></span>
<span id="cb190-12"><a href="checagem.html#cb190-12" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(NR_SECAO, NR_ZONA, CD_MUNICIPIO, NM_MUNICIPIO), <span class="at">names_from =</span> NR_TURNO, <span class="at">values_from =</span> perc_bolsonaro) <span class="sc">%&gt;%</span></span>
<span id="cb190-13"><a href="checagem.html#cb190-13" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">perc_bolso_turno1 =</span> <span class="st">&#39;1&#39;</span>,</span>
<span id="cb190-14"><a href="checagem.html#cb190-14" tabindex="-1"></a>         <span class="at">perc_bolso_turno2 =</span> <span class="st">&#39;2&#39;</span>)</span>
<span id="cb190-15"><a href="checagem.html#cb190-15" tabindex="-1"></a></span>
<span id="cb190-16"><a href="checagem.html#cb190-16" tabindex="-1"></a><span class="co"># modelo de regressão</span></span>
<span id="cb190-17"><a href="checagem.html#cb190-17" tabindex="-1"></a></span>
<span id="cb190-18"><a href="checagem.html#cb190-18" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(perc_bolso_turno2 <span class="sc">~</span> perc_bolso_turno1, <span class="at">data =</span> presid_al18_valido)</span>
<span id="cb190-19"><a href="checagem.html#cb190-19" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = perc_bolso_turno2 ~ perc_bolso_turno1, data = presid_al18_valido)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.147833 -0.018587 -0.000424  0.018027  0.170229 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       0.0011688  0.0008273   1.413    0.158    
## perc_bolso_turno1 1.1640700  0.0022516 516.986   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.02885 on 6385 degrees of freedom
## Multiple R-squared:  0.9767, Adjusted R-squared:  0.9767 
## F-statistic: 2.673e+05 on 1 and 6385 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="checagem.html#cb192-1" tabindex="-1"></a>presid_al18_valido <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="checagem.html#cb192-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>perc_bolso_turno1, <span class="at">y=</span>perc_bolso_turno2)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb192-3"><a href="checagem.html#cb192-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(reg1)[<span class="dv">2</span>] , <span class="at">intercept =</span> <span class="fu">coef</span>(reg1)[<span class="dv">1</span>], <span class="at">colour  =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/dados%2010-1.png" width="900" style="display: block; margin: auto;" /></p>
<div id="resíduos-contra-o-preditor" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Resíduos contra o preditor<a href="#res%C3%ADduos-contra-o-preditor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se os resíduos devem ter <span class="math inline">\(\mathbb{E}[\hat{e}|X=x] = 0\)</span>, então para cada <span class="math inline">\(x_i\)</span> os resíduos devem ter média zero. Em um gráfico, isso significa que, se eu tiver pontos suficientes na proximidade de cada <span class="math inline">\(x_i\)</span>, a dispersão dos resíduos deve ser aleatória, no sentido de não ter padrão claro, o que vai implicar uma reta horizontal cuja média é zero. Como vimos, essa esperança condicional será sempre zero.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="checagem.html#cb193-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg1), <span class="at">preditor =</span> presid_al18_valido<span class="sc">$</span>perc_bolso_turno1)</span>
<span id="cb193-2"><a href="checagem.html#cb193-2" tabindex="-1"></a></span>
<span id="cb193-3"><a href="checagem.html#cb193-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb193-4"><a href="checagem.html#cb193-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-preditor-1.png" width="900" style="display: block; margin: auto;" /></p>
<p>Se houver outros preditores, faça a mesma coisa e o gráfico também deve ser uma reta em cima do eixo <span class="math inline">\(x\)</span>.</p>
<p>O que seria um exemplo de esperança condicional zero, mas que mostra um problema nos pressupostos dos modelos? Se a dispersão ao redor da reta não for aleatória.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="checagem.html#cb194-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb194-2"><a href="checagem.html#cb194-2" tabindex="-1"></a></span>
<span id="cb194-3"><a href="checagem.html#cb194-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb194-4"><a href="checagem.html#cb194-4" tabindex="-1"></a>df_nl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(n), <span class="at">e =</span> <span class="fu">rnorm</span>(n))</span>
<span id="cb194-5"><a href="checagem.html#cb194-5" tabindex="-1"></a>df_nl <span class="ot">&lt;-</span> df_nl <span class="sc">%&gt;%</span></span>
<span id="cb194-6"><a href="checagem.html#cb194-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x <span class="sc">-</span> .<span class="dv">5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> e)</span>
<span id="cb194-7"><a href="checagem.html#cb194-7" tabindex="-1"></a></span>
<span id="cb194-8"><a href="checagem.html#cb194-8" tabindex="-1"></a>reg_nl <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>x, df_nl)</span>
<span id="cb194-9"><a href="checagem.html#cb194-9" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg_nl),</span>
<span id="cb194-10"><a href="checagem.html#cb194-10" tabindex="-1"></a>                 <span class="at">preditor =</span> df_nl<span class="sc">$</span>x)</span>
<span id="cb194-11"><a href="checagem.html#cb194-11" tabindex="-1"></a></span>
<span id="cb194-12"><a href="checagem.html#cb194-12" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb194-13"><a href="checagem.html#cb194-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb194-14"><a href="checagem.html#cb194-14" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-preditor-nao-linear-1.png" width="900" style="display: block; margin: auto;" /></p>
<p>Outra possibilidade são variáveis omitidas. Se o preditor for relevante, a esperança condicional contra esse preditor omitido não será zero. Por outro lado, se for irrelevante, será zero.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="checagem.html#cb195-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb195-2"><a href="checagem.html#cb195-2" tabindex="-1"></a></span>
<span id="cb195-3"><a href="checagem.html#cb195-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb195-4"><a href="checagem.html#cb195-4" tabindex="-1"></a>df_nl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rnorm</span>(n), <span class="at">x2 =</span> <span class="fu">rnorm</span>(n), </span>
<span id="cb195-5"><a href="checagem.html#cb195-5" tabindex="-1"></a>                    <span class="at">x3 =</span> <span class="fu">rnorm</span>(n), <span class="at">e =</span> <span class="fu">rnorm</span>(n))</span>
<span id="cb195-6"><a href="checagem.html#cb195-6" tabindex="-1"></a>df_nl <span class="ot">&lt;-</span> df_nl <span class="sc">%&gt;%</span></span>
<span id="cb195-7"><a href="checagem.html#cb195-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x1 <span class="sc">-</span> .<span class="dv">5</span><span class="sc">*</span>x2 <span class="sc">+</span> e)</span>
<span id="cb195-8"><a href="checagem.html#cb195-8" tabindex="-1"></a></span>
<span id="cb195-9"><a href="checagem.html#cb195-9" tabindex="-1"></a>reg_nl <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>x1, df_nl)</span>
<span id="cb195-10"><a href="checagem.html#cb195-10" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg_nl),</span>
<span id="cb195-11"><a href="checagem.html#cb195-11" tabindex="-1"></a>                 <span class="at">preditor2 =</span> df_nl<span class="sc">$</span>x2,</span>
<span id="cb195-12"><a href="checagem.html#cb195-12" tabindex="-1"></a>                 <span class="at">preditor3 =</span> df_nl<span class="sc">$</span>x3)</span>
<span id="cb195-13"><a href="checagem.html#cb195-13" tabindex="-1"></a></span>
<span id="cb195-14"><a href="checagem.html#cb195-14" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb195-15"><a href="checagem.html#cb195-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor2, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb195-16"><a href="checagem.html#cb195-16" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-preditor-omitido-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="checagem.html#cb196-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="checagem.html#cb196-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor3, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb196-3"><a href="checagem.html#cb196-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-preditor-omitido-2.png" width="900" style="display: block; margin: auto;" /></p>
</div>
<div id="magnitude-dos-resíduos-contra-o-preditor" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Magnitude dos Resíduos Contra o Preditor<a href="#magnitude-dos-res%C3%ADduos-contra-o-preditor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Uma vez que <span class="math inline">\(\mathbb{E}[\hat{e}|X] = 0\)</span>, segue-se que <span class="math inline">\(\mathbb{Var}[\hat{e}|X] = \mathbb{E}[\hat{e}^2|X]\)</span>.</p>
<p>Seja <span class="math inline">\(A\)</span> uma v.a. Então, <span class="math inline">\(\mathbb{Var}[A|X] = \mathbb{E}[(A - \mathbb{E}[A|X])^2|X]\)</span>
<span class="math display">\[
\mathbb{Var}[\hat{e}|X] =  \mathbb{E}[(\hat{e} - \mathbb{E}[\hat{e}|X])^2|X] = \mathbb{E}[(\hat{e} - 0)^2|X] = \mathbb{E}[\hat{e}^2|X]
\]</span>
Portanto, se estamos assumindo homecadisticidade, isto é, que <span class="math inline">\(\mathbb{Var}[\hat{e}|X] = \sigma^2\)</span>, podemos checar esta suposição olhando para a esperança condicional do quadrado dos resíduos. E podemos fazer isso plotando o gráfico do quadrado dos resíduos contra o preditor. É útil olhar tanto a reta ajustada quanto um modelo não-linear, disponível no comando geom_smooth do ggplot2.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="checagem.html#cb197-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos_sq =</span> <span class="fu">residuals</span>(reg1)<span class="sc">^</span><span class="dv">2</span>, <span class="at">preditor =</span> presid_al18_valido<span class="sc">$</span>perc_bolso_turno1)</span>
<span id="cb197-2"><a href="checagem.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="checagem.html#cb197-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="checagem.html#cb197-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor, <span class="at">y =</span> residuos_sq)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-sq-preditor-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="checagem.html#cb198-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="checagem.html#cb198-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor, <span class="at">y =</span> residuos_sq)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-sq-preditor-2.png" width="900" style="display: block; margin: auto;" /></p>
<p>A reta deve ser horizontal, e não deveria ter mais pontos acima do que abaixo da reta. A altura da reta deveria ser aproximadamente o EQM. Conjuntos de pontos persistentemente acima ou abaixo da reta são sinais de problema com alguma de nossas hipóteses, ou há heterocedasticidade (a variância muda com o preditor) ou a forma funcional do modelo está errada de algum modo. No meu gráfico, a reta não é exatamente horizontal, mas parece “good enough”. Uma forma de olhar isso é computar erros padrões que lidem com a heterocedasticidade. Voltaremos a isso mais à frente.</p>
<p>Vale perceber também que existem alguns outliers no quadrado dos resíduos, que poderiam ser investigados qualitativamente, para entender o que está causando isso e pode sugerir algum preditor ou forma funcional não considerados na modelagem.</p>
<p>Ás vezes quando temos resíduos muito grandes, o quadrado deles fica gigante e o gráfico fica não-informativo (especialmente quando o modelo é problemático). Nesses casos, podemos plotar o valor absoluto dos resíduos, em vez do quadrado.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="checagem.html#cb199-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos_abs =</span> <span class="fu">abs</span>(<span class="fu">residuals</span>(reg1)), <span class="at">preditor =</span> presid_al18_valido<span class="sc">$</span>perc_bolso_turno1)</span>
<span id="cb199-2"><a href="checagem.html#cb199-2" tabindex="-1"></a></span>
<span id="cb199-3"><a href="checagem.html#cb199-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb199-4"><a href="checagem.html#cb199-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>preditor, <span class="at">y =</span> residuos_abs)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-abs-preditor-1.png" width="900" style="display: block; margin: auto;" /></p>
</div>
<div id="resíduos-com-dados-temporais-eou-espaciais" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Resíduos com dados Temporais e/ou Espaciais<a href="#res%C3%ADduos-com-dados-temporais-eou-espaciais" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Com frequência nossos dados possuem uma certa ordem, seja temporal e/ou espacial. Em um modelo simples, isso não deveria importar (nossa amostra supostamente é i.i.d, e os erros populacionais são não correlacionados entre si). Se os erros forem correlacionados, podemos usar algo chamado mínimos quadrados generalizados, o que também não iremos cobrir no curso. Então, deveríamos sempre fazer um plot dos resíduos contra o tempo, ou contra o espaço. Aqui, como a ordem é apenas espacial, vamos fazer isso.</p>
<p>Podemos fazer um plot dos resíduos contra seção e contra os dados ordenados aleatoriamente. Vejamos como fica.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="checagem.html#cb200-1" tabindex="-1"></a>presid_al18_valido <span class="ot">&lt;-</span> presid_al18_valido <span class="sc">%&gt;%</span></span>
<span id="cb200-2"><a href="checagem.html#cb200-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id_secao =</span> <span class="fu">paste0</span>(NR_SECAO, NR_ZONA , CD_MUNICIPIO))</span>
<span id="cb200-3"><a href="checagem.html#cb200-3" tabindex="-1"></a></span>
<span id="cb200-4"><a href="checagem.html#cb200-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg1), <span class="at">id =</span> <span class="fu">as.numeric</span>(presid_al18_valido<span class="sc">$</span>id_secao))</span>
<span id="cb200-5"><a href="checagem.html#cb200-5" tabindex="-1"></a></span>
<span id="cb200-6"><a href="checagem.html#cb200-6" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb200-7"><a href="checagem.html#cb200-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>id, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-coordenadas-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="checagem.html#cb201-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb201-2"><a href="checagem.html#cb201-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>id, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>( <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-coordenadas-2.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="checagem.html#cb202-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg1), <span class="at">id =</span> <span class="fu">as.numeric</span>(presid_al18_valido<span class="sc">$</span>id_secao))</span>
<span id="cb202-2"><a href="checagem.html#cb202-2" tabindex="-1"></a></span>
<span id="cb202-3"><a href="checagem.html#cb202-3" tabindex="-1"></a>df_randomized <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb202-4"><a href="checagem.html#cb202-4" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="fu">nrow</span>(df)) <span class="sc">%&gt;%</span></span>
<span id="cb202-5"><a href="checagem.html#cb202-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb202-6"><a href="checagem.html#cb202-6" tabindex="-1"></a></span>
<span id="cb202-7"><a href="checagem.html#cb202-7" tabindex="-1"></a>df_randomized <span class="sc">%&gt;%</span></span>
<span id="cb202-8"><a href="checagem.html#cb202-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>new_id, <span class="at">y =</span> residuos)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-coordenadas-3.png" width="900" style="display: block; margin: auto;" /></p>
<p>O que os dois plots mostram é que existe um padrão na forma como o TSE numera as seções, mas não há padrão espacial claro na votação.</p>
<p>Uma técnica simples, que é uma versão simplificada de algo mais formal chamado “permutation test”, é plotar os resíduos permutados aleatoriamente contra o plot real que queremos fazer. Vamos usar o pacote <a href="https://dicook.github.io/nullabor/">nullabor</a> para isso. Vamos replicar o teste de homecedasticidade e olhar os resíduos ao quadrado contra os preditores, e olhar os resíduos contra os valores previstos Primeiro contra o preditor.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="checagem.html#cb203-1" tabindex="-1"></a><span class="fu">library</span>(nullabor)</span>
<span id="cb203-2"><a href="checagem.html#cb203-2" tabindex="-1"></a></span>
<span id="cb203-3"><a href="checagem.html#cb203-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)  <span class="co"># Aleatoriza do mesmo jeito sempre</span></span>
<span id="cb203-4"><a href="checagem.html#cb203-4" tabindex="-1"></a>elec_reg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(presid_al18_valido, <span class="at">.resid =</span> <span class="fu">residuals</span>(reg1),</span>
<span id="cb203-5"><a href="checagem.html#cb203-5" tabindex="-1"></a>                       <span class="at">.predicted =</span> <span class="fu">model.matrix</span>(reg1)[,<span class="dv">2</span>])</span>
<span id="cb203-6"><a href="checagem.html#cb203-6" tabindex="-1"></a></span>
<span id="cb203-7"><a href="checagem.html#cb203-7" tabindex="-1"></a>shuffled_residuals <span class="ot">&lt;-</span> <span class="fu">lineup</span>(<span class="fu">null_lm</span>(perc_bolso_turno2 <span class="sc">~</span> perc_bolso_turno1,</span>
<span id="cb203-8"><a href="checagem.html#cb203-8" tabindex="-1"></a>                                     <span class="at">method =</span> <span class="st">&quot;rotate&quot;</span>), <span class="at">true =</span> elec_reg,</span>
<span id="cb203-9"><a href="checagem.html#cb203-9" tabindex="-1"></a>                             <span class="at">n =</span> <span class="dv">9</span>)</span>
<span id="cb203-10"><a href="checagem.html#cb203-10" tabindex="-1"></a></span>
<span id="cb203-11"><a href="checagem.html#cb203-11" tabindex="-1"></a><span class="fu">ggplot</span>(shuffled_residuals, <span class="fu">aes</span>(<span class="at">x =</span> .predicted, <span class="at">y =</span> .resid<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb203-12"><a href="checagem.html#cb203-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb203-13"><a href="checagem.html#cb203-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(.sample))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap10-residuos-shufle-coordenadas1-1.png" width="900" style="display: block; margin: auto;" /></p>
<p>Depois contra os valores previstos.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="checagem.html#cb204-1" tabindex="-1"></a>elec_reg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(presid_al18_valido, <span class="at">.resid =</span> <span class="fu">residuals</span>(reg1), <span class="at">.fitted =</span> <span class="fu">fitted</span>(reg1))</span>
<span id="cb204-2"><a href="checagem.html#cb204-2" tabindex="-1"></a></span>
<span id="cb204-3"><a href="checagem.html#cb204-3" tabindex="-1"></a>shuffled_residuals <span class="ot">&lt;-</span> <span class="fu">lineup</span>(<span class="fu">null_lm</span>(perc_bolso_turno2 <span class="sc">~</span> perc_bolso_turno1,</span>
<span id="cb204-4"><a href="checagem.html#cb204-4" tabindex="-1"></a>                                     <span class="at">method =</span> <span class="st">&quot;rotate&quot;</span>), <span class="at">true =</span> elec_reg,</span>
<span id="cb204-5"><a href="checagem.html#cb204-5" tabindex="-1"></a>                             <span class="at">n =</span> <span class="dv">9</span>)</span>
<span id="cb204-6"><a href="checagem.html#cb204-6" tabindex="-1"></a><span class="do">## decrypt(&quot;ve5B DEyE l6 GuClylu6 dT&quot;)</span></span>
<span id="cb204-7"><a href="checagem.html#cb204-7" tabindex="-1"></a></span>
<span id="cb204-8"><a href="checagem.html#cb204-8" tabindex="-1"></a><span class="fu">ggplot</span>(shuffled_residuals, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb204-9"><a href="checagem.html#cb204-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb204-10"><a href="checagem.html#cb204-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(.sample))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/residuos-shufle-coordenadas2-1.png" width="900" style="display: block; margin: auto;" /></p>
<p>A mensagem encriptada tem o plot real, contrao o nulo. Se for possível identificar o plot real, é porque existe algum padrão nos dados.</p>
</div>
</div>
<div id="normalidade-dos-resíduos" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Normalidade dos resíduos<a href="#normalidade-dos-res%C3%ADduos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se estamos supondo normalidade dos resíduos, podemos verificar se são de fato normais. Uma forma de verificar é plotando o histograma dos resíduos e por cima a densidade de uma distribuição normal com média zero (resíduos têm média zero) e desvio-padrão igual ao desvio-padrão dos resíduos.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="checagem.html#cb205-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg1), <span class="at">preditor =</span> presid_al18_valido<span class="sc">$</span>perc_bolso_turno1, </span>
<span id="cb205-2"><a href="checagem.html#cb205-2" tabindex="-1"></a>                 <span class="at">density_points =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">residuals</span>(reg1)) , <span class="dv">0</span>, <span class="fu">sd</span>(<span class="fu">residuals</span>(reg1))))</span>
<span id="cb205-3"><a href="checagem.html#cb205-3" tabindex="-1"></a></span>
<span id="cb205-4"><a href="checagem.html#cb205-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(<span class="fu">residuals</span>(reg1)))</span></code></pre></div>
<pre><code>## [1] 0.02884366</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="checagem.html#cb207-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb207-2"><a href="checagem.html#cb207-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(residuos)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(density_points), <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<p><img src="bookdownproj_files/figure-html/residuos-normalidade-1.png" width="900" style="display: block; margin: auto;" /></p>
<p>Uma alternativa mais tradicional são os chamados Q-Q plots, cujo nome deriva de sere um plot “quantil-quantil”. A Função de Distribuição Acumulada (FDA) é <span class="math inline">\(F(x) = P(X \leq x)\)</span>. Se a função é contínua (como a Normal), então ela possui uma inversa: <span class="math inline">\(F^{-1}(p)\)</span>, que nos diz o único <span class="math inline">\(x\)</span> tal que <span class="math inline">\(P(X \leq x) = p\)</span>. Ou seja, a função quantil me diz qual é o ponto que divide a minha distribuição de probabilidade em exatamente <span class="math inline">\(p\%\)</span>. Por exemplo, posso me perguntar qual ponto divide meus dados exatamente no meio (mediana), ou no primeiro quartil, primeiro percentil, em suma, em qualquer percentual da distribuição. O R tem uma função para isso que vale vermos para entender.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="checagem.html#cb209-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>( <span class="dv">1000</span>)</span>
<span id="cb209-2"><a href="checagem.html#cb209-2" tabindex="-1"></a></span>
<span id="cb209-3"><a href="checagem.html#cb209-3" tabindex="-1"></a>q50 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, .<span class="dv">5</span>)</span>
<span id="cb209-4"><a href="checagem.html#cb209-4" tabindex="-1"></a>q025 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, .<span class="dv">025</span>)</span>
<span id="cb209-5"><a href="checagem.html#cb209-5" tabindex="-1"></a>q975 <span class="ot">&lt;-</span><span class="fu">quantile</span>(x, .<span class="dv">975</span>)</span>
<span id="cb209-6"><a href="checagem.html#cb209-6" tabindex="-1"></a></span>
<span id="cb209-7"><a href="checagem.html#cb209-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(q50, q025, q975))</span></code></pre></div>
<pre><code>##         50%        2.5%       97.5% 
## -0.04257219 -1.91943889  1.83665303</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="checagem.html#cb211-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb211-2"><a href="checagem.html#cb211-2" tabindex="-1"></a></span>
<span id="cb211-3"><a href="checagem.html#cb211-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y, <span class="at">x=</span>x)</span>
<span id="cb211-4"><a href="checagem.html#cb211-4" tabindex="-1"></a><span class="co"># plot de x contra y</span></span>
<span id="cb211-5"><a href="checagem.html#cb211-5" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb211-6"><a href="checagem.html#cb211-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/quantile-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="checagem.html#cb212-1" tabindex="-1"></a><span class="co"># plot de x ordenado contra y ordenado</span></span>
<span id="cb212-2"><a href="checagem.html#cb212-2" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="checagem.html#cb212-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">sort</span>(x), <span class="at">y=</span><span class="fu">sort</span>(y))) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/quantile-2.png" width="900" style="display: block; margin: auto;" /></p>
<p>Vejam que <span class="math inline">\(p\)</span> varia entre <span class="math inline">\(0\)</span> e <span class="math inline">\(1\)</span>, e o menor valor que a função quantil retorna é o menor valor possível da minha distribuição de probabilidade, e o maior é o máximo da distribuição de probabilidade. No caso da Normal, o mínimo é menos infinito e o máximo é mais infinito, porém, em uma amostra serão valores finitos.</p>
<p>Se plotarmos duas variáveis ordenadas, podemos verificar se têm a mesma distribuição. Em caso positivo, deveriam seguir uma linha reta de 45 graus. Quando queremos testar os resíduos, uma das variáveis são os resíduos e a outra a distribuição teórica dos mesmos (Normal).</p>
<p>O Q-Q plot de uma regressão é uma versão um pouco mais complicadinha disso, que não irei mostrar aqui (pois precisaria trabalhar com a inversa da distribuição Normal), mas a lógica final é a mesma. Podemos ver isso plotando o Q-Q plot do R, e um construído por nós, utilizando a lógica que apresentei.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="checagem.html#cb213-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">residuos =</span> <span class="fu">residuals</span>(reg1), <span class="at">preditor =</span> presid_al18_valido<span class="sc">$</span>perc_bolso_turno1, </span>
<span id="cb213-2"><a href="checagem.html#cb213-2" tabindex="-1"></a>                 <span class="at">density_points =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">residuals</span>(reg1)) , <span class="dv">0</span>, <span class="fu">sd</span>(<span class="fu">residuals</span>(reg1))),</span>
<span id="cb213-3"><a href="checagem.html#cb213-3" tabindex="-1"></a>                 <span class="at">fi_percentil =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">residuals</span>(reg1))<span class="sc">/</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">residuals</span>(reg1)))</span>
<span id="cb213-4"><a href="checagem.html#cb213-4" tabindex="-1"></a></span>
<span id="cb213-5"><a href="checagem.html#cb213-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(<span class="fu">residuals</span>(reg1)))</span></code></pre></div>
<pre><code>## [1] 0.02884366</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="checagem.html#cb215-1" tabindex="-1"></a><span class="co"># plot de x ordenado contra y ordenado</span></span>
<span id="cb215-2"><a href="checagem.html#cb215-2" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="checagem.html#cb215-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">sort</span>(residuos), <span class="at">x=</span><span class="fu">sort</span>(density_points))) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb215-4"><a href="checagem.html#cb215-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">colour =</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/q-q%20plot-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="checagem.html#cb216-1" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(reg1))</span>
<span id="cb216-2"><a href="checagem.html#cb216-2" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(reg1))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/q-q%20plot-2.png" width="900" style="display: block; margin: auto;" /></p>
<p>Obviamente o melhor é usar a função do R, já implementada, que faz tudo “by the book”, mas a intuição você já sabem qual é. Se os resíduos tiverem distribuição aproximadamente normal, devem ficar em torno da reta e não haver padrões significativos. Os extremos, por serem valores mais improváveis, terão poucos casos e tendem a ficar um pouco mais distante da reta.</p>
</div>
<div id="generalização" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Generalização<a href="#generaliza%C3%A7%C3%A3o" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma possibilidade de generalização é dividir os dados em treinamento e teste, onde estimamos o modelo com base nos dados de treinamento (uma amostra aleatória) e fazemos os testes olhando para os erros das previsoes do modelo. E aí podemos repetir os plots anteriores, agora para os dados de treinamento.</p>
<p>Outra possibilidade é estimar o modelo com os dados onde o ajuste é bom, e colocar para teste onde o ajuste parece ruim. Isso é uma forma de confirmar que de fato o modelo está prevendo mal essa partedos dados.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mle.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferencia.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mgaldino/book-regression/edit/main/10-Checagem.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mgaldino/book-regression/blob/main/10-Checagem.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
