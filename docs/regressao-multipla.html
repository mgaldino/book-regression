<!DOCTYPE html>
<html lang="pt" xml:lang="pt">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 12 - Regressao Multipla | Introdução à Regresssão para Ciências Sociais</title>
  <meta name="description" content="Capítulo 12 - Regressao Multipla | Introdução à Regresssão para Ciências Sociais" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 12 - Regressao Multipla | Introdução à Regresssão para Ciências Sociais" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 12 - Regressao Multipla | Introdução à Regresssão para Ciências Sociais" />
  
  
  

<meta name="author" content="Manoel Galdino" />


<meta name="date" content="2025-10-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inferencia.html"/>
<link rel="next" href="glm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Regressão</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="12-Regressao-Multipla.html"><a href="#pref%C3%A1cio"><i class="fa fa-check"></i><b>1</b> - Prefácio</a></li>
<li class="chapter" data-level="2" data-path="12-Regressao-Multipla.html"><a href="#revis%C3%A3o-de-r"><i class="fa fa-check"></i><b>2</b> - Revisão de R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html"><i class="fa fa-check"></i><b>2.1</b> R e Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#r-como-calculadora"><i class="fa fa-check"></i><b>2.2</b> R como calculadora</a></li>
<li class="chapter" data-level="2.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#objetos-no-r"><i class="fa fa-check"></i><b>2.3</b> Objetos no R</a></li>
<li class="chapter" data-level="2.4" data-path="revisão-de-r.html"><a href="revisão-de-r.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.4</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#numeric"><i class="fa fa-check"></i><b>2.4.1</b> Numeric</a></li>
<li class="chapter" data-level="2.4.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#character"><i class="fa fa-check"></i><b>2.4.2</b> character</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="revisão-de-r.html"><a href="revisão-de-r.html#armazenando-dados"><i class="fa fa-check"></i><b>2.5</b> Armazenando dados</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="revisão-de-r.html"><a href="revisão-de-r.html#vetor"><i class="fa fa-check"></i><b>2.5.1</b> Vetor</a></li>
<li class="chapter" data-level="2.5.2" data-path="revisão-de-r.html"><a href="revisão-de-r.html#matriz"><i class="fa fa-check"></i><b>2.5.2</b> Matriz</a></li>
<li class="chapter" data-level="2.5.3" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-frame"><i class="fa fa-check"></i><b>2.5.3</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="revisão-de-r.html"><a href="revisão-de-r.html#bibliotecaspacotes"><i class="fa fa-check"></i><b>2.6</b> Bibliotecas/pacotes</a></li>
<li class="chapter" data-level="2.7" data-path="revisão-de-r.html"><a href="revisão-de-r.html#importando-dados"><i class="fa fa-check"></i><b>2.7</b> importando dados</a></li>
<li class="chapter" data-level="2.8" data-path="revisão-de-r.html"><a href="revisão-de-r.html#data-wrangling"><i class="fa fa-check"></i><b>2.8</b> Data wrangling</a></li>
<li class="chapter" data-level="2.9" data-path="12-Regressao-Multipla.html"><a href="#visualiza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>2.9</b> Visualização</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="12-Regressao-Multipla.html"><a href="#revis%C3%A3o-de-estat%C3%ADstica-e-probabilidade"><i class="fa fa-check"></i><b>3</b> - Revisão de estatística e probabilidade</a>
<ul>
<li class="chapter" data-level="3.1" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A1vel-aleat%C3%B3ria"><i class="fa fa-check"></i><b>3.1</b> Variável Aleatória</a></li>
<li class="chapter" data-level="3.2" data-path="12-Regressao-Multipla.html"><a href="#esperan%C3%A7a-matem%C3%A1tica"><i class="fa fa-check"></i><b>3.2</b> Esperança matemática</a></li>
<li class="chapter" data-level="3.3" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A2ncia"><i class="fa fa-check"></i><b>3.3</b> Variância</a></li>
<li class="chapter" data-level="3.4" data-path="12-Regressao-Multipla.html"><a href="#%C3%A1lgebra-com-esperan%C3%A7a-vari%C3%A2ncia-e-covari%C3%A2ncia"><i class="fa fa-check"></i><b>3.4</b> Álgebra com Esperança, Variância e Covariância</a></li>
<li class="chapter" data-level="3.5" data-path="12-Regressao-Multipla.html"><a href="#prova-da-identidade-da-vari%C3%A2ncia"><i class="fa fa-check"></i><b>3.5</b> Prova da identidade da variância</a></li>
<li class="chapter" data-level="3.6" data-path="12-Regressao-Multipla.html"><a href="#distribui%C3%A7%C3%A3o-de-probabilidade-conjunta"><i class="fa fa-check"></i><b>3.6</b> Distribuição de Probabilidade Conjunta</a></li>
<li class="chapter" data-level="3.7" data-path="revisão-de-estatística-e-probabilidade.html"><a href="revisão-de-estatística-e-probabilidade.html"><i class="fa fa-check"></i><b>3.7</b> Probabilidade Condicional</a></li>
<li class="chapter" data-level="3.8" data-path="12-Regressao-Multipla.html"><a href="#esperan%C3%A7a-condicional"><i class="fa fa-check"></i><b>3.8</b> Esperança Condicional</a></li>
<li class="chapter" data-level="3.9" data-path="12-Regressao-Multipla.html"><a href="#proje%C3%A7%C3%A3o-linear"><i class="fa fa-check"></i><b>3.9</b> Projeção Linear</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="12-Regressao-Multipla.html"><a href="#adi%C3%A7%C3%A3o-de-vetores"><i class="fa fa-check"></i><b>3.9.1</b> Adição de vetores</a></li>
<li class="chapter" data-level="3.9.2" data-path="12-Regressao-Multipla.html"><a href="#proje%C3%A7%C3%A3o-linear-1"><i class="fa fa-check"></i><b>3.9.2</b> Projeção linear</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="12-Regressao-Multipla.html"><a href="#introdu%C3%A7%C3%A3o-%C3%A0-simula%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4</b> Introdução à Simulação</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html"><i class="fa fa-check"></i><b>4.1</b> Objetivos</a></li>
<li class="chapter" data-level="4.2" data-path="12-Regressao-Multipla.html"><a href="#introdu%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4.2</b> Introdução</a></li>
<li class="chapter" data-level="4.3" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#dgp-processo-gerador-de-dados"><i class="fa fa-check"></i><b>4.3</b> DGP — Processo Gerador de Dados</a></li>
<li class="chapter" data-level="4.4" data-path="12-Regressao-Multipla.html"><a href="#simula%C3%A7%C3%A3o-de-monte-carlo"><i class="fa fa-check"></i><b>4.4</b> Simulação de Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simulando-um-dado"><i class="fa fa-check"></i><b>4.4.1</b> Simulando um dado</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="12-Regressao-Multipla.html"><a href="#configura%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>4.5</b> Configuração</a></li>
<li class="chapter" data-level="4.6" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#simular"><i class="fa fa-check"></i><b>4.6</b> Simular</a></li>
<li class="chapter" data-level="4.7" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#resumir"><i class="fa fa-check"></i><b>4.7</b> Resumir</a></li>
<li class="chapter" data-level="4.8" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#lgn-e-tcl"><i class="fa fa-check"></i><b>4.8</b> LGN e TCL</a></li>
<li class="chapter" data-level="4.9" data-path="introdução-à-simulação.html"><a href="introdução-à-simulação.html#cobertura-de-um-ic"><i class="fa fa-check"></i><b>4.9</b> Cobertura de um IC</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="12-Regressao-Multipla.html"><a href="#o-modelo-de-regress%C3%A3o"><i class="fa fa-check"></i><b>5</b> O Modelo de Regressão</a>
<ul>
<li class="chapter" data-level="5.1" data-path="12-Regressao-Multipla.html"><a href="#modelo-de-regress%C3%A3o---teoria"><i class="fa fa-check"></i><b>5.1</b> Modelo de Regressão - Teoria</a></li>
<li class="chapter" data-level="5.2" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html"><i class="fa fa-check"></i><b>5.2</b> CEF</a></li>
<li class="chapter" data-level="5.3" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#cef-e-voto"><i class="fa fa-check"></i><b>5.3</b> CEF e voto</a></li>
<li class="chapter" data-level="5.4" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#algumas-propriedades-da-cef"><i class="fa fa-check"></i><b>5.4</b> Algumas Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="12-Regressao-Multipla.html"><a href="#cef-%C3%A9-a-melhor-aproxima%C3%A7%C3%A3o-aos-dados"><i class="fa fa-check"></i><b>5.4.1</b> CEF é a melhor aproximação aos dados</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="12-Regressao-Multipla.html"><a href="#regress%C3%A3o-linear"><i class="fa fa-check"></i><b>5.5</b> Regressão Linear</a></li>
<li class="chapter" data-level="5.6" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#logaritmos"><i class="fa fa-check"></i><b>5.6</b> Logaritmos</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="12-Regressao-Multipla.html"><a href="#logartimos-como-diferen%C3%A7a-de-porcentagens"><i class="fa fa-check"></i><b>5.6.1</b> Logartimos como diferença de porcentagens</a></li>
<li class="chapter" data-level="5.6.2" data-path="12-Regressao-Multipla.html"><a href="#logaritmos-e-m%C3%A9dia-geom%C3%A9trica"><i class="fa fa-check"></i><b>5.6.2</b> Logaritmos e média geométrica</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="12-Regressao-Multipla.html"><a href="#prevendo-a-partir-da-esperan%C3%A7a-condicional"><i class="fa fa-check"></i><b>5.7</b> Prevendo a partir da esperança condicional</a></li>
<li class="chapter" data-level="5.8" data-path="o-modelo-de-regressão.html"><a href="o-modelo-de-regressão.html#preditores-lineares"><i class="fa fa-check"></i><b>5.8</b> Preditores lineares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cef-1.html"><a href="cef-1.html"><i class="fa fa-check"></i><b>6</b> - CEF</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cef-1.html"><a href="cef-1.html#erro-da-cef"><i class="fa fa-check"></i><b>6.1</b> Erro da CEF</a></li>
<li class="chapter" data-level="6.2" data-path="cef-1.html"><a href="cef-1.html#simulando-para-entender-a-cef"><i class="fa fa-check"></i><b>6.2</b> Simulando para entender a CEF</a></li>
<li class="chapter" data-level="6.3" data-path="cef-1.html"><a href="cef-1.html#propriedades-da-cef"><i class="fa fa-check"></i><b>6.3</b> Propriedades da CEF</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="12-Regressao-Multipla.html"><a href="#a-esperan%C3%A7a-do-erro-condicional-a-x-%C3%A9-zero"><i class="fa fa-check"></i><b>6.3.1</b> A Esperança do Erro Condicional a X é zero</a></li>
<li class="chapter" data-level="6.3.2" data-path="12-Regressao-Multipla.html"><a href="#a-esperan%C3%A7a-n%C3%A3o-condicional-do-erro-%C3%A9-zero."><i class="fa fa-check"></i><b>6.3.2</b> A esperança (não-condicional) do erro é zero.</a></li>
<li class="chapter" data-level="6.3.3" data-path="12-Regressao-Multipla.html"><a href="#o-erro-da-cef-%C3%A9-n%C3%A3o-correlacionado-com-x"><i class="fa fa-check"></i><b>6.3.3</b> O erro da CEF é não-correlacionado com X</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="12-Regressao-Multipla.html"><a href="#regress%C3%A3o-linear-e-a-cef"><i class="fa fa-check"></i><b>6.4</b> Regressão Linear e a CEF</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="12-Regressao-Multipla.html"><a href="#m%C3%ADnimos-quadrados-ordin%C3%A1rios"><i class="fa fa-check"></i><b>6.4.1</b> Mínimos Quadrados Ordinários</a></li>
<li class="chapter" data-level="6.4.2" data-path="12-Regressao-Multipla.html"><a href="#suponha-que-a-cef-%C3%A9-linear-justificativa-i"><i class="fa fa-check"></i><b>6.4.2</b> Suponha que a CEF é Linear (Justificativa I)</a></li>
<li class="chapter" data-level="6.4.3" data-path="12-Regressao-Multipla.html"><a href="#%C3%A9-o-melhor-preditor-linear-do-y-justificativa-ii"><i class="fa fa-check"></i><b>6.4.3</b> É o melhor preditor linear do <span class="math inline">\(Y\)</span> (justificativa II)</a></li>
<li class="chapter" data-level="6.4.4" data-path="12-Regressao-Multipla.html"><a href="#a-reta-de-regress%C3%A3o-%C3%A9-a-aproxima%C3%A7%C3%A3o-com-o-menor-erro-quadr%C3%A1tico-m%C3%A9dio-justificativa-iii"><i class="fa fa-check"></i><b>6.4.4</b> A reta de regressão é a aproximação com o menor erro quadrático médio (justificativa III)</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="cef-1.html"><a href="cef-1.html#linearidade-e-causalidade"><i class="fa fa-check"></i><b>6.5</b> Linearidade e Causalidade</a></li>
<li class="chapter" data-level="6.6" data-path="12-Regressao-Multipla.html"><a href="#modelo-s%C3%B3-com-intercepto"><i class="fa fa-check"></i><b>6.6</b> Modelo só com intercepto</a></li>
<li class="chapter" data-level="6.7" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A2ncia-da-regress%C3%A3o"><i class="fa fa-check"></i><b>6.7</b> Variância da Regressão</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="cef-1.html"><a href="cef-1.html#chuva-na-jamaica"><i class="fa fa-check"></i><b>6.7.1</b> Chuva na Jamaica</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A2ncia-condicional"><i class="fa fa-check"></i><b>6.8</b> Variância condicional</a></li>
<li class="chapter" data-level="6.9" data-path="cef-1.html"><a href="cef-1.html#efeito-marginal"><i class="fa fa-check"></i><b>6.9</b> Efeito Marginal</a></li>
<li class="chapter" data-level="6.10" data-path="12-Regressao-Multipla.html"><a href="#cef-linear-com-preditores-n%C3%A3o-lineares"><i class="fa fa-check"></i><b>6.10</b> CEF linear com preditores não-lineares</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="12-Regressao-Multipla.html"><a href="#estima%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>7</b> - Estimação</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimação.html"><a href="estimação.html"><i class="fa fa-check"></i><b>7.1</b> Plug-in estimators</a></li>
<li class="chapter" data-level="7.2" data-path="estimação.html"><a href="estimação.html#simulando-de-uma-normal-bivariada"><i class="fa fa-check"></i><b>7.2</b> Simulando de uma Normal Bivariada</a></li>
<li class="chapter" data-level="7.3" data-path="12-Regressao-Multipla.html"><a href="#suposi%C3%A7%C3%B5es-amostrais-de-mqo"><i class="fa fa-check"></i><b>7.3</b> Suposições amostrais de MQO</a></li>
<li class="chapter" data-level="7.4" data-path="12-Regressao-Multipla.html"><a href="#modelo-de-m%C3%A9dia-amostral"><i class="fa fa-check"></i><b>7.4</b> Modelo de Média amostral</a></li>
<li class="chapter" data-level="7.5" data-path="12-Regressao-Multipla.html"><a href="#modelo-de-regress%C3%A3o-linear-com-preditores"><i class="fa fa-check"></i><b>7.5</b> Modelo de Regressão Linear com preditores</a></li>
<li class="chapter" data-level="7.6" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A2ncia-do-estimador"><i class="fa fa-check"></i><b>7.6</b> Variância do estimador</a></li>
<li class="chapter" data-level="7.7" data-path="12-Regressao-Multipla.html"><a href="#estimando-um-modelo-de-regress%C3%A3o-real"><i class="fa fa-check"></i><b>7.7</b> Estimando um modelo de regressão real</a></li>
<li class="chapter" data-level="7.8" data-path="12-Regressao-Multipla.html"><a href="#limita%C3%A7%C3%B5es-de-mqo"><i class="fa fa-check"></i><b>7.8</b> Limitações de MQO</a></li>
<li class="chapter" data-level="7.9" data-path="12-Regressao-Multipla.html"><a href="#distra%C3%A7%C3%B5es"><i class="fa fa-check"></i><b>7.9</b> Distrações</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="estimação.html"><a href="estimação.html#r-quadrado"><i class="fa fa-check"></i><b>7.9.1</b> R-quadrado</a></li>
<li class="chapter" data-level="7.9.2" data-path="estimação.html"><a href="estimação.html#r-quadrado-ajustado"><i class="fa fa-check"></i><b>7.9.2</b> R-quadrado ajustado</a></li>
<li class="chapter" data-level="7.9.3" data-path="estimação.html"><a href="estimação.html#limites-do-r-quadrado"><i class="fa fa-check"></i><b>7.9.3</b> Limites do R-quadrado</a></li>
<li class="chapter" data-level="7.9.4" data-path="estimação.html"><a href="estimação.html#para-que-serve"><i class="fa fa-check"></i><b>7.9.4</b> Para que serve?</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="12-Regressao-Multipla.html"><a href="#demonstra%C3%A7%C3%A3o-alternativa-que-estimador-%C3%A9-n%C3%A3o-viesado."><i class="fa fa-check"></i><b>7.10</b> Demonstração Alternativa que estimador é não-viesado.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="causalidade.html"><a href="causalidade.html"><i class="fa fa-check"></i><b>8</b> - Causalidade</a>
<ul>
<li class="chapter" data-level="8.1" data-path="causalidade.html"><a href="causalidade.html#resultados-potenciais"><i class="fa fa-check"></i><b>8.1</b> Resultados Potenciais</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="12-Regressao-Multipla.html"><a href="#decomposi%C3%A7%C3%A3o-do-efeito-causal"><i class="fa fa-check"></i><b>8.1.1</b> Decomposição do Efeito Causal</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="12-Regressao-Multipla.html"><a href="#modelo-estrutural-e-modelo-de-regress%C3%A3o"><i class="fa fa-check"></i><b>8.2</b> Modelo estrutural e modelo de regressão</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="causalidade.html"><a href="causalidade.html#exemplo-de-cef-e-cef-estrutural"><i class="fa fa-check"></i><b>8.2.1</b> Exemplo de CEF e CEF estrutural</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="12-Regressao-Multipla.html"><a href="#simula%C3%A7%C3%A3o-de-resultados-potenciais-e-causalidade"><i class="fa fa-check"></i><b>8.3</b> Simulação de Resultados Potenciais e Causalidade</a></li>
<li class="chapter" data-level="8.4" data-path="12-Regressao-Multipla.html"><a href="#refer%C3%AAncias"><i class="fa fa-check"></i><b>8.4</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mle.html"><a href="mle.html"><i class="fa fa-check"></i><b>9</b> - MLE</a>
<ul>
<li class="chapter" data-level="9.1" data-path="12-Regressao-Multipla.html"><a href="#estima%C3%A7%C3%A3o-por-m%C3%A1xima-verossimilhan%C3%A7a"><i class="fa fa-check"></i><b>9.1</b> Estimação por Máxima Verossimilhança</a></li>
<li class="chapter" data-level="9.2" data-path="12-Regressao-Multipla.html"><a href="#teste-de-hip%C3%B3tese"><i class="fa fa-check"></i><b>9.2</b> Teste de hipótese</a></li>
<li class="chapter" data-level="9.3" data-path="12-Regressao-Multipla.html"><a href="#regress%C3%A3o"><i class="fa fa-check"></i><b>9.3</b> regressão</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="checagem.html"><a href="checagem.html"><i class="fa fa-check"></i><b>10</b> - Checagem</a>
<ul>
<li class="chapter" data-level="10.1" data-path="12-Regressao-Multipla.html"><a href="#res%C3%ADduos"><i class="fa fa-check"></i><b>10.1</b> Resíduos</a></li>
<li class="chapter" data-level="10.2" data-path="checagem.html"><a href="checagem.html#modelo-no-r"><i class="fa fa-check"></i><b>10.2</b> Modelo no R</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="12-Regressao-Multipla.html"><a href="#res%C3%ADduos-contra-o-preditor"><i class="fa fa-check"></i><b>10.2.1</b> Resíduos contra o preditor</a></li>
<li class="chapter" data-level="10.2.2" data-path="12-Regressao-Multipla.html"><a href="#magnitude-dos-res%C3%ADduos-contra-o-preditor"><i class="fa fa-check"></i><b>10.2.2</b> Magnitude dos Resíduos Contra o Preditor</a></li>
<li class="chapter" data-level="10.2.3" data-path="12-Regressao-Multipla.html"><a href="#res%C3%ADduos-com-dados-temporais-eou-espaciais"><i class="fa fa-check"></i><b>10.2.3</b> Resíduos com dados Temporais e/ou Espaciais</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="12-Regressao-Multipla.html"><a href="#normalidade-dos-res%C3%ADduos"><i class="fa fa-check"></i><b>10.3</b> Normalidade dos resíduos</a></li>
<li class="chapter" data-level="10.4" data-path="12-Regressao-Multipla.html"><a href="#generaliza%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>10.4</b> Generalização</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inferencia.html"><a href="inferencia.html"><i class="fa fa-check"></i><b>11</b> - Inferencia</a>
<ul>
<li class="chapter" data-level="11.1" data-path="inferencia.html"><a href="inferencia.html#normal"><i class="fa fa-check"></i><b>11.1</b> Normal</a></li>
<li class="chapter" data-level="11.2" data-path="inferencia.html"><a href="inferencia.html#t-student"><i class="fa fa-check"></i><b>11.2</b> T-student</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="12-Regressao-Multipla.html"><a href="#avan%C3%A7ado---deriva%C3%A7%C3%A3o-da-t--de-student"><i class="fa fa-check"></i><b>11.2.1</b> Avançado - Derivação da t- de student</a></li>
<li class="chapter" data-level="11.2.2" data-path="inferencia.html"><a href="inferencia.html#teste-t"><i class="fa fa-check"></i><b>11.2.2</b> Teste t</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="12-Regressao-Multipla.html"><a href="#teste-de-hip%C3%B3tese-e-ic"><i class="fa fa-check"></i><b>11.3</b> Teste de Hipótese e IC</a></li>
<li class="chapter" data-level="11.4" data-path="12-Regressao-Multipla.html"><a href="#propriedades-assint%C3%B3ticas"><i class="fa fa-check"></i><b>11.4</b> Propriedades Assintóticas</a></li>
<li class="chapter" data-level="11.5" data-path="12-Regressao-Multipla.html"><a href="#infer%C3%AAncia-preditiva"><i class="fa fa-check"></i><b>11.5</b> Inferência Preditiva</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="regressao-multipla.html"><a href="regressao-multipla.html"><i class="fa fa-check"></i><b>12</b> - Regressao Multipla</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-Regressao-Multipla.html"><a href="#revis%C3%A3o-de-matriz-e-vetores"><i class="fa fa-check"></i><b>12.1</b> Revisão de Matriz e Vetores</a></li>
<li class="chapter" data-level="12.2" data-path="12-Regressao-Multipla.html"><a href="#modelo-b%C3%A1sico"><i class="fa fa-check"></i><b>12.2</b> Modelo básico</a></li>
<li class="chapter" data-level="12.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#modelo-com-matrizes"><i class="fa fa-check"></i><b>12.3</b> Modelo com matrizes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#estimador-de-mqo"><i class="fa fa-check"></i><b>12.3.1</b> Estimador de MQO</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="12-Regressao-Multipla.html"><a href="#interpreta%C3%A7%C3%A3o-dos-coeficientes"><i class="fa fa-check"></i><b>12.4</b> Interpretação dos coeficientes</a></li>
<li class="chapter" data-level="12.5" data-path="12-Regressao-Multipla.html"><a href="#regress%C3%A3o-m%C3%BAltipla-versus-m%C3%BAltiplas-regress%C3%B5es-separadas-ou-vi%C3%A9s-de-vari%C3%A1vel-omitida"><i class="fa fa-check"></i><b>12.5</b> Regressão múltipla versus Múltiplas Regressões Separadas ou Viés de variável omitida</a></li>
<li class="chapter" data-level="12.6" data-path="12-Regressao-Multipla.html"><a href="#matriz-chap%C3%A9u"><i class="fa fa-check"></i><b>12.6</b> Matriz chapéu</a></li>
<li class="chapter" data-level="12.7" data-path="regressao-multipla.html"><a href="regressao-multipla.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.8" data-path="12-Regressao-Multipla.html"><a href="#erro-padr%C3%A3o-robusto"><i class="fa fa-check"></i><b>12.8</b> Erro padrão Robusto</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="12-Regressao-Multipla.html"><a href="#entendendo-o-erro-padr%C3%A3o-robusto"><i class="fa fa-check"></i><b>12.8.1</b> Entendendo o erro padrão robusto</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="12-Regressao-Multipla.html"><a href="#termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9</b> Termo de interação</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A2ncia-do-termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9.1</b> Variância do termo de interação</a></li>
<li class="chapter" data-level="12.9.2" data-path="12-Regressao-Multipla.html"><a href="#calculando-o-erro-padr%C3%A3o-do-termo-de-intera%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>12.9.2</b> Calculando o erro padrão do termo de interação</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="12-Regressao-Multipla.html"><a href="#an%C3%A1lise-de-sensibilidade-causal"><i class="fa fa-check"></i><b>12.10</b> Análise de sensibilidade causal</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="12-Regressao-Multipla.html"><a href="#deriva%C3%A7%C3%A3o-do-r-quadrado"><i class="fa fa-check"></i><b>12.10.1</b> Derivação do R-quadrado</a></li>
<li class="chapter" data-level="12.10.2" data-path="12-Regressao-Multipla.html"><a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida"><i class="fa fa-check"></i><b>12.10.2</b> Viés de variável omitida</a></li>
<li class="chapter" data-level="12.10.3" data-path="12-Regressao-Multipla.html"><a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida-em-fun%C3%A7%C3%A3o-do-r-quadrado"><i class="fa fa-check"></i><b>12.10.3</b> Viés de variável omitida em função do R-quadrado</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="12-Regressao-Multipla.html"><a href="#refer%C3%AAncias-1"><i class="fa fa-check"></i><b>12.11</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>13</b> - GLM</a>
<ul>
<li class="chapter" data-level="13.1" data-path="glm.html"><a href="glm.html#plm"><i class="fa fa-check"></i><b>13.1</b> PLM</a></li>
<li class="chapter" data-level="13.2" data-path="12-Regressao-Multipla.html"><a href="#log%C3%ADstica"><i class="fa fa-check"></i><b>13.2</b> Logística</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="12-Regressao-Multipla.html"><a href="#log%C3%ADstica-como-melhoria-em-rela%C3%A7%C3%A3o-ao-mpl"><i class="fa fa-check"></i><b>13.2.1</b> Logística como melhoria em relação ao MPL</a></li>
<li class="chapter" data-level="13.2.2" data-path="glm.html"><a href="glm.html#logito"><i class="fa fa-check"></i><b>13.2.2</b> Logito</a></li>
<li class="chapter" data-level="13.2.3" data-path="12-Regressao-Multipla.html"><a href="#odds-ratio---raz%C3%A3o-de-chances"><i class="fa fa-check"></i><b>13.2.3</b> Odds Ratio - Razão de chances</a></li>
<li class="chapter" data-level="13.2.4" data-path="12-Regressao-Multipla.html"><a href="#coeficientes-e-erros-padr%C3%B5es"><i class="fa fa-check"></i><b>13.2.4</b> Coeficientes e erros padrões</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="12-Regressao-Multipla.html"><a href="#log%C3%ADstica-como-vari%C3%A1vel-latente"><i class="fa fa-check"></i><b>13.3</b> Logística como variável latente</a></li>
<li class="chapter" data-level="13.4" data-path="glm.html"><a href="glm.html#probit"><i class="fa fa-check"></i><b>13.4</b> Probit</a></li>
<li class="chapter" data-level="13.5" data-path="12-Regressao-Multipla.html"><a href="#log%C3%ADstica-como-glm"><i class="fa fa-check"></i><b>13.5</b> Logística como GLM</a></li>
<li class="chapter" data-level="13.6" data-path="12-Regressao-Multipla.html"><a href="#log%C3%ADstica-com-m%C3%BAltiplos-preditores"><i class="fa fa-check"></i><b>13.6</b> Logística com múltiplos preditores</a></li>
<li class="chapter" data-level="13.7" data-path="glm.html"><a href="glm.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>13.7</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="13.8" data-path="12-Regressao-Multipla.html"><a href="#regress%C3%A3o-com-dados-ordenados"><i class="fa fa-check"></i><b>13.8</b> Regressão com dados Ordenados</a></li>
<li class="chapter" data-level="13.9" data-path="12-Regressao-Multipla.html"><a href="#refer%C3%AAncias-2"><i class="fa fa-check"></i><b>13.9</b> Referências</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="12-Regressao-Multipla.html"><a href="#ap%C3%AAndice"><i class="fa fa-check"></i><b>14</b> - Apêndice</a>
<ul>
<li class="chapter" data-level="14.1" data-path="12-Regressao-Multipla.html"><a href="#importa%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>14.1</b> Importação</a></li>
<li class="chapter" data-level="14.2" data-path="12-Regressao-Multipla.html"><a href="#gr%C3%A1ficos-e-tabelas"><i class="fa fa-check"></i><b>14.2</b> Gráficos e Tabelas</a></li>
<li class="chapter" data-level="14.3" data-path="apêndice.html"><a href="apêndice.html"><i class="fa fa-check"></i><b>14.3</b> Limpeza de dados</a></li>
<li class="chapter" data-level="14.4" data-path="apêndice.html"><a href="apêndice.html#modelagem-de-dados"><i class="fa fa-check"></i><b>14.4</b> Modelagem de dados</a></li>
<li class="chapter" data-level="14.5" data-path="apêndice.html"><a href="apêndice.html#outros"><i class="fa fa-check"></i><b>14.5</b> Outros</a></li>
<li class="chapter" data-level="14.6" data-path="12-Regressao-Multipla.html"><a href="#%C3%A1lgebra-linear"><i class="fa fa-check"></i><b>14.6</b> Álgebra Linear</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="12-Regressao-Multipla.html"><a href="#espa%C3%A7o-de-vetores-e-subspa%C3%A7o"><i class="fa fa-check"></i><b>14.6.1</b> Espaço de vetores e subspaço</a></li>
<li class="chapter" data-level="14.6.2" data-path="12-Regressao-Multipla.html"><a href="#proje%C3%A7%C3%A3o-linear-2"><i class="fa fa-check"></i><b>14.6.2</b> Projeção linear</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="apêndice.html"><a href="apêndice.html#dados-espaciais"><i class="fa fa-check"></i><b>14.7</b> Dados Espaciais</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="12-Regressao-Multipla.html"><a href="#pol%C3%ADgonos"><i class="fa fa-check"></i><b>14.7.1</b> Polígonos</a></li>
<li class="chapter" data-level="14.7.2" data-path="apêndice.html"><a href="apêndice.html#econometria-espacial"><i class="fa fa-check"></i><b>14.7.2</b> Econometria espacial</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="teoremas.html"><a href="teoremas.html"><i class="fa fa-check"></i><b>15</b> - Teoremas</a>
<ul>
<li class="chapter" data-level="15.1" data-path="12-Regressao-Multipla.html"><a href="#independ%C3%AAncia-e-correla%C3%A7%C3%A3o"><i class="fa fa-check"></i><b>15.1</b> Independência e Correlação</a></li>
<li class="chapter" data-level="15.2" data-path="teoremas.html"><a href="teoremas.html#propriedade-de-estimadores"><i class="fa fa-check"></i><b>15.2</b> Propriedade de estimadores</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="12-Regressao-Multipla.html"><a href="#vi%C3%A9s"><i class="fa fa-check"></i><b>15.2.1</b> Viés</a></li>
<li class="chapter" data-level="15.2.2" data-path="12-Regressao-Multipla.html"><a href="#vari%C3%A2ncia-1"><i class="fa fa-check"></i><b>15.2.2</b> Variância</a></li>
<li class="chapter" data-level="15.2.3" data-path="12-Regressao-Multipla.html"><a href="#efici%C3%AAncia"><i class="fa fa-check"></i><b>15.2.3</b> Eficiência</a></li>
<li class="chapter" data-level="15.2.4" data-path="12-Regressao-Multipla.html"><a href="#consist%C3%AAncia"><i class="fa fa-check"></i><b>15.2.4</b> Consistência</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="12-Regressao-Multipla.html"><a href="#exerc%C3%ADcios-para-o-leitor"><i class="fa fa-check"></i><b>15.3</b> Exercícios para o leitor</a></li>
<li class="chapter" data-level="15.4" data-path="12-Regressao-Multipla.html"><a href="#lei-das-esperan%C3%A7as-iteradas"><i class="fa fa-check"></i><b>15.4</b> Lei das Esperanças Iteradas</a></li>
<li class="chapter" data-level="15.5" data-path="teoremas.html"><a href="teoremas.html#teorema-do-condicionamento"><i class="fa fa-check"></i><b>15.5</b> Teorema do Condicionamento</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à Regresssão para Ciências Sociais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regressao-multipla" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Capítulo 12</span> - Regressao Multipla<a href="regressao-multipla.html#regressao-multipla" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="regressao-multipla.html#cb239-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb239-2"><a href="regressao-multipla.html#cb239-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb239-3"><a href="regressao-multipla.html#cb239-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb239-4"><a href="regressao-multipla.html#cb239-4" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb239-5"><a href="regressao-multipla.html#cb239-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
<p>É muito raro que tenhamos apenas um preditor em um contexto de regressão. Talvez em um experimento de laboratório, e mesmo assim é difícil não ter outros preditores. De modo que tudo que vimos até agora é um caso particular raríssimo e pouco útil per se. Para generalizar as derivações e resultados para múltiplos preditores é conveniente utilizar álgebra linear. Basicamente, isso significa usar vetores e matrizes para representar a regressão. As derivações das fórmulas ficam bem fáceis, bem como as propriedades do modelo de regressão. Como não estamos pressupondo que vocês conheçam o básico de Álgebra Linear, iremos pular as derivações e apresentar apenas as intuições, esperando que o que vocês aprenderam com um preditor seja suficiente para entender com múltiplos preditores.</p>
<div id="revisão-de-matriz-e-vetores" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Revisão de Matriz e Vetores<a href="#revis%C3%A3o-de-matriz-e-vetores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regressão múiltipla é mais facilmente compreendida com uso de matrizes. Portanto, vamos fazer uma rápida revisão da álgebra de vetores e matrizes.</p>
<p>Se eu tenho um vetor <span class="math inline">\(x = [ a_1, a_2, ..., a_n]\)</span>, digo que este é um vetor linha com <span class="math inline">\(n\)</span> elementos. É possível também ter um vetor coluna:</p>
<p><span class="math display">\[
\begin{align}
    x &amp;= \begin{bmatrix}
           a_{1} \\
           a_{2} \\
           \vdots \\
           a_{n}
         \end{bmatrix}
\end{align}
\]</span>
Eu posso somar dois vetores linhas ou dois vetores colunas, se tiverem o mesmo número de elementos. Por exemplo, dois vetores colunas.
<span class="math display">\[
  \begin{align}
          \begin{bmatrix}
           a_{1} \\           
           \vdots \\
           a_{n}
          \end{bmatrix} +
          \begin{bmatrix}
           b_{1} \\
           \vdots \\
           b_{n}
         \end{bmatrix}
    &amp;= \begin{bmatrix}
           a_1 + b_{1} \\           
           \vdots \\
           a_n + b_{n}
          \end{bmatrix}     
  \end{align}
\]</span>
E posso fazer multiplicação de vetores (existem vários tipos, aqui me restringo ao produto interno ou produto ponto de vetores), desde que a gente multiplique um vetor linha por uma vetor coluna, mas não o contrário.</p>
<p><span class="math display">\[
  \begin{align}
          \begin{bmatrix}
           a_{1}, a_2, \cdots, a_{n}
          \end{bmatrix} \cdot
          \begin{bmatrix}
           b_{1} \\
           b_{2} \\
           \vdots \\
           b_{n}
         \end{bmatrix}
    &amp;=  a_1 \cdot b_{1} + a_2 \cdot b_2 \cdots + a_n \cdot b_{n}
  \end{align}
\]</span>
A razão é que a multiplicação de vetores (e matrizes em geral) é basicamente multiplicar linha com coluna. No caso de um vetor coluna multiplicado por um linha, isso não é possível.</p>
<p>A adição e multiplicação de matrizes é basicamente a generalização da ágebra com vetores</p>
</div>
<div id="modelo-básico" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Modelo básico<a href="#modelo-b%C3%A1sico" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>O modelo básico de regressão linear múltipla pode ser especificado por:</p>
<ol style="list-style-type: decimal">
<li><p>Existem p preditores, <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, …, <span class="math inline">\(X_p\)</span>. Não precisamos fazer suposições sobre a distribuição dos preditores, e podem ser correlacionados ou não.</p></li>
<li><p>Há uma única variável resposta, <span class="math inline">\(Y\)</span>. Se houvesse mais de uma, teríamos um modelo de regressão multivariada.</p></li>
<li><p><span class="math inline">\(y_i = \alpha + \beta_1 \cdot x_{1i} + \beta_2 \cdot x_{2i} + ... + \beta_p \cdot x_{pi} + e_i\)</span>. Portanto, temos <span class="math inline">\(p+1\)</span> parâmetros ou coeficientes de regressão a estimar.</p></li>
<li><p>O erro <span class="math inline">\(e_i\)</span> possui esperança condicional zero e variância condicional constante no modelo homocedástico, e não correlacionado entre observações.</p></li>
</ol>
<p>Se assumirmos normalidade do termo de erro, temos também:</p>
<ol start="5" style="list-style-type: decimal">
<li>O erro <span class="math inline">\(e_i\)</span> tem uma distribuição normal multivariada, com vetor de médias zero e matriz de variância e covariância cujos elementos fora da diagonal (covariância) são zero, e a diagonal principal é <span class="math inline">\(\sigma^2\)</span>.</li>
</ol>
</div>
<div id="modelo-com-matrizes" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Modelo com matrizes<a href="regressao-multipla.html#modelo-com-matrizes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vejam que <span class="math inline">\(\alpha + \beta_1 \cdot x_{1i} + \beta_2 \cdot x_{2i} + ... + \beta_p \cdot x_{pi} + e_i\)</span> é uma soma de produtos, similar ao que eu tinha com vetores no exemplo acima. Exceto que <span class="math inline">\(\alpha\)</span> não multiplica nada. Então, vou considerar que tenhao um preditor cujo valor é uma constante e igual a <span class="math inline">\(1\)</span>, e os demais preditores, de forma que o lado direito da equação de regressão pode ser reescrito como soma e multiplicação de matrizes. Para o caso de um preditor <span class="math inline">\(y_i = \alpha + \beta_ix_{1i} + e_i\)</span>, a equação de regressão com matrizes, fica:</p>
<p><span class="math display">\[
  \begin{align}
  \begin{bmatrix}
    y_1 \\
     y_2 \\
     \vdots \\
     y_{n}
     \end{bmatrix}
     &amp;=
          \begin{bmatrix}
           1 &amp; x_{11} \\
           1 &amp; x_{12} \\
           \vdots \\
           1 &amp; x_{1n}
         \end{bmatrix}
          \begin{bmatrix}
           \alpha \\
           \beta_1 \\
         \end{bmatrix} +
        \begin{bmatrix}
           e_1 \\
           e_2 \\
           \vdots \\
           e_n
         \end{bmatrix}
  \end{align}
\]</span>
Se eu chamar o vetor coluna com os <span class="math inline">\(y\)</span> de <span class="math inline">\(Y\)</span>, a matriz com a constante <span class="math inline">\(1\)</span> e <span class="math inline">\(x_{1i}\)</span> de <span class="math inline">\(X\)</span>, o vetor de coeficientes de <span class="math inline">\(B\)</span> e o vetor de erros <span class="math inline">\(\epsilon\)</span>, tenho então:</p>
<p><span class="math display">\[
Y = XB + \epsilon
\]</span>
Veja que a generalização para <span class="math inline">\(p\)</span> preditores gera a mesma equação:</p>
<p><span class="math display">\[
  \begin{align}
  \begin{bmatrix}
    y_1 \\
     y_2 \\
     \vdots \\
     y_{n}
     \end{bmatrix}
     &amp;=
          \begin{bmatrix}
           1 &amp; x_{11} &amp; x_{21} \cdots &amp; x_{p1}\\
           1 &amp; x_{12} &amp; x_{22} \cdots &amp; x_{p2}\\
           \vdots \\
           1 &amp; x_{1n} &amp; x_{2n} \cdots &amp; x_{pn}
         \end{bmatrix}
          \begin{bmatrix}
           \alpha \\
           \beta_1 \\
           \beta_2 \\
           \vdots \\
           \beta_p
         \end{bmatrix} +
        \begin{bmatrix}
           e_1 \\
           e_2 \\
           \vdots \\
           e_n
         \end{bmatrix}
  \end{align}
\]</span></p>
<p><span class="math display">\[
Y = XB + \epsilon
\]</span></p>
<p>A única diferença é o tamanho da matriz <span class="math inline">\(X\)</span> e <span class="math inline">\(B\)</span>, em que <span class="math inline">\(X\)</span> é uma matriz <span class="math inline">\(n \times (p+1)\)</span>, isto é, com <span class="math inline">\(n\)</span> linhas e <span class="math inline">\(p+1\)</span> colunas, e <span class="math inline">\(B\)</span> é uma matriz de tamanho <span class="math inline">\((p+1) \times 1\)</span> e <span class="math inline">\(Y\)</span> e <span class="math inline">\(\epsilon\)</span> são <span class="math inline">\(n \times 1\)</span>. E as suposições podem ser escritas como <span class="math inline">\(\mathbb{E}[\epsilon|X] = 0\)</span> e <span class="math inline">\(\mathbb{Var}[\epsilon|X] = \sigma^2I\)</span>, em que <span class="math inline">\(I\)</span> é a matriz identidade, isto é, uma matriz cuja diagonal principal é <span class="math inline">\(1\)</span> e o resto é <span class="math inline">\(zero\)</span>.</p>
<div id="estimador-de-mqo" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Estimador de MQO<a href="regressao-multipla.html#estimador-de-mqo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>É possível mostrar que o estimador de mínimos quadrados ordinários é dados por:</p>
<p><span class="math display">\[
\hat{B} = (X&#39;X)^{-1} \cdot X&#39;Y
\]</span>
Veja que <span class="math inline">\(X&#39;Y\)</span> é um produto (com soma) entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, ou seja, é como se fosse a covariância entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, e <span class="math inline">\(X&#39;X\)</span> se assemelha à variância de <span class="math inline">\(X\)</span>. E está elevado a <span class="math inline">\(-1\)</span> porque não existe divisão em matriz, de forma que preciso multiplicar pela inversa.</p>
</div>
</div>
<div id="interpretação-dos-coeficientes" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Interpretação dos coeficientes<a href="#interpreta%C3%A7%C3%A3o-dos-coeficientes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nosso coeficiente <span class="math inline">\(\alpha\)</span> é novamente o valor esperado do <span class="math inline">\(Y\)</span> na origem, isto é:</p>
<p><span class="math display">\[
\alpha = \mathbb{E}[Y|X_1=0, X_2=0, \cdots, X_p=0]$
\]</span>
Em um modelo sem interações, o efeito de cada variávei <span class="math inline">\(X_i\)</span> é a contribuição separada para a resposta esperada (média). Portanto, <span class="math inline">\(B_i\)</span> mede a contribuição de como <span class="math inline">\(\mathbb{E}[Y]\)</span> muda à medida que <span class="math inline">\(X_i\)</span> (e apenas <span class="math inline">\(X_i\)</span>) muda, para qualquer valor de <span class="math inline">\(X_i\)</span> (se a equação for linear nas variáveis) e para qualquer valor das demais variáveis (pressuposto de aditividade, sem interação, dos preditores).</p>
<p>Vamos retomar nosso modelo de previsão eleitoral e rodar no R, agora adicionando múltipals variáveis.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="regressao-multipla.html#cb240-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb240-2"><a href="regressao-multipla.html#cb240-2" tabindex="-1"></a></span>
<span id="cb240-3"><a href="regressao-multipla.html#cb240-3" tabindex="-1"></a><span class="co"># lista o nome do arquivo em csv</span></span>
<span id="cb240-4"><a href="regressao-multipla.html#cb240-4" tabindex="-1"></a><span class="co"># unzip(here(&quot;dados&quot;, &quot;votacao_secao_2018_BR.zip&quot;), list = TRUE)</span></span>
<span id="cb240-5"><a href="regressao-multipla.html#cb240-5" tabindex="-1"></a></span>
<span id="cb240-6"><a href="regressao-multipla.html#cb240-6" tabindex="-1"></a></span>
<span id="cb240-7"><a href="regressao-multipla.html#cb240-7" tabindex="-1"></a><span class="co">#read data1.csv into data frame</span></span>
<span id="cb240-8"><a href="regressao-multipla.html#cb240-8" tabindex="-1"></a>presid_18 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">here</span>(<span class="st">&quot;dados&quot;</span>,<span class="st">&quot;votacao_secao_2018_BR.csv&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;Latin-1&quot;</span>)</span>
<span id="cb240-9"><a href="regressao-multipla.html#cb240-9" tabindex="-1"></a></span>
<span id="cb240-10"><a href="regressao-multipla.html#cb240-10" tabindex="-1"></a><span class="co"># Supondo que seu dataframe seja chamado df</span></span>
<span id="cb240-11"><a href="regressao-multipla.html#cb240-11" tabindex="-1"></a>df_resultados <span class="ot">&lt;-</span> presid_18 <span class="sc">%&gt;%</span></span>
<span id="cb240-12"><a href="regressao-multipla.html#cb240-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>NR_VOTAVEL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">95</span>,<span class="dv">96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb240-13"><a href="regressao-multipla.html#cb240-13" tabindex="-1"></a>  <span class="fu">group_by</span>(NR_ZONA, CD_MUNICIPIO, SG_UF, NR_VOTAVEL, NR_TURNO) <span class="sc">%&gt;%</span></span>
<span id="cb240-14"><a href="regressao-multipla.html#cb240-14" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_votos =</span> <span class="fu">sum</span>(QT_VOTOS)) <span class="sc">%&gt;%</span></span>
<span id="cb240-15"><a href="regressao-multipla.html#cb240-15" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> NR_TURNO, <span class="at">values_from =</span> total_votos, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb240-16"><a href="regressao-multipla.html#cb240-16" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb240-17"><a href="regressao-multipla.html#cb240-17" tabindex="-1"></a>  <span class="fu">group_by</span>(nr_zona, cd_municipio, sg_uf) <span class="sc">%&gt;%</span></span>
<span id="cb240-18"><a href="regressao-multipla.html#cb240-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_validos_1t =</span> <span class="fu">sum</span>(x1),</span>
<span id="cb240-19"><a href="regressao-multipla.html#cb240-19" tabindex="-1"></a>         <span class="at">total_validos_2t =</span> <span class="fu">sum</span>(x2)) <span class="sc">%&gt;%</span></span>
<span id="cb240-20"><a href="regressao-multipla.html#cb240-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(nr_votavel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">17</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb240-21"><a href="regressao-multipla.html#cb240-21" tabindex="-1"></a>  <span class="fu">group_by</span>(nr_votavel) <span class="sc">%&gt;%</span></span>
<span id="cb240-22"><a href="regressao-multipla.html#cb240-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentual_1t =</span> x1 <span class="sc">/</span>total_validos_1t,</span>
<span id="cb240-23"><a href="regressao-multipla.html#cb240-23" tabindex="-1"></a>         <span class="at">percentual_2t =</span> x2 <span class="sc">/</span> total_validos_2t) <span class="sc">%&gt;%</span></span>
<span id="cb240-24"><a href="regressao-multipla.html#cb240-24" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb240-25"><a href="regressao-multipla.html#cb240-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(x1, x2, total_validos_1t, total_validos_2t)) <span class="sc">%&gt;%</span></span>
<span id="cb240-26"><a href="regressao-multipla.html#cb240-26" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> nr_votavel, </span>
<span id="cb240-27"><a href="regressao-multipla.html#cb240-27" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(percentual_1t, percentual_2t))</span>
<span id="cb240-28"><a href="regressao-multipla.html#cb240-28" tabindex="-1"></a></span>
<span id="cb240-29"><a href="regressao-multipla.html#cb240-29" tabindex="-1"></a><span class="co"># remove</span></span>
<span id="cb240-30"><a href="regressao-multipla.html#cb240-30" tabindex="-1"></a><span class="co"># rm(presid_18)</span></span>
<span id="cb240-31"><a href="regressao-multipla.html#cb240-31" tabindex="-1"></a></span>
<span id="cb240-32"><a href="regressao-multipla.html#cb240-32" tabindex="-1"></a>df_resultados <span class="sc">%&gt;%</span></span>
<span id="cb240-33"><a href="regressao-multipla.html#cb240-33" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>percentual_1t_17, <span class="at">y=</span>percentual_2t_17)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>sg_uf) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F, <span class="at">linewidth =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/dados-18%2012-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="regressao-multipla.html#cb241-1" tabindex="-1"></a><span class="co"># modelo de regressão</span></span>
<span id="cb241-2"><a href="regressao-multipla.html#cb241-2" tabindex="-1"></a></span>
<span id="cb241-3"><a href="regressao-multipla.html#cb241-3" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percentual_2t_17 <span class="sc">~</span> percentual_1t_17 <span class="sc">+</span> percentual_1t_13 <span class="sc">+</span> sg_uf, <span class="at">data =</span> df_resultados)</span>
<span id="cb241-4"><a href="regressao-multipla.html#cb241-4" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = percentual_2t_17 ~ percentual_1t_17 + percentual_1t_13 + 
##     sg_uf, data = df_resultados)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.190977 -0.010934 -0.001161  0.009747  0.272558 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       0.355531   0.005763  61.689   &lt;2e-16 ***
## percentual_1t_17  0.777791   0.005276 147.419   &lt;2e-16 ***
## percentual_1t_13 -0.277355   0.004577 -60.603   &lt;2e-16 ***
## sg_ufAL          -0.101170   0.004644 -21.787   &lt;2e-16 ***
## sg_ufAM          -0.084715   0.004815 -17.596   &lt;2e-16 ***
## sg_ufAP          -0.087085   0.006414 -13.577   &lt;2e-16 ***
## sg_ufBA          -0.086392   0.004355 -19.835   &lt;2e-16 ***
## sg_ufCE          -0.150819   0.004654 -32.406   &lt;2e-16 ***
## sg_ufDF          -0.077372   0.006221 -12.437   &lt;2e-16 ***
## sg_ufES          -0.079796   0.004701 -16.974   &lt;2e-16 ***
## sg_ufGO          -0.085402   0.004352 -19.624   &lt;2e-16 ***
## sg_ufMA          -0.105331   0.004464 -23.596   &lt;2e-16 ***
## sg_ufMG          -0.065445   0.004235 -15.454   &lt;2e-16 ***
## sg_ufMS          -0.061922   0.004685 -13.219   &lt;2e-16 ***
## sg_ufMT          -0.088621   0.004493 -19.722   &lt;2e-16 ***
## sg_ufPA          -0.071259   0.004489 -15.876   &lt;2e-16 ***
## sg_ufPB          -0.119179   0.004447 -26.801   &lt;2e-16 ***
## sg_ufPE          -0.113396   0.004454 -25.458   &lt;2e-16 ***
## sg_ufPI          -0.091415   0.004480 -20.404   &lt;2e-16 ***
## sg_ufPR          -0.060601   0.004284 -14.145   &lt;2e-16 ***
## sg_ufRJ          -0.096635   0.004433 -21.797   &lt;2e-16 ***
## sg_ufRN          -0.112249   0.004522 -24.826   &lt;2e-16 ***
## sg_ufRO          -0.059576   0.004958 -12.017   &lt;2e-16 ***
## sg_ufRR          -0.085327   0.006511 -13.104   &lt;2e-16 ***
## sg_ufRS          -0.061179   0.004262 -14.353   &lt;2e-16 ***
## sg_ufSC          -0.061522   0.004327 -14.220   &lt;2e-16 ***
## sg_ufSE          -0.094247   0.004814 -19.578   &lt;2e-16 ***
## sg_ufSP          -0.039378   0.004250  -9.265   &lt;2e-16 ***
## sg_ufTO          -0.095958   0.004526 -21.202   &lt;2e-16 ***
## sg_ufZZ          -0.081547   0.004558 -17.892   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.02 on 6209 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.9918, Adjusted R-squared:  0.9918 
## F-statistic: 2.588e+04 on 29 and 6209 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="regressao-multipla.html#cb243-1" tabindex="-1"></a><span class="co"># AC é a categoria de referência</span></span></code></pre></div>
<p>A interpretação das variáveis, portanto, é a seguinte:</p>
<ol style="list-style-type: decimal">
<li><p>O intercepto mede o percentual médio no segundo turno quando todas as variáveis são zero. Ou seja, Haddad e Bolsonaro tiveram 0 pontos percentuais (não existe caso assim!) e a UF é o Acre, que é a categoria de referência.</p></li>
<li><p>A variável “percentual_1t_17” mede o efeito preditivo no voto do 2o turno do Bolsonaro de aumento de um ponto percentual no voto do primeiro turno, que é de 0,77 pontos percentuais. A variável “percentual_1t_13” mede similarmente o efeito preditivo de aumento de um ponto percentual do voto do Haddad no primeiro turno sobre o voto do Bolsonaro no 2o turno. Como esperado, a relação é negativa, isto é, quanto melhor o Haddad foi no primeiro turno, pior o Bolsonaro no segundo turno naquela seção eleitoral. E o efeito de cada UF é o efeito de estar naquela UF, em comparação com a categoria de referência, ACRE.</p></li>
</ol>
</div>
<div id="regressão-múltipla-versus-múltiplas-regressões-separadas-ou-viés-de-variável-omitida" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Regressão múltipla versus Múltiplas Regressões Separadas ou Viés de variável omitida<a href="#regress%C3%A3o-m%C3%BAltipla-versus-m%C3%BAltiplas-regress%C3%B5es-separadas-ou-vi%C3%A9s-de-vari%C3%A1vel-omitida" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rodar uma regressão com duas variáveis (digamos), não é o mesmo que rodar duas regressões separadas, uma com cada variável. A razão é que os preditores em geral terão alguma correlação entre si. Para ver isso, suponha que o verdadeiro modelo é <span class="math inline">\(Y = \alpha + \beta_1 \cdot X_1 + \beta_2 \cdot X_2 + \epsilon\)</span>. O que aconteceria se rodássemos uma regressão com um preditor apenas (<span class="math inline">\(X_1\)</span>)?</p>
<p>Vamos usar as seguintes propriedades da covariância nessa derivação.</p>
<ol style="list-style-type: decimal">
<li><p>Sejam <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> duas v.a., Seja <span class="math inline">\(A\)</span> uma constante. Então, <span class="math inline">\(\mathbb{Cov}[X,Y + A] = \mathbb{Cov}[X,Y] + \mathbb{Cov}[X,A]\)</span>. Como <span class="math inline">\(A\)</span> é constante, <span class="math inline">\(\mathbb{Cov}[X,A] = 0\)</span> e, portanto, <span class="math inline">\(\mathbb{Cov}[X,Y + A] = \mathbb{Cov}[X,Y]\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbb{Cov}[X,Y \cdot A] = A \cdot \mathbb{Cov}[X,Y]\)</span>.</p></li>
</ol>
<p>Em um modelo com um único preditor, teremos:
<span class="math inline">\(Y = \alpha + \beta_1^* \cdot X_1 + \epsilon\)</span></p>
<p>Designei o beta da equação com um preditor por <span class="math inline">\(\beta_1^*\)</span>, para diferenciar do <span class="math inline">\(\beta_1\)</span> da verdadeira equação, com dois preditores.</p>
<p>Nós sabemos que <span class="math inline">\(\beta_1^* = \frac{\mathbb{Cov}[X_1,Y]}{\mathbb{Var}[X_1]}\)</span></p>
<p>Vamos substituir o <span class="math inline">\(Y\)</span> do modelo verdadeiro na equação do <span class="math inline">\(\beta_1^*\)</span>.</p>
<p><span class="math display">\[\begin{align*}
\beta_1^* = \frac{\mathbb{Cov}[X_1,\alpha + \beta_1 \cdot X_1 + \beta_2 \cdot X_2 + e]}{\mathbb{Var}[X_1]} = \\
\frac{\mathbb{Cov}[X_1,\beta_1 \cdot X_1] + \mathbb{Cov}[X_1, \beta_2 \cdot X_2] + \mathbb{Cov}[X_1, e]}{\mathbb{Var}[X_1]} = \\

\frac{\beta_1 \cdot \mathbb{Cov}[X_1, X_1] + \beta_2 \cdot \mathbb{Cov}[X_1, X_2] + \mathbb{ Cov}[X_1,e]}{\mathbb{Var}[X_1]} = \\
\frac{\beta_1 \cdot \mathbb{Var}[X_1] + \beta_2 \cdot \mathbb{Cov}[X_1, X_2] + 0}{\mathbb{Var}[X_1]} = \\

\frac{\beta_1 \cdot \mathbb{Var}[X_1]}{\mathbb{Var}[X_1]} + \frac{\beta_2 \cdot \mathbb{Cov}[X_1, X_2] + 0}{\mathbb{Var}[X_1]} = \\

\beta_1 + \frac{\beta_2 \cdot \mathbb{Cov}[X_1, X_2] + 0}{\mathbb{Var}[X_1]} = \\

\beta_1^* = \beta_1 + \frac{\beta_2 \cdot \mathbb{Cov}[X_1, X_2]}{\mathbb{Var}[X_1]}
\end{align*}\]</span></p>
<p>Vemos que a inclinação <span class="math inline">\(\beta_1^*\)</span> inclui a contribuição direta de <span class="math inline">\(X_1\)</span> via <span class="math inline">\(\beta_1\)</span> mais a contribuição indireta da correlação com <span class="math inline">\(X_2\)</span>, via <span class="math inline">\(\beta_2\)</span>.</p>
<p>Portanto, se eu rodar uma regressão com um preditor quando o verdadeiro modelo tem dois preditores, o coeficiente de <span class="math inline">\(\beta_1^*\)</span> será uma média entre <span class="math inline">\(\beta_1\)</span> e <span class="math inline">\(\beta_2\)</span>. Por outro lado, se eu rodar a regressão com o modelo correto com os dois preditores, consigo que <span class="math inline">\(\beta_1^*\)</span> reflita só a contribuição de <span class="math inline">\(\beta_1\)</span>.</p>
<p>Talvez você esteja se perguntando a essa altura: quem garante que o verdadeiro modelo possua só dois preditores? Isso é o que chamamos de viés de variável omitida. Se omitirmos da regressão uma variável <span class="math inline">\(X_k\)</span> correlacionada com <span class="math inline">\(X_j\)</span>, <span class="math inline">\(j \neq k\)</span>, então o coeficiente <span class="math inline">\(\beta_j\)</span> reflitirá também o efeito de <span class="math inline">\(\beta_k\)</span>.</p>
<p>Aqui não estamos falando de causalidade, apenas da contribuição para a previsão da nossa variável resposta. Naturalmente, antes da moderna abordagem de inferência causal por resultados potenciais de Rubin (ou redes Bayesianas em modelos estruturais de Pearl), as pessoas pensavam que, controlando para o máximo de variáveis possível, com sorte seria possível eliminar (ou reduzir a um mínimo) o viés de variável omitida e, portanto, estar seguro que <span class="math inline">\(\beta_1\)</span> estimaria o efeito causal.</p>
<p>Nós hoje sabemos que o modo mais seguro de pensar causalidade é usando uma das duas abordagens (as iniciadas por Rubin ou Pearl), e verificando (por exemplo com resultados potenciais) que a suposição de independência condicional (<em>CIA</em>, de Conditional Independence Assumption) é plausível para poder interpretar <span class="math inline">\(\beta_1\)</span> causalmente. Sem um modelo causal, a abordagem de introdução de regressores para controlar o viés de variável omitida não nos permite fazer inferência causal, exceto em casos muitos simples ou quando implicitamente temos garantida a validade da <em>CIA</em> (como em um experimento bem conduzido e com compliance), como é o caso das ciências naturais como física e química.</p>
</div>
<div id="matriz-chapéu" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Matriz chapéu<a href="#matriz-chap%C3%A9u" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma forma interessante de visualizar as previsões do modelo é que podemos escrever <span class="math inline">\(\hat{Y} = XB\)</span>. Substituindo a fórmula do <span class="math inline">\(B\)</span>, temos que:
<span class="math display">\[
\hat{Y} = X (X&#39;X)^{-1}X&#39;Y = \\
(X (X&#39;X)^{-1}X&#39;)Y = \\
HY
\]</span>
Essa equação mostra que as previsões são dadas pelas respostas observadas, ponderadas pela matriz chapéu (<em>hat</em>), <span class="math inline">\(H\)</span>.</p>
</div>
<div id="multicolinearidade" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Multicolinearidade<a href="regressao-multipla.html#multicolinearidade" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Até o momento não falamos sobre em que condições a matrix inversa <span class="math inline">\(X&#39;X^{-1}\)</span> existe. Nós sabemos que nem todas as matrizes podem ser invertíveis. Matrizes com determinante zero são não-invertíveis. A intuição é como pensar que não é possível dividir um escalar por zero. O determinante é zero quando as colunas não são linearmente independentes. Ou seja, quando uma coluna (ou mais) é uma combinação linear de um ou mais colunas. No nosso caso, quando a correlação for <span class="math inline">\(1\)</span> (ou <span class="math inline">\(-1\)</span>). Nesses casos, não é possível estimar os coeficientes da regressão e acontece quando temos multicolinearidade.</p>
<p>Softwares modernos, como R, irão “dropar” uma (ouas mais) variável(eis) se isso ocorrer, automaticamente, para evitar que a matriz não seja invertível. Assim, a menos que acorrelação seja perfeita, multicolinearidade não costuma ser um problema.</p>
</div>
<div id="erro-padrão-robusto" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> Erro padrão Robusto<a href="#erro-padr%C3%A3o-robusto" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Na presença de heterocedasticidade ou correlação nos erros (como autocorrelação temporal ou autocorrelação espacial), precisamos corrigir o cálculo do erro padrão. Para explicar como é calculado o erro padrão robusto, vamos derivar o erro padrão novamente, agora com a notação matricial.</p>
<p>Lembremos que: <span class="math inline">\(\hat{B} = (X&#39;X)^{-1}(X&#39;Y)\)</span> e <span class="math inline">\(Y = XB + e\)</span>. Logo, reescrevendo a equação de regressão, temos:
<span class="math display">\[\begin{align}
\hat{B} = (X&#39;X)^{-1}(X&#39;[XB + e]) \\
= (X&#39;X)^{-1}(X&#39;XB + X&#39;e) \\
= (X&#39;X)^{-1}X&#39;XB + (X&#39;X)^{-1}X&#39;e \\
= B + (X&#39;X)^{-1}X&#39;e
\end{align}\]</span></p>
<p>E a partir dessa equação, podemos calcular a variância dos estimadores.</p>
<p><span class="math display">\[\begin{align}
\mathbb{Var}[\hat{B}|X] = \mathbb{Var}[B + (X&#39;X)^{-1}X&#39;e|X] \\
= \mathbb{Var}[(X&#39;X)^{-1}X&#39;e|X] \\
= (X&#39;X)^{-1}X&#39;\mathbb{Var}[e|X]X(X&#39;X)^{-1} \\
= (X&#39;X)^{-1}X&#39;\sigma^2IX(X&#39;X)^{-1} \\
= \sigma^2(X&#39;X)^{-1}X&#39;X(X&#39;X)^{-1} \\
= \sigma^2(X&#39;X)^{-1}
\end{align}\]</span></p>
<p>Para ficar mais familiar para a gente, posso multiplicar e dividir por <span class="math inline">\(n\)</span>, que não altero a equação. Assim, temos:
<span class="math display">\[
\mathbb{Var}[\hat{B}|X] = \frac{\sigma^2}{n}(n^{-1}(X&#39;X)^{-1})
\]</span>
Lembrem-e que a variância do <span class="math inline">\(\hat{\beta|x}\)</span> no modelo de regressão simples era dada por: <span class="math inline">\(\frac{\sigma^2}{nS_x^2}\)</span></p>
<p>Então, <span class="math inline">\(\frac{\sigma^2}{n}\)</span> é igual ao que tínhamos antes. À medida que <span class="math inline">\(n\)</span> cresce, esperamos que <span class="math inline">\(X&#39;X\)</span> cresça, já que é uma soma sobre todos os dados <span class="math inline">\(n\)</span>. Dividingo todas as entradas da matriz por <span class="math inline">\(n\)</span> compensa isso. Se a covariância amostral entre todos os preditores fossem iguais a zero (sem correlação), então quando calculássemos a inversa obteríamos apenas a variância amostral de <span class="math inline">\(X\)</span> <span class="math inline">\(1/S_x^2\)</span> na diagonal principal, e temos um termo que já conhecemos de regressão simples. Lá, como só tem um preditor, não tem como ter covariância com outro preditor.</p>
<p>Agora podemos falar de erro padrão robusto. Notem que em nossa derivação, a certa altura, tivemos:
<span class="math display">\[
\mathbb{Var}[\hat{B}|X] = (X&#39;X)^{-1}X&#39;\sigma^2IX(X&#39;X)^{-1}
\]</span>
Se chamarmos <span class="math inline">\(\sigma^2I\)</span> de <span class="math inline">\(\Omega\)</span>, reescrevo a equação como:</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{B}|X] = (X&#39;X)^{-1}X&#39;\Omega X(X&#39;X)^{-1}
\]</span>
E essa equação, escrita desse formato, é chamada de equação sanduíche, pois temos
1. <span class="math inline">\(X&#39;\Omega X\)</span> no meio
2. <span class="math inline">\((X&#39;X)^{-1}\)</span> nas pontas.
Ou seja, a carne <span class="math inline">\(X&#39;\Omega X\)</span> vai no meio de duas fatias de pão <span class="math inline">\((X&#39;X)^{-1}X&#39;\)</span>.</p>
<p>Eu suponho que isso seja engraçado de alguma forma (ou talvez fosse uma forma menmômica de memorizar a equação). Mas o fato é que o termo sanduíche pegou de tal forma que nosso erro padrão robusto envolve trocar a “carne”.</p>
<p>Veja que definimos <span class="math inline">\(\Omega = \sigma^2I\)</span>. E <span class="math inline">\(\sigma^2I\)</span> pressupõe que temos homecedasticidade, já que a variância do erro é constante. Temos portanto de modificar a “carne” para calcular o erro padrão-robusto. Vamos fazer isso manualmente, primeiro calculando o erro padrão tradicional, e depois o que seria um erro padrão robusto.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="regressao-multipla.html#cb244-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb244-2"><a href="regressao-multipla.html#cb244-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb244-3"><a href="regressao-multipla.html#cb244-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb244-4"><a href="regressao-multipla.html#cb244-4" tabindex="-1"></a></span>
<span id="cb244-5"><a href="regressao-multipla.html#cb244-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb244-6"><a href="regressao-multipla.html#cb244-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">8</span>,<span class="at">sd =</span> <span class="fl">1.5</span>), <span class="dv">40</span>, <span class="dv">65</span>)</span>
<span id="cb244-7"><a href="regressao-multipla.html#cb244-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y, <span class="at">x=</span>x)</span>
<span id="cb244-8"><a href="regressao-multipla.html#cb244-8" tabindex="-1"></a></span>
<span id="cb244-9"><a href="regressao-multipla.html#cb244-9" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb244-10"><a href="regressao-multipla.html#cb244-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/cap12-se-robusto%20toy-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="regressao-multipla.html#cb245-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span>x)</span>
<span id="cb245-2"><a href="regressao-multipla.html#cb245-2" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -19.736  -6.320   2.465   8.326  12.481 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -11.0831     6.6974  -1.655  0.13655   
## x             4.2401     0.9208   4.605  0.00174 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.53 on 8 degrees of freedom
## Multiple R-squared:  0.7261, Adjusted R-squared:  0.6918 
## F-statistic:  21.2 on 1 and 8 DF,  p-value: 0.001745</code></pre>
<p>Nós construímos um “toy model” em que não existe relação entre <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span>. Porém, por causa de dois “outliers” o R achou que existia associação entre as variáveis. Como o R calcula o erro padrão? Nossa fórmula requer <span class="math inline">\(\sigma^2\)</span>, <span class="math inline">\(I\)</span> e a matriz de preditores <span class="math inline">\(X\)</span>, que depois vou transpor, calcular inversa etc. No R, podemos computar cada um desses itens manualmente da seguinte forma.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="regressao-multipla.html#cb247-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb247-2"><a href="regressao-multipla.html#cb247-2" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">sigma</span>(fit)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb247-3"><a href="regressao-multipla.html#cb247-3" tabindex="-1"></a>mat_I <span class="ot">&lt;-</span> <span class="fu">diag</span>(n)</span>
<span id="cb247-4"><a href="regressao-multipla.html#cb247-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fit)</span></code></pre></div>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="regressao-multipla.html#cb248-1" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sigma2<span class="sc">*</span>mat_I</span>
<span id="cb248-2"><a href="regressao-multipla.html#cb248-2" tabindex="-1"></a>bread <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb248-3"><a href="regressao-multipla.html#cb248-3" tabindex="-1"></a>meat <span class="ot">&lt;-</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> omega <span class="sc">%*%</span> X)</span>
<span id="cb248-4"><a href="regressao-multipla.html#cb248-4" tabindex="-1"></a>vce <span class="ot">&lt;-</span> bread <span class="sc">%*%</span> meat <span class="sc">%*%</span> bread</span>
<span id="cb248-5"><a href="regressao-multipla.html#cb248-5" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(vce))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##   6.6974057   0.9208285</code></pre>
<p>Se inspecionarmos omega mais detalhadamente, temos:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="regressao-multipla.html#cb250-1" tabindex="-1"></a><span class="fu">print</span>(omega)</span></code></pre></div>
<pre><code>##           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]
##  [1,] 133.0395   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000
##  [2,]   0.0000 133.0395   0.0000   0.0000   0.0000   0.0000   0.0000
##  [3,]   0.0000   0.0000 133.0395   0.0000   0.0000   0.0000   0.0000
##  [4,]   0.0000   0.0000   0.0000 133.0395   0.0000   0.0000   0.0000
##  [5,]   0.0000   0.0000   0.0000   0.0000 133.0395   0.0000   0.0000
##  [6,]   0.0000   0.0000   0.0000   0.0000   0.0000 133.0395   0.0000
##  [7,]   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000 133.0395
##  [8,]   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000
##  [9,]   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000
## [10,]   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000
##           [,8]     [,9]    [,10]
##  [1,]   0.0000   0.0000   0.0000
##  [2,]   0.0000   0.0000   0.0000
##  [3,]   0.0000   0.0000   0.0000
##  [4,]   0.0000   0.0000   0.0000
##  [5,]   0.0000   0.0000   0.0000
##  [6,]   0.0000   0.0000   0.0000
##  [7,]   0.0000   0.0000   0.0000
##  [8,] 133.0395   0.0000   0.0000
##  [9,]   0.0000 133.0395   0.0000
## [10,]   0.0000   0.0000 133.0395</code></pre>
<p>Como falamos, é uma matriz de variância constante (homocedástica).
Em nosso “toy model”, contudo, não faz sentido assumir que a variância é constante. É provável que os dois “outliers” tenham vindo de uma distribuição com variância bem maior. E isso levaria a um erro padrão maior para a o coeficiente da variável <span class="math inline">\(x\)</span>.</p>
<p>A questão então é como calcular essas variância diferente para esse pontos. Há inúmeras maneiras de fazer isso. A default do Stata, chamada de “HC1”, em que “HC” quer dizer “Heteroscedasticity-Consistent”. A fórmular para o erro padrão robusto “HC1” é a seguinte:
<span class="math display">\[
\frac{n}{n-k}\hat{e}^2
\]</span>
em que <span class="math inline">\(\hat{e}^2\)</span> é o quadrado dos resíduos e <span class="math inline">\(k\)</span> o número de parâmetros. Em nosso modelo simples, <span class="math inline">\(k=2\)</span>. E substituirmos a variância constante por essa fórmula em nossa “carne”, temos:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="regressao-multipla.html#cb252-1" tabindex="-1"></a>sigma2_hc1 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(n<span class="sc">/</span>(n<span class="dv">-2</span>))</span>
<span id="cb252-2"><a href="regressao-multipla.html#cb252-2" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sigma2_hc1<span class="sc">*</span>mat_I</span>
<span id="cb252-3"><a href="regressao-multipla.html#cb252-3" tabindex="-1"></a>bread <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb252-4"><a href="regressao-multipla.html#cb252-4" tabindex="-1"></a>meat <span class="ot">&lt;-</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> omega <span class="sc">%*%</span> X)</span>
<span id="cb252-5"><a href="regressao-multipla.html#cb252-5" tabindex="-1"></a>vce <span class="ot">&lt;-</span> bread <span class="sc">%*%</span> meat <span class="sc">%*%</span> bread</span>
<span id="cb252-6"><a href="regressao-multipla.html#cb252-6" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(vce))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##    5.863432    0.992626</code></pre>
<p>Vemos que o erro-padrão robusto é maior que o anterior, mas a associação ainda é significativa. O erro padrão robusto do pacote do R “sandwich” usa o “HC3”, que possui outra fórmula, e tem desempenho melhor em amostras pequenas. Sua fórmula é:</p>
<p><span class="math display">\[
\frac{\hat{e}^2}{(1-h_i)^2}
\]</span>
Aqui, <span class="math inline">\(h_i\)</span> são os valores chapéus da matriz chapéu, <span class="math inline">\(H\)</span>, que vimos antes. Os valores chpéus variam entre <span class="math inline">\(0\)</span> e <span class="math inline">\(1\)</span> e quanto maior o número, mais influente a observação. Então, sabemos que nossos dois últimos números terão valores chapéu maiores, ou seja, vão inflar a variância para esses dois valores. No R, podemos calcular os valores chapéus com a função “hatvalues”.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="regressao-multipla.html#cb254-1" tabindex="-1"></a>sigma2_hc3 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">hatvalues</span>(fit))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb254-2"><a href="regressao-multipla.html#cb254-2" tabindex="-1"></a>omega <span class="ot">&lt;-</span> sigma2_hc3<span class="sc">*</span>mat_I</span>
<span id="cb254-3"><a href="regressao-multipla.html#cb254-3" tabindex="-1"></a>bread <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb254-4"><a href="regressao-multipla.html#cb254-4" tabindex="-1"></a>meat <span class="ot">&lt;-</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> omega <span class="sc">%*%</span> X)</span>
<span id="cb254-5"><a href="regressao-multipla.html#cb254-5" tabindex="-1"></a>vce <span class="ot">&lt;-</span> bread <span class="sc">%*%</span> meat <span class="sc">%*%</span> bread</span>
<span id="cb254-6"><a href="regressao-multipla.html#cb254-6" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(vce))</span></code></pre></div>
<pre><code>## (Intercept)           x 
##    9.541330    1.917635</code></pre>
<p>E posso calcular o intervalo de confiança com o novo erro padrão. Obviamente, não iremos fazer na “mão” esse cálculo todo. Vamos usar os pacotes “sandwich” e “lmtest” para fazer o teste de hipótese com erro padrão robusto.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="regressao-multipla.html#cb256-1" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb256-2"><a href="regressao-multipla.html#cb256-2" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb256-3"><a href="regressao-multipla.html#cb256-3" tabindex="-1"></a><span class="fu">coeftest</span>(fit, <span class="fu">vcovHC</span>(fit, <span class="st">&quot;HC3&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -11.0831     9.5413 -1.1616  0.27889  
## x             4.2401     1.9176  2.2111  0.05798 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Vemos, portanto, que nosso erro padrão é robusto a observações muito influentes que são “outliers”. Uma forma de verificar se temos esse problema é ver se temos resíduos grandes e observações muito influentes (valores chapéu altos). Um comando básico do R permite inspecionar visualmente se é o caso. Pontos nos cantos direitos superiores ou inferiores indica observações exibindo influência em nosso modelo.</p>
<p>Resíduos grandes (ou variância não constante) pode decorrer de um modelo mal-especificado (preditor ausente, ausência de interação, efeitos não lineares etc.).</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="regressao-multipla.html#cb258-1" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">which =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/high-leverage-1.png" width="900" style="display: block; margin: auto;" /></p>
<p>Como mencionado, há vários tipos de erros padrão robustos, “HC0”, “HC1”, “HC2”, “HC3”, entre outros. Vamos falar rapidamente sobre cada uma deles. Antes disso, vamos comparar para nossa regressão como o erro padrão muda para cada um desses tipos.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="regressao-multipla.html#cb259-1" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb259-2"><a href="regressao-multipla.html#cb259-2" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb259-3"><a href="regressao-multipla.html#cb259-3" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb259-4"><a href="regressao-multipla.html#cb259-4" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(reg1, <span class="fu">vcovHC</span>(reg1, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb259-5"><a href="regressao-multipla.html#cb259-5" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(reg1, <span class="fu">vcovHC</span>(reg1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span>
<span id="cb259-6"><a href="regressao-multipla.html#cb259-6" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(reg1, <span class="fu">vcovHC</span>(reg1, <span class="at">type =</span> <span class="st">&quot;HC2&quot;</span>))</span>
<span id="cb259-7"><a href="regressao-multipla.html#cb259-7" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(reg1, <span class="fu">vcovHC</span>(reg1, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>))</span>
<span id="cb259-8"><a href="regressao-multipla.html#cb259-8" tabindex="-1"></a><span class="fu">stargazer</span>(reg1, </span>
<span id="cb259-9"><a href="regressao-multipla.html#cb259-9" tabindex="-1"></a>          m2,</span>
<span id="cb259-10"><a href="regressao-multipla.html#cb259-10" tabindex="-1"></a>          m3,</span>
<span id="cb259-11"><a href="regressao-multipla.html#cb259-11" tabindex="-1"></a>          m4,</span>
<span id="cb259-12"><a href="regressao-multipla.html#cb259-12" tabindex="-1"></a>          m5, <span class="at">type =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
percentual_2t_17
</td>
<td colspan="4">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>OLS</em>
</td>
<td colspan="4">
<em>coefficient</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em></em>
</td>
<td colspan="4">
<em>test</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
percentual_1t_17
</td>
<td>
0.778<sup>***</sup>
</td>
<td>
0.778<sup>***</sup>
</td>
<td>
0.778<sup>***</sup>
</td>
<td>
0.778<sup>***</sup>
</td>
<td>
0.778<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.010)
</td>
<td>
(0.010)
</td>
<td>
(0.010)
</td>
<td>
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
percentual_1t_13
</td>
<td>
-0.277<sup>***</sup>
</td>
<td>
-0.277<sup>***</sup>
</td>
<td>
-0.277<sup>***</sup>
</td>
<td>
-0.277<sup>***</sup>
</td>
<td>
-0.277<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufAL
</td>
<td>
-0.101<sup>***</sup>
</td>
<td>
-0.101<sup>***</sup>
</td>
<td>
-0.101<sup>***</sup>
</td>
<td>
-0.101<sup>***</sup>
</td>
<td>
-0.101<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufAM
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufAP
</td>
<td>
-0.087<sup>***</sup>
</td>
<td>
-0.087<sup>***</sup>
</td>
<td>
-0.087<sup>***</sup>
</td>
<td>
-0.087<sup>***</sup>
</td>
<td>
-0.087<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufBA
</td>
<td>
-0.086<sup>***</sup>
</td>
<td>
-0.086<sup>***</sup>
</td>
<td>
-0.086<sup>***</sup>
</td>
<td>
-0.086<sup>***</sup>
</td>
<td>
-0.086<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufCE
</td>
<td>
-0.151<sup>***</sup>
</td>
<td>
-0.151<sup>***</sup>
</td>
<td>
-0.151<sup>***</sup>
</td>
<td>
-0.151<sup>***</sup>
</td>
<td>
-0.151<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufDF
</td>
<td>
-0.077<sup>***</sup>
</td>
<td>
-0.077<sup>***</sup>
</td>
<td>
-0.077<sup>***</sup>
</td>
<td>
-0.077<sup>***</sup>
</td>
<td>
-0.077<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufES
</td>
<td>
-0.080<sup>***</sup>
</td>
<td>
-0.080<sup>***</sup>
</td>
<td>
-0.080<sup>***</sup>
</td>
<td>
-0.080<sup>***</sup>
</td>
<td>
-0.080<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufGO
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufMA
</td>
<td>
-0.105<sup>***</sup>
</td>
<td>
-0.105<sup>***</sup>
</td>
<td>
-0.105<sup>***</sup>
</td>
<td>
-0.105<sup>***</sup>
</td>
<td>
-0.105<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufMG
</td>
<td>
-0.065<sup>***</sup>
</td>
<td>
-0.065<sup>***</sup>
</td>
<td>
-0.065<sup>***</sup>
</td>
<td>
-0.065<sup>***</sup>
</td>
<td>
-0.065<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufMS
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufMT
</td>
<td>
-0.089<sup>***</sup>
</td>
<td>
-0.089<sup>***</sup>
</td>
<td>
-0.089<sup>***</sup>
</td>
<td>
-0.089<sup>***</sup>
</td>
<td>
-0.089<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufPA
</td>
<td>
-0.071<sup>***</sup>
</td>
<td>
-0.071<sup>***</sup>
</td>
<td>
-0.071<sup>***</sup>
</td>
<td>
-0.071<sup>***</sup>
</td>
<td>
-0.071<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufPB
</td>
<td>
-0.119<sup>***</sup>
</td>
<td>
-0.119<sup>***</sup>
</td>
<td>
-0.119<sup>***</sup>
</td>
<td>
-0.119<sup>***</sup>
</td>
<td>
-0.119<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufPE
</td>
<td>
-0.113<sup>***</sup>
</td>
<td>
-0.113<sup>***</sup>
</td>
<td>
-0.113<sup>***</sup>
</td>
<td>
-0.113<sup>***</sup>
</td>
<td>
-0.113<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufPI
</td>
<td>
-0.091<sup>***</sup>
</td>
<td>
-0.091<sup>***</sup>
</td>
<td>
-0.091<sup>***</sup>
</td>
<td>
-0.091<sup>***</sup>
</td>
<td>
-0.091<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufPR
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufRJ
</td>
<td>
-0.097<sup>***</sup>
</td>
<td>
-0.097<sup>***</sup>
</td>
<td>
-0.097<sup>***</sup>
</td>
<td>
-0.097<sup>***</sup>
</td>
<td>
-0.097<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufRN
</td>
<td>
-0.112<sup>***</sup>
</td>
<td>
-0.112<sup>***</sup>
</td>
<td>
-0.112<sup>***</sup>
</td>
<td>
-0.112<sup>***</sup>
</td>
<td>
-0.112<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufRO
</td>
<td>
-0.060<sup>***</sup>
</td>
<td>
-0.060<sup>***</sup>
</td>
<td>
-0.060<sup>***</sup>
</td>
<td>
-0.060<sup>***</sup>
</td>
<td>
-0.060<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufRR
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
<td>
-0.085<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.008)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufRS
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
<td>
-0.061<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufSC
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
<td>
-0.062<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufSE
</td>
<td>
-0.094<sup>***</sup>
</td>
<td>
-0.094<sup>***</sup>
</td>
<td>
-0.094<sup>***</sup>
</td>
<td>
-0.094<sup>***</sup>
</td>
<td>
-0.094<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.008)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufSP
</td>
<td>
-0.039<sup>***</sup>
</td>
<td>
-0.039<sup>***</sup>
</td>
<td>
-0.039<sup>***</sup>
</td>
<td>
-0.039<sup>***</sup>
</td>
<td>
-0.039<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufTO
</td>
<td>
-0.096<sup>***</sup>
</td>
<td>
-0.096<sup>***</sup>
</td>
<td>
-0.096<sup>***</sup>
</td>
<td>
-0.096<sup>***</sup>
</td>
<td>
-0.096<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sg_ufZZ
</td>
<td>
-0.082<sup>***</sup>
</td>
<td>
-0.082<sup>***</sup>
</td>
<td>
-0.082<sup>***</sup>
</td>
<td>
-0.082<sup>***</sup>
</td>
<td>
-0.082<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.009)
</td>
<td>
(0.009)
</td>
<td>
(0.009)
</td>
<td>
(0.009)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.356<sup>***</sup>
</td>
<td>
0.356<sup>***</sup>
</td>
<td>
0.356<sup>***</sup>
</td>
<td>
0.356<sup>***</sup>
</td>
<td>
0.356<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.006)
</td>
<td>
(0.010)
</td>
<td>
(0.010)
</td>
<td>
(0.011)
</td>
<td>
(0.011)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
6,239
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.992
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.992
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.020 (df = 6209)
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
25,882.990<sup>***</sup> (df = 29; 6209)
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="5" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="regressao-multipla.html#cb260-1" tabindex="-1"></a><span class="co"># conf int</span></span>
<span id="cb260-2"><a href="regressao-multipla.html#cb260-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb260-3"><a href="regressao-multipla.html#cb260-3" tabindex="-1"></a><span class="fu">coefci</span>(reg1, <span class="at">vcov. =</span> <span class="fu">vcovHC</span>(reg1, <span class="at">type =</span> <span class="st">&#39;HC1&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb260-4"><a href="regressao-multipla.html#cb260-4" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code></pre></div>
<pre><code>## Warning in attr(x, &quot;align&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<pre><code>## Warning in attr(x, &quot;format&quot;): &#39;xfun::attr()&#39; is deprecated.
## Use &#39;xfun::attr2()&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.3350033</td>
<td align="right">0.3760590</td>
</tr>
<tr class="even">
<td align="left">percentual_1t_17</td>
<td align="right">0.7583797</td>
<td align="right">0.7972015</td>
</tr>
<tr class="odd">
<td align="left">percentual_1t_13</td>
<td align="right">-0.2936573</td>
<td align="right">-0.2610519</td>
</tr>
<tr class="even">
<td align="left">sg_ufAL</td>
<td align="right">-0.1151015</td>
<td align="right">-0.0872385</td>
</tr>
<tr class="odd">
<td align="left">sg_ufAM</td>
<td align="right">-0.0986993</td>
<td align="right">-0.0707314</td>
</tr>
<tr class="even">
<td align="left">sg_ufAP</td>
<td align="right">-0.1026175</td>
<td align="right">-0.0715529</td>
</tr>
<tr class="odd">
<td align="left">sg_ufBA</td>
<td align="right">-0.1003028</td>
<td align="right">-0.0724807</td>
</tr>
<tr class="even">
<td align="left">sg_ufCE</td>
<td align="right">-0.1662120</td>
<td align="right">-0.1354263</td>
</tr>
<tr class="odd">
<td align="left">sg_ufDF</td>
<td align="right">-0.0915291</td>
<td align="right">-0.0632155</td>
</tr>
<tr class="even">
<td align="left">sg_ufES</td>
<td align="right">-0.0937037</td>
<td align="right">-0.0658873</td>
</tr>
<tr class="odd">
<td align="left">sg_ufGO</td>
<td align="right">-0.0991474</td>
<td align="right">-0.0716567</td>
</tr>
<tr class="even">
<td align="left">sg_ufMA</td>
<td align="right">-0.1192041</td>
<td align="right">-0.0914571</td>
</tr>
<tr class="odd">
<td align="left">sg_ufMG</td>
<td align="right">-0.0792045</td>
<td align="right">-0.0516851</td>
</tr>
<tr class="even">
<td align="left">sg_ufMS</td>
<td align="right">-0.0757868</td>
<td align="right">-0.0480581</td>
</tr>
<tr class="odd">
<td align="left">sg_ufMT</td>
<td align="right">-0.1024452</td>
<td align="right">-0.0747959</td>
</tr>
<tr class="even">
<td align="left">sg_ufPA</td>
<td align="right">-0.0851832</td>
<td align="right">-0.0573345</td>
</tr>
<tr class="odd">
<td align="left">sg_ufPB</td>
<td align="right">-0.1332370</td>
<td align="right">-0.1051214</td>
</tr>
<tr class="even">
<td align="left">sg_ufPE</td>
<td align="right">-0.1273447</td>
<td align="right">-0.0994480</td>
</tr>
<tr class="odd">
<td align="left">sg_ufPI</td>
<td align="right">-0.1054809</td>
<td align="right">-0.0773482</td>
</tr>
<tr class="even">
<td align="left">sg_ufPR</td>
<td align="right">-0.0743198</td>
<td align="right">-0.0468815</td>
</tr>
<tr class="odd">
<td align="left">sg_ufRJ</td>
<td align="right">-0.1104185</td>
<td align="right">-0.0828524</td>
</tr>
<tr class="even">
<td align="left">sg_ufRN</td>
<td align="right">-0.1266669</td>
<td align="right">-0.0978309</td>
</tr>
<tr class="odd">
<td align="left">sg_ufRO</td>
<td align="right">-0.0735371</td>
<td align="right">-0.0456145</td>
</tr>
<tr class="even">
<td align="left">sg_ufRR</td>
<td align="right">-0.0999596</td>
<td align="right">-0.0706939</td>
</tr>
<tr class="odd">
<td align="left">sg_ufRS</td>
<td align="right">-0.0748960</td>
<td align="right">-0.0474614</td>
</tr>
<tr class="even">
<td align="left">sg_ufSC</td>
<td align="right">-0.0752199</td>
<td align="right">-0.0478245</td>
</tr>
<tr class="odd">
<td align="left">sg_ufSE</td>
<td align="right">-0.1085156</td>
<td align="right">-0.0799776</td>
</tr>
<tr class="even">
<td align="left">sg_ufSP</td>
<td align="right">-0.0531533</td>
<td align="right">-0.0256020</td>
</tr>
<tr class="odd">
<td align="left">sg_ufTO</td>
<td align="right">-0.1098511</td>
<td align="right">-0.0820642</td>
</tr>
<tr class="even">
<td align="left">sg_ufZZ</td>
<td align="right">-0.0987445</td>
<td align="right">-0.0643491</td>
</tr>
</tbody>
</table>
<div id="entendendo-o-erro-padrão-robusto" class="section level3 hasAnchor" number="12.8.1">
<h3><span class="header-section-number">12.8.1</span> Entendendo o erro padrão robusto<a href="#entendendo-o-erro-padr%C3%A3o-robusto" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos fazer uma simulação no R para entender os vários tipos de erro padrão robusto. Vamos criar um modelo com heterocedasticidade.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="regressao-multipla.html#cb263-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb263-2"><a href="regressao-multipla.html#cb263-2" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, x<span class="sc">^</span><span class="dv">2</span>) <span class="co"># o DP do erro é igual a .5*x^2</span></span>
<span id="cb263-3"><a href="regressao-multipla.html#cb263-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb263-4"><a href="regressao-multipla.html#cb263-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb263-5"><a href="regressao-multipla.html#cb263-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>x <span class="sc">+</span> e</span>
<span id="cb263-6"><a href="regressao-multipla.html#cb263-6" tabindex="-1"></a></span>
<span id="cb263-7"><a href="regressao-multipla.html#cb263-7" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y, <span class="at">x=</span>x)</span>
<span id="cb263-8"><a href="regressao-multipla.html#cb263-8" tabindex="-1"></a></span>
<span id="cb263-9"><a href="regressao-multipla.html#cb263-9" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb263-10"><a href="regressao-multipla.html#cb263-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>y, <span class="at">x=</span>x)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/robust-se-sim-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="regressao-multipla.html#cb265-1" tabindex="-1"></a>m_sim <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data=</span>df)</span>
<span id="cb265-2"><a href="regressao-multipla.html#cb265-2" tabindex="-1"></a><span class="co"># plots de checagem do modelo</span></span>
<span id="cb265-3"><a href="regressao-multipla.html#cb265-3" tabindex="-1"></a><span class="fu">library</span>(easystats)</span></code></pre></div>
<pre><code>## # Attaching packages: easystats 0.7.4 (red = needs update)
## ✖ bayestestR  0.16.0   ✖ correlation 0.8.7 
## ✖ datawizard  1.1.0    ✖ effectsize  1.0.0 
## ✖ insight     1.3.0    ✖ modelbased  0.11.2
## ✖ performance 0.13.0   ✖ parameters  0.26.0
## ✔ report      0.6.1    ✖ see         0.11.0
## 
## Restart the R-Session and update packages with `easystats::easystats_update()`.</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="regressao-multipla.html#cb267-1" tabindex="-1"></a><span class="fu">check_model</span>(m_sim)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/robust-se-sim-2.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="regressao-multipla.html#cb268-1" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(m_sim, <span class="fu">vcovHC</span>(m_sim, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>))</span>
<span id="cb268-2"><a href="regressao-multipla.html#cb268-2" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(m_sim, <span class="fu">vcovHC</span>(m_sim, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span>
<span id="cb268-3"><a href="regressao-multipla.html#cb268-3" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(m_sim, <span class="fu">vcovHC</span>(m_sim, <span class="at">type =</span> <span class="st">&quot;HC2&quot;</span>))</span>
<span id="cb268-4"><a href="regressao-multipla.html#cb268-4" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(m_sim, <span class="fu">vcovHC</span>(m_sim, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>))</span>
<span id="cb268-5"><a href="regressao-multipla.html#cb268-5" tabindex="-1"></a><span class="fu">stargazer</span>(m_sim, </span>
<span id="cb268-6"><a href="regressao-multipla.html#cb268-6" tabindex="-1"></a>          f2,</span>
<span id="cb268-7"><a href="regressao-multipla.html#cb268-7" tabindex="-1"></a>          f3,</span>
<span id="cb268-8"><a href="regressao-multipla.html#cb268-8" tabindex="-1"></a>          f4,</span>
<span id="cb268-9"><a href="regressao-multipla.html#cb268-9" tabindex="-1"></a>          f5, <span class="at">type =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
y
</td>
<td colspan="4">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>OLS</em>
</td>
<td colspan="4">
<em>coefficient</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em></em>
</td>
<td colspan="4">
<em>test</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
x
</td>
<td>
-3.230<sup>***</sup>
</td>
<td>
-3.230<sup>***</sup>
</td>
<td>
-3.230<sup>***</sup>
</td>
<td>
-3.230<sup>***</sup>
</td>
<td>
-3.230<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.402)
</td>
<td>
(0.529)
</td>
<td>
(0.591)
</td>
<td>
(0.696)
</td>
<td>
(0.923)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
1.455<sup>***</sup>
</td>
<td>
1.455<sup>***</sup>
</td>
<td>
1.455<sup>***</sup>
</td>
<td>
1.455<sup>***</sup>
</td>
<td>
1.455<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.403)
</td>
<td>
(0.341)
</td>
<td>
(0.381)
</td>
<td>
(0.424)
</td>
<td>
(0.538)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
10
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.890
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.876
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.272 (df = 8)
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
64.688<sup>***</sup> (df = 1; 8)
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="5" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="regressao-multipla.html#cb269-1" tabindex="-1"></a><span class="co"># dados de 2022</span></span>
<span id="cb269-2"><a href="regressao-multipla.html#cb269-2" tabindex="-1"></a></span>
<span id="cb269-3"><a href="regressao-multipla.html#cb269-3" tabindex="-1"></a><span class="co">#read  into data frame</span></span>
<span id="cb269-4"><a href="regressao-multipla.html#cb269-4" tabindex="-1"></a>presid_22 <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="fu">here</span>(<span class="st">&quot;dados&quot;</span>,<span class="st">&quot;votacao_secao_2022_BR.csv&quot;</span>), <span class="at">encoding =</span> <span class="st">&quot;Latin-1&quot;</span>)</span>
<span id="cb269-5"><a href="regressao-multipla.html#cb269-5" tabindex="-1"></a></span>
<span id="cb269-6"><a href="regressao-multipla.html#cb269-6" tabindex="-1"></a>df_resultados_22_aux <span class="ot">&lt;-</span> presid_22 <span class="sc">%&gt;%</span></span>
<span id="cb269-7"><a href="regressao-multipla.html#cb269-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>NR_VOTAVEL <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">95</span>,<span class="dv">96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb269-8"><a href="regressao-multipla.html#cb269-8" tabindex="-1"></a>  <span class="fu">group_by</span>(NR_ZONA, CD_MUNICIPIO, SG_UF, NR_VOTAVEL, NR_TURNO) <span class="sc">%&gt;%</span></span>
<span id="cb269-9"><a href="regressao-multipla.html#cb269-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_votos =</span> <span class="fu">sum</span>(QT_VOTOS)) <span class="sc">%&gt;%</span></span>
<span id="cb269-10"><a href="regressao-multipla.html#cb269-10" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> NR_TURNO, <span class="at">values_from =</span> total_votos, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb269-11"><a href="regressao-multipla.html#cb269-11" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb269-12"><a href="regressao-multipla.html#cb269-12" tabindex="-1"></a>  <span class="fu">group_by</span>(nr_zona, cd_municipio, sg_uf) <span class="sc">%&gt;%</span></span>
<span id="cb269-13"><a href="regressao-multipla.html#cb269-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_validos_1t =</span> <span class="fu">sum</span>(x1),</span>
<span id="cb269-14"><a href="regressao-multipla.html#cb269-14" tabindex="-1"></a>         <span class="at">total_validos_2t =</span> <span class="fu">sum</span>(x2)) <span class="sc">%&gt;%</span></span>
<span id="cb269-15"><a href="regressao-multipla.html#cb269-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(nr_votavel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">22</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb269-16"><a href="regressao-multipla.html#cb269-16" tabindex="-1"></a>  <span class="fu">group_by</span>(nr_votavel) <span class="sc">%&gt;%</span></span>
<span id="cb269-17"><a href="regressao-multipla.html#cb269-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentual_1t =</span> x1<span class="sc">/</span>total_validos_1t,</span>
<span id="cb269-18"><a href="regressao-multipla.html#cb269-18" tabindex="-1"></a>         <span class="at">percentual_2t =</span> x2<span class="sc">/</span>total_validos_2t) <span class="sc">%&gt;%</span></span>
<span id="cb269-19"><a href="regressao-multipla.html#cb269-19" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb269-20"><a href="regressao-multipla.html#cb269-20" tabindex="-1"></a></span>
<span id="cb269-21"><a href="regressao-multipla.html#cb269-21" tabindex="-1"></a>df_resultados_22 <span class="ot">&lt;-</span> df_resultados_22_aux<span class="sc">%&gt;%</span></span>
<span id="cb269-22"><a href="regressao-multipla.html#cb269-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(x1, x2, total_validos_1t, total_validos_2t)) <span class="sc">%&gt;%</span></span>
<span id="cb269-23"><a href="regressao-multipla.html#cb269-23" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> nr_votavel, </span>
<span id="cb269-24"><a href="regressao-multipla.html#cb269-24" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(percentual_1t, percentual_2t)) <span class="sc">%&gt;%</span></span>
<span id="cb269-25"><a href="regressao-multipla.html#cb269-25" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">percentual_1t_17 =</span> percentual_1t_22,</span>
<span id="cb269-26"><a href="regressao-multipla.html#cb269-26" tabindex="-1"></a>         <span class="at">percentual_2t_17 =</span> percentual_2t_22)</span></code></pre></div>
<p>Agora que importamos os dados de 22, podemos fazer nossa previsão, usando os resultados do primeiro turno.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="regressao-multipla.html#cb270-1" tabindex="-1"></a>df_resultados_22_aux1 <span class="ot">&lt;-</span> df_resultados_22_aux <span class="sc">%&gt;%</span></span>
<span id="cb270-2"><a href="regressao-multipla.html#cb270-2" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb270-3"><a href="regressao-multipla.html#cb270-3" tabindex="-1"></a>  <span class="fu">group_by</span>(nr_zona, cd_municipio, sg_uf) <span class="sc">%&gt;%</span></span>
<span id="cb270-4"><a href="regressao-multipla.html#cb270-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_validos_1t =</span> <span class="fu">sum</span>(total_validos_1t))</span>
<span id="cb270-5"><a href="regressao-multipla.html#cb270-5" tabindex="-1"></a>  </span>
<span id="cb270-6"><a href="regressao-multipla.html#cb270-6" tabindex="-1"></a><span class="co">#Previsão</span></span>
<span id="cb270-7"><a href="regressao-multipla.html#cb270-7" tabindex="-1"></a>  </span>
<span id="cb270-8"><a href="regressao-multipla.html#cb270-8" tabindex="-1"></a>previsoes <span class="ot">&lt;-</span> <span class="fu">predict</span>(reg1, <span class="at">newdata =</span> df_resultados_22, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="at">level =</span> .<span class="dv">95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-9"><a href="regressao-multipla.html#cb270-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb270-10"><a href="regressao-multipla.html#cb270-10" tabindex="-1"></a></span>
<span id="cb270-11"><a href="regressao-multipla.html#cb270-11" tabindex="-1"></a>df_resultados_22_final <span class="ot">&lt;-</span> df_resultados_22 <span class="sc">%&gt;%</span></span>
<span id="cb270-12"><a href="regressao-multipla.html#cb270-12" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb270-13"><a href="regressao-multipla.html#cb270-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prev_perc =</span> previsoes<span class="sc">$</span>fit,</span>
<span id="cb270-14"><a href="regressao-multipla.html#cb270-14" tabindex="-1"></a>         <span class="at">prev_perc_lower =</span> previsoes<span class="sc">$</span>lwr,</span>
<span id="cb270-15"><a href="regressao-multipla.html#cb270-15" tabindex="-1"></a>         <span class="at">prev_perc_upper =</span> previsoes<span class="sc">$</span>upr,</span>
<span id="cb270-16"><a href="regressao-multipla.html#cb270-16" tabindex="-1"></a>         <span class="at">validos_prev =</span> df_resultados_22_aux1<span class="sc">$</span>total_validos_1t<span class="sc">*</span>prev_perc,</span>
<span id="cb270-17"><a href="regressao-multipla.html#cb270-17" tabindex="-1"></a>         <span class="at">validos_prev_lower =</span> df_resultados_22_aux1<span class="sc">$</span>total_validos_1t<span class="sc">*</span>prev_perc_lower,</span>
<span id="cb270-18"><a href="regressao-multipla.html#cb270-18" tabindex="-1"></a>         <span class="at">validos_prev_upper =</span> df_resultados_22_aux1<span class="sc">$</span>total_validos_1t<span class="sc">*</span>prev_perc_upper)</span>
<span id="cb270-19"><a href="regressao-multipla.html#cb270-19" tabindex="-1"></a></span>
<span id="cb270-20"><a href="regressao-multipla.html#cb270-20" tabindex="-1"></a>tot_valido <span class="ot">&lt;-</span> <span class="fu">sum</span>(df_resultados_22_aux1<span class="sc">$</span>total_validos_1t)</span>
<span id="cb270-21"><a href="regressao-multipla.html#cb270-21" tabindex="-1"></a>df_resultados_22_final <span class="sc">%&gt;%</span></span>
<span id="cb270-22"><a href="regressao-multipla.html#cb270-22" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">perc_previsto =</span> <span class="fu">sum</span>(validos_prev,<span class="at">na.rm =</span> T)<span class="sc">/</span>tot_valido,</span>
<span id="cb270-23"><a href="regressao-multipla.html#cb270-23" tabindex="-1"></a>            <span class="at">perc_previsto_lower =</span> <span class="fu">sum</span>(validos_prev_lower,<span class="at">na.rm =</span> T)<span class="sc">/</span>tot_valido,</span>
<span id="cb270-24"><a href="regressao-multipla.html#cb270-24" tabindex="-1"></a>            <span class="at">perc_previsto_upper =</span> <span class="fu">sum</span>(validos_prev_upper,<span class="at">na.rm =</span> T)<span class="sc">/</span>tot_valido)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   perc_previsto perc_previsto_lower perc_previsto_upper
##           &lt;dbl&gt;               &lt;dbl&gt;               &lt;dbl&gt;
## 1         0.481               0.442               0.521</code></pre>
</div>
</div>
<div id="termo-de-interação" class="section level2 hasAnchor" number="12.9">
<h2><span class="header-section-number">12.9</span> Termo de interação<a href="#termo-de-intera%C3%A7%C3%A3o" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No trabalho de Corrêa (2015), o autor estima um modelo para explicar o efeito do desempenho econômico (crescimento do PIB e inflação) sobre o desempenho eleitoral de candidatos governistas na América Latina. E a certa altura argumenta que o efeito do crescimento do PIB e da inflação dependem (ou variam) conforme o candidato é de esquerda, centro ou de direita. Em particular, candidatos de centro seriam mais afetados por essas variáveis. Vamos simplificar aqui e considerar apenas uma variável econômica (crescimento) e tratar a variável ideologia do presidente como binária (centro ou não).</p>
<p>Nesse caso, dizemos que o modelo contém um termo interativo, do seguinte modo:</p>
<p><span class="math display">\[
y_i = \alpha + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \beta_3 \cdot x_1 \cdot x_2 + e_i
\]</span>
Nesse tipo de modelo, o efeito de <span class="math inline">\(x_1\)</span> depende do valor de <span class="math inline">\(x_2\)</span> (e vice-versa). Isso significa que temos que mudar nossa interpretação do significado dos parâmetros.</p>
<p>Agora, <span class="math inline">\(\beta_1\)</span> mede o efeito no <span class="math inline">\(y\)</span> médio de aumentar uma unidade <span class="math inline">\(x_1\)</span> quando <span class="math inline">\(x_2 = 0\)</span>. Para ver isso, podemos substiruir <span class="math inline">\(x_2 = 0\)</span> na equação acima, e temos:</p>
<p><span class="math display">\[
y_i = \alpha + \beta_1 \cdot x_1 + \beta_2 \cdot 0 + \beta_3 \cdot x_1 \cdot 0 + e_i = \alpha + \beta_1 \cdot x_1 + e_i
\]</span>
E nesse caso,</p>
<p><span class="math display">\[\begin{align}
\mathbb{E}[Y|x_1=1] - \mathbb{E}[Y|X=0] = \\
\mathbb{E}[\alpha|x_1=1] + \mathbb{E}[\beta_1 \cdot x_1|x_1=1] + \mathbb{E}[e_i|x_1=1] - (\mathbb{E}[\alpha|x_1=0] + \mathbb{E}[\beta_1 \cdot x_1|x_1=0] + \mathbb{E}[e_i|x_1=0]) \\
= \alpha + \beta_1 - \alpha = \\
\beta_1
\end{align}\]</span></p>
<p>Que é o que já estamos acostumados. Porém, considere o caso em que <span class="math inline">\(x_2 \neq 0\)</span>. <span class="math inline">\(y_i = \alpha + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \beta_3 \cdot x_1 \cdot x_2 + e_i\)</span></p>
<p>Estamos interessados em calcular: <span class="math inline">\(\mathbb{E}[Y|x_1=1] - \mathbb{E}[Y|X=0]\)</span>. Comecemos pelo primeiro termo.</p>
<p><span class="math display">\[\begin{align}
\mathbb{E}[Y|x_1=1] = \\
\mathbb{E}[\alpha|x_1=1] + \mathbb{E}[\beta_1 \cdot 1|x_1=1] +
\mathbb{E}[\beta_2 \cdot x_2|x_1=1] + \mathbb{E}[\beta_3 \cdot 1 \cdot x_2|x_1=1] + \mathbb{E}[e_i|x_1=1] \\
= \alpha + 1\beta_1  + \beta_2\mathbb{E}[x_2|x_1=1] + \beta_3\mathbb{E}[x_2|x_1=1] + 0 \\
= \alpha + \beta_1 + (\beta_2+\beta_3)\mathbb{E}[x_2|x_1=1]
\end{align}\]</span></p>
<p>Já o segundo termo, fica:
<span class="math display">\[\begin{align}
\mathbb{E}[Y|x_1=0] = \\
\mathbb{E}[\alpha|x_1=0] + \mathbb{E}[\beta_1 \cdot 0|x_1=0] +
\mathbb{E}[\beta_2 \cdot x_2|x_1=0] + \mathbb{E}[\beta_3 \cdot 0 \cdot x_2|x_1=0] + \mathbb{E}[e_i|x_1=0] \\
= \alpha + 0\beta_1  + \beta_2\mathbb{E}[x_2|x_1=0] + 0\mathbb{E}[x_2|x_1=1] + 0 \\
= \alpha + \beta_2 \mathbb{E}[x_2|x_1=0]
\end{align}\]</span></p>
<p>Computando a diferença, temos:
<span class="math display">\[\begin{align}
\mathbb{E}[Y|x_1=1] - \mathbb{E}[Y|x_1=0] = \\
\alpha + \beta_1 + (\beta_2+\beta_3)\mathbb{E}[x_2|x_1=1] -\alpha - \beta_2\mathbb{E}[x_2|x_1=0] \\
= \beta_1 + (\beta_2+\beta_3)\mathbb{E}[x_2|x_1=1] - \beta_2\mathbb{E}[x_2|x_1=0]
\end{align}\]</span></p>
<p>Se <span class="math inline">\(x_1\)</span> e <span class="math inline">\(x_2\)</span> forem independentes na média, então: <span class="math inline">\(\mathbb{E}[x_2|x_1=1] = \mathbb{E}[x_2|x_1=0]\)</span>, de forma que a equação acima simplifica para:</p>
<p><span class="math display">\[\begin{align}
\mathbb{E}[Y|x_1=1] - \mathbb{E}[Y|x_1=0] = \beta_1 + \beta_3\mathbb{E}[x_2|x_1=1]
\end{align}\]</span></p>
<p>Portanto, a interpretação do que é o efeito marignal ou preditivo Em um modelo com termo de interação é mais complexa do que em uma regressão sem termo de interação.</p>
<div id="variância-do-termo-de-interação" class="section level3 hasAnchor" number="12.9.1">
<h3><span class="header-section-number">12.9.1</span> Variância do termo de interação<a href="#vari%C3%A2ncia-do-termo-de-intera%C3%A7%C3%A3o" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O erro-padrão do <span class="math inline">\(\beta\)</span> é dado por: <span class="math inline">\(\mathbb{Var}[\beta|X] = \sigma^2 (X&#39;X)^{-1}\)</span>, que podemos reescrever para: <span class="math inline">\(\sigma^2(X&#39;X)^{-1} = \frac{\sigma^2}{n}n^{-1}(X&#39;X)^{-1}\)</span>.
Lebrem-se que para um único preditor, <span class="math inline">\(\mathbb{Var}[\beta|X] = \frac{\sigma^2}{nS^2_x}\)</span></p>
<p>Vejam que <span class="math inline">\(\frac{\sigma^2}{n}\)</span> é o que tínhamos antes. E <span class="math inline">\(n^{-1}(X&#39;X)^{-1}\)</span> é uma matriz de variância e covariância. Se as covariâncias forem zero, na diagonal principal temos as variâncias amostrais de cada preditor, de tal modo que:</p>
<p>Supondo que os preditores <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span> são não correlacionados, a matriz <span class="math inline">\(X&#39;X\)</span> será aproximadamente diagonal. Assim, podemos representar a matriz de variância e covariância apenas com as diagonais principais, onde cada elemento <span class="math inline">\(S_{x_j}^2\)</span> na diagonal representa a variância amostral do preditor <span class="math inline">\(X_j\)</span>. Dessa forma, temos:</p>
<p><span class="math display">\[
\mathbb{Var}[\hat{\beta} \mid X] = \frac{\sigma^2}{n}
\begin{bmatrix}
\frac{1}{S_{x_1}^2} &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \frac{1}{S_{x_2}^2} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \frac{1}{S_{x_p}^2} \\
\end{bmatrix}.
\]</span></p>
<p>No caso de um único preditor (<span class="math inline">\(p = 1\)</span>), essa expressão se reduz para a fórmula clássica:
<span class="math display">\[
\mathbb{Var}[\hat{\beta} \mid X] = \frac{\sigma^2}{n S_x^2},
\]</span>
onde <span class="math inline">\(S_x^2\)</span> é a variância amostral do preditor <span class="math inline">\(X\)</span>. Assim, cada elemento da diagonal principal da matriz <span class="math inline">\(\mathbb{Var}[\hat{\beta} \mid X]\)</span> representa a variância de <span class="math inline">\(\hat{\beta}_j\)</span> para o preditor <span class="math inline">\(X_j\)</span>, dada por <span class="math inline">\(\frac{\sigma^2}{n S_{x_j}^2}\)</span>, generalizando a fórmula da variância para <span class="math inline">\(p\)</span> preditores.</p>
<p>Obviamente, se houver correlação entre preditores, a fórmula se torna mais complicada do que a original. No caso de termo de interação, o pressuposto é de que há correlação, então fiquemos com a fórmula matricial, que é mais simples:</p>
<p><span class="math display">\[
\mathbb{Var}[\beta|X] = \sigma^2 (X&#39;X)^{-1}
\]</span>
E em geral a variância de cada coeficiente depende dos demais. E quanto maior a covariância entre duqas variáveis, maior a variância (e portanto, maior o erro-padrão).</p>
<p>O que importa para nós aqui é na verdade o seguinte.
Sejam <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> duas variáveis aleatórias dependentes (cuja covariância não é zero). Então, <span class="math inline">\(Var(X+Y) = Var(X) + Var(Y) + 2*Cov(X,Y)\)</span>. Portanto, no caso de nosso modelo com dois regressores e termo de interação, temos:</p>
<p><span class="math display">\[
Var(\beta_1 + \beta3 x_2|X) = Var(\beta_1|X) + Var(\beta3 x_2|X) + 2Cov(\beta_1, \beta3) = Var(\beta_1|X) + x_2^2Var(\beta3|X) + 2x_2Cov(\beta_1, \beta3|X)
\]</span>
Como as variâncias são os erros-padrão ao quadrado, podemos computar manualmente a variância do efeito marginal, e depois calcular o erro-padrão. No R, porém, usualmente usamos alguns dos pacotes que permite a visualização desses efeitos já computados corretamente.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="regressao-multipla.html#cb272-1" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span></code></pre></div>
<pre><code>## Please cite the software developers who make your work possible.
## One package:             citation(&quot;package_name&quot;)
## All project packages:    softbib::softbib()</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="regressao-multipla.html#cb274-1" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb274-2"><a href="regressao-multipla.html#cb274-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb274-3"><a href="regressao-multipla.html#cb274-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb274-4"><a href="regressao-multipla.html#cb274-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb274-5"><a href="regressao-multipla.html#cb274-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size=</span><span class="dv">1</span>, <span class="at">p=</span>.<span class="dv">5</span>)</span>
<span id="cb274-6"><a href="regressao-multipla.html#cb274-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb274-7"><a href="regressao-multipla.html#cb274-7" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb274-8"><a href="regressao-multipla.html#cb274-8" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb274-9"><a href="regressao-multipla.html#cb274-9" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb274-10"><a href="regressao-multipla.html#cb274-10" tabindex="-1"></a>y <span class="ot">&lt;-</span> a<span class="sc">+</span> b1<span class="sc">*</span>x1 <span class="sc">+</span> b2<span class="sc">*</span>x2 <span class="sc">+</span> b3<span class="sc">*</span>x2<span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb274-11"><a href="regressao-multipla.html#cb274-11" tabindex="-1"></a></span>
<span id="cb274-12"><a href="regressao-multipla.html#cb274-12" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1<span class="sc">*</span>x2)</span>
<span id="cb274-13"><a href="regressao-multipla.html#cb274-13" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 * x2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4291 -0.6824 -0.1309  0.5935  3.1949 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.9987     0.1299  15.381  &lt; 2e-16 ***
## x1            1.4690     0.1482   9.910 2.32e-16 ***
## x2           -0.9273     0.1890  -4.905 3.80e-06 ***
## x1:x2         0.8029     0.2070   3.878 0.000193 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9368 on 96 degrees of freedom
## Multiple R-squared:  0.7872, Adjusted R-squared:  0.7805 
## F-statistic: 118.4 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="regressao-multipla.html#cb276-1" tabindex="-1"></a><span class="co"># Pacote marginaleffects</span></span>
<span id="cb276-2"><a href="regressao-multipla.html#cb276-2" tabindex="-1"></a><span class="fu">plot_slopes</span>(reg1, <span class="at">variables =</span> <span class="st">&quot;x1&quot;</span>, <span class="at">condition =</span> <span class="st">&quot;x2&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/interaction-term-1.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="regressao-multipla.html#cb277-1" tabindex="-1"></a><span class="co"># pacote sjPlot</span></span>
<span id="cb277-2"><a href="regressao-multipla.html#cb277-2" tabindex="-1"></a><span class="fu">plot_model</span>(reg1, <span class="at">type =</span> <span class="st">&quot;pred&quot;</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/interaction-term-2.png" width="900" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="regressao-multipla.html#cb278-1" tabindex="-1"></a><span class="co"># Truque do Mcdermont</span></span>
<span id="cb278-2"><a href="regressao-multipla.html#cb278-2" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">factor</span>(x2) <span class="sc">/</span> x1) <span class="co"># lm(y ~ x2 + x2:x1)</span></span>
<span id="cb278-3"><a href="regressao-multipla.html#cb278-3" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ factor(x2)/x1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4291 -0.6824 -0.1309  0.5935  3.1949 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      1.9987     0.1299  15.381  &lt; 2e-16 ***
## factor(x2)1     -0.9273     0.1890  -4.905 3.80e-06 ***
## factor(x2)0:x1   1.4690     0.1482   9.910 2.32e-16 ***
## factor(x2)1:x1   2.2719     0.1445  15.724  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9368 on 96 degrees of freedom
## Multiple R-squared:  0.7872, Adjusted R-squared:  0.7805 
## F-statistic: 118.4 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="calculando-o-erro-padrão-do-termo-de-interação" class="section level3 hasAnchor" number="12.9.2">
<h3><span class="header-section-number">12.9.2</span> Calculando o erro padrão do termo de interação<a href="#calculando-o-erro-padr%C3%A3o-do-termo-de-intera%C3%A7%C3%A3o" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="análise-de-sensibilidade-causal" class="section level2 hasAnchor" number="12.10">
<h2><span class="header-section-number">12.10</span> Análise de sensibilidade causal<a href="#an%C3%A1lise-de-sensibilidade-causal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Diante do problema de viés de variável omitida, podemos realizar análises de sensibilidade. Essa é uma área que em que houve bastante desenvolvimentos recentes. Apresento aqui o trabalho do Cinelli e Hazlet (2019). Antes, porém, vamos revisar o R-quadrado e derivar algumas formas de definir essa quantidade.</p>
<div id="derivação-do-r-quadrado" class="section level3 hasAnchor" number="12.10.1">
<h3><span class="header-section-number">12.10.1</span> Derivação do R-quadrado<a href="#deriva%C3%A7%C3%A3o-do-r-quadrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Será útil reescrever o viés de variável omitida em termos do R-quadrado. Então, vamos derivar o R-quadrado.
Antes vamos definir algumas quantidades que serão úteis. Seja <span class="math inline">\(T\)</span> quanto o vetor de respostas <span class="math inline">\(Y\)</span> se desvia da média amostral <span class="math inline">\(\bar{Y}\)</span>.
<span class="math display">\[
T = Y - \bar{Y}
\]</span>
E <span class="math inline">\(T\)</span> pode ser decomposto em duas partes. Primeiro, a porção do desvio em <span class="math inline">\(T\)</span> que é determinado pelo modelo de regressão, dada pelo vetor <span class="math inline">\(\hat{M}\)</span>, definido como:
<span class="math display">\[
\hat{M} = \hat{Y} - \bar{Y}
\]</span></p>
<p>E em segundo lugar, a porção do desvio em <span class="math inline">\(T\)</span> determinado pelos resíduos:
<span class="math display">\[
\hat{e} = Y - \hat{Y}
\]</span>
Portanto, <span class="math inline">\(T = \hat{M} + \hat{e}\)</span>.
Se nós somarmos o quadrado dessas três quantidades para toda a amostra, teremos:
Soma dos Quadrados Totais (em inglês SST)
<span class="math display">\[
SST = \sum{(y_i - \bar{y_i})^2}
\]</span></p>
<p>Soma dos Quadrados Médios (SQM)
<span class="math display">\[
SSM = \sum{(\hat{y_i} - \bar{y})^2}
\]</span></p>
<p>Soma dos Quadrados dos Resíduos (SSE)
<span class="math display">\[
SSE = \sum{\hat{e_i}^2}
\]</span></p>
<p>Vamos mostrar que, do mesmo jeito que <span class="math inline">\(\hat{T} = \hat{M} + \hat{E}\)</span>, <span class="math inline">\(SST = SSM + SSE\)</span></p>
<p>Lembremos que <span class="math inline">\(\sum{\hat{e_i}} = 0\)</span> e <span class="math inline">\(\sum{\hat{e_i}\hat{y_i}} = 0\)</span>
<span class="math display">\[\begin{align}
SST = \sum{(y_i - \bar{y_i})^2} = \\
\sum{(\hat{e_i} + \hat{y_i} - \bar{y_i})^2} = \\
\sum{(\hat{e_i} + (\hat{y_i} - \bar{y_i}))^2} = \\
\sum{\hat{e_i}^2 + 2\hat{e_i}(\hat{y_i} - \bar{y_i}) + (\hat{y_i} - \bar{y_i})^2} = \\
\sum{\hat{e_i}^2} + 2\sum{\hat{e_i}(\hat{y_i} - \bar{y_i})} + \sum{(\hat{y_i} - \bar{y_i})^2} = \\
SSE + 2\sum{(\hat{e_i}\hat{y_i} - \hat{e_i}\bar{y_i})} + SSM = \\
SSE + 2\sum{(\hat{e_i}\hat{y_i}} - 2\sum{\hat{e_i}\bar{y_i})} + SSM = \\
SSE + 0 - 0 + SSM = \\
SST = SSE + SSM = \\
\end{align}\]</span></p>
<p>A intuição dessas quantidades é que SST é uma medida da variação na resposta, <span class="math inline">\(Y\)</span> (é a variância sem dividir por <span class="math inline">\(n\)</span>); SSM é uma medida dessa variação em <span class="math inline">\(Y\)</span> preditiva ou captada pela variação do modelo, e SSE a variação em <span class="math inline">\(Y\)</span> não capturada pelo modelo. Note também que se eu dividir ambos os lados da equação por <span class="math inline">\(n\)</span>, tenho a variância do lado esquerdo, e não altero a igualdade da equação.</p>
<p>E o <span class="math inline">\(R^2\)</span> é definido pela razão entre SSM e SST:
<span class="math display">\[
R^2 = \frac{SSM}{SST} = \frac{Var(\hat{y})}{Var(y)}
\]</span>
O <span class="math inline">\(R^2\)</span> pode ser reescrito de várias maneiras.</p>
<p>Veja que <span class="math inline">\(y = \hat{y} + \hat{e}\)</span>, logo, <span class="math inline">\(\hat{y} = y - \hat{e}\)</span>. E note que <span class="math inline">\(Cov(\hat{y}, \hat{e}) = 0\)</span>. Portanto, temos:</p>
<p><span class="math display">\[
R^2 = \frac{Var(y - \hat{e})}{Var(y)} = 1 - \frac{Var(\hat{e})}{Var(y)} = 1 - \frac{Var(Y^{\perp X}))}{Var(y)}
\]</span>
Ou seja, o R-quadrado é <span class="math inline">\(1\)</span> menos a variância em <span class="math inline">\(Y\)</span> não é predita por <span class="math inline">\(X\)</span>, dividido pela variância de <span class="math inline">\(Y\)</span>. Vamos mostrar agora que o R-quadrado pode ser também definido como a correlação (ao quadrado) entre <span class="math inline">\(Y\)</span> e <span class="math inline">\(\hat{y}\)</span>.</p>
<p>Primeiro, vamos mostrar que
<span class="math display">\[
R^2 = \frac{Cov(Y, \hat{y})}{Var(y)}
\]</span></p>
<p><span class="math display">\[
Cov(Y, \hat{y}) = Cov(\hat{y} + \hat{e}, \hat{y}) = Var(\hat{y}) + Cov(\hat{e}, \hat{y}) = Var(\hat{y})
\]</span>
E podemos mostrar que:
<span class="math display">\[
Var(\hat{y}) = Var(\hat{\alpha} + \hat{\beta} X) = Var(\hat{\beta}X) = \hat{\beta}^2 Var( X)
\]</span>
Portanto,
<span class="math display">\[
R^2 = \frac{\hat{\beta}^2 Var(X)}{Var(y)}
\]</span>
E a fórmula do <span class="math inline">\(\hat{\beta} = Cov(X,Y)/Var(x)\)</span>. Logo:</p>
<p><span class="math display">\[
R^2 = \frac{ Cov(X,Y)^2 Var(X)}{Var(x)^2 Var(y)} = \frac{ Cov(X,Y)^2}{Var(x)Var(y)}
\]</span>
Designando a variância de <span class="math inline">\(x\)</span> por <span class="math inline">\(S_x^2\)</span> e similarmente para <span class="math inline">\(y\)</span>, temos:</p>
<p><span class="math display">\[
R^2 = \frac{ Cov(X,Y)^2}{S_x^2S_y^2} = \left(\frac{ Cov(X,Y)}{S_xS_y}\right)^2
\]</span>
Vamos agora definir o R-quadrado parcial, para regressão múltiplas.</p>
<p>Seja uma regressão completa (full) <span class="math inline">\(y_i = \alpha + \beta_1 x_{1i} + \beta_2 x_{2i} + e_i\)</span> e a regressão restrita, dada por: <span class="math inline">\(y_i = \alpha + \beta_1 x_{1i}  + e_i\)</span>. O R-quadrado parcial é definido como:
<span class="math display">\[
R^2_{partial} = \frac{SSE(reduced) - SSE(full)}{SSE(reduced)}
\]</span>
Veja que posso definir o R-quadrado parcial a partir da regressão restria só com intercepto, sem preditor, e a regressão completa com um preditor. No modelo restrito, <span class="math inline">\(\hat{y} = \bar{y}\)</span>, o que implica que <span class="math inline">\(SSE(reduced) = SST\)</span>. Logo, temos:</p>
<p><span class="math display">\[
R^2_{partial} = \frac{SST - SSE(full)}{SST} = 1 - \frac{SSE}{SST}
\]</span>
Que é nossa definição de R-quadrado em modelo de regressão simples.</p>
<p>Então, o R-quadrado parcial me dá uma medida da proporção da variância predita pelo modelo completo que não pode ser predita pelo modelo simples.Ainda em outras palavras, o R quadrado parcial mede o poder preditivo adicional do modelo reduzido comparado ao completo. No caso de modelos com uma e duas variáveis, estou vendo o poder preditivo de adicionar uma variável ao modelo. Em termos de notação, podemos escrever o R-quadrado parcial do seguinte modo:</p>
<p><span class="math display">\[
R^2_{y \sim x1|x2} = 1 - \frac{Var(y^{\perp x_1, x_2})}{Var(y^{\perp x_1})} = \left(Cor(x_1^{\perp x_2}, y^{\perp x_2})\right)^2
\]</span></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="regressao-multipla.html#cb280-1" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb280-2"><a href="regressao-multipla.html#cb280-2" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb280-3"><a href="regressao-multipla.html#cb280-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb280-4"><a href="regressao-multipla.html#cb280-4" tabindex="-1"></a><span class="fu">library</span>(sjlabelled) <span class="co"># pra remover labelled variables</span></span>
<span id="cb280-5"><a href="regressao-multipla.html#cb280-5" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb280-6"><a href="regressao-multipla.html#cb280-6" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb280-7"><a href="regressao-multipla.html#cb280-7" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb280-8"><a href="regressao-multipla.html#cb280-8" tabindex="-1"></a></span>
<span id="cb280-9"><a href="regressao-multipla.html#cb280-9" tabindex="-1"></a><span class="do">## dados</span></span>
<span id="cb280-10"><a href="regressao-multipla.html#cb280-10" tabindex="-1"></a><span class="co"># https://www.latinobarometro.org/latContents.jsp</span></span>
<span id="cb280-11"><a href="regressao-multipla.html#cb280-11" tabindex="-1"></a></span>
<span id="cb280-12"><a href="regressao-multipla.html#cb280-12" tabindex="-1"></a>lat_bar23 <span class="ot">&lt;-</span> sjlabelled<span class="sc">::</span><span class="fu">read_spss</span>(<span class="fu">here</span>(<span class="st">&quot;Dados&quot;</span>, <span class="st">&quot;Latinobarometro_2023_Eng_Spss_v1_0.sav&quot;</span>),</span>
<span id="cb280-13"><a href="regressao-multipla.html#cb280-13" tabindex="-1"></a>                               <span class="at">drop.labels =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>## Invalid date string (length=9): 09 032 23</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="regressao-multipla.html#cb282-1" tabindex="-1"></a>lat_bar23 <span class="ot">&lt;-</span> lat_bar23 <span class="sc">%&gt;%</span></span>
<span id="cb282-2"><a href="regressao-multipla.html#cb282-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S17 =</span> <span class="fu">as.Date</span>(<span class="fu">as.character</span>(S17), <span class="at">format=</span><span class="st">&quot;%Y%m%d&quot;</span>)) </span>
<span id="cb282-3"><a href="regressao-multipla.html#cb282-3" tabindex="-1"></a></span>
<span id="cb282-4"><a href="regressao-multipla.html#cb282-4" tabindex="-1"></a>lat_bar23 <span class="ot">&lt;-</span> lat_bar23 <span class="sc">%&gt;%</span></span>
<span id="cb282-5"><a href="regressao-multipla.html#cb282-5" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb282-6"><a href="regressao-multipla.html#cb282-6" tabindex="-1"></a></span>
<span id="cb282-7"><a href="regressao-multipla.html#cb282-7" tabindex="-1"></a><span class="co"># get_label(lat_bar23)</span></span>
<span id="cb282-8"><a href="regressao-multipla.html#cb282-8" tabindex="-1"></a></span>
<span id="cb282-9"><a href="regressao-multipla.html#cb282-9" tabindex="-1"></a>lat_bar23 <span class="ot">&lt;-</span> lat_bar23 <span class="sc">%&gt;%</span></span>
<span id="cb282-10"><a href="regressao-multipla.html#cb282-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data_base =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(diareal, mesreal, <span class="st">&quot;2023&quot;</span>, <span class="at">sep=</span><span class="st">&quot;-&quot;</span>), <span class="st">&quot;%d-%m-%Y&quot;</span>),</span>
<span id="cb282-11"><a href="regressao-multipla.html#cb282-11" tabindex="-1"></a>         <span class="at">idade =</span> <span class="fu">year</span>(<span class="fu">as.period</span>(<span class="fu">interval</span>(s17,data_base))),</span>
<span id="cb282-12"><a href="regressao-multipla.html#cb282-12" tabindex="-1"></a>         <span class="at">econ_12_meses =</span> <span class="fu">ifelse</span>(p6stgbs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="st">&quot;better&quot;</span>, </span>
<span id="cb282-13"><a href="regressao-multipla.html#cb282-13" tabindex="-1"></a>                                <span class="fu">ifelse</span>(p6stgbs <span class="sc">==</span> <span class="dv">8</span>, <span class="cn">NA</span>, <span class="st">&quot;other&quot;</span>)),</span>
<span id="cb282-14"><a href="regressao-multipla.html#cb282-14" tabindex="-1"></a>         <span class="at">econ_12_meses =</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(econ_12_meses), <span class="at">ref =</span> <span class="st">&quot;other&quot;</span>),</span>
<span id="cb282-15"><a href="regressao-multipla.html#cb282-15" tabindex="-1"></a>         <span class="at">aprovacao_presidente =</span> <span class="fu">ifelse</span>(p15stgbs <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>, p15stgbs),</span>
<span id="cb282-16"><a href="regressao-multipla.html#cb282-16" tabindex="-1"></a>         <span class="at">ideologia =</span> <span class="fu">ifelse</span>(p16st <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>), <span class="cn">NA</span>, p16st),</span>
<span id="cb282-17"><a href="regressao-multipla.html#cb282-17" tabindex="-1"></a>         <span class="at">votaria_governo =</span> <span class="fu">ifelse</span>(perpart <span class="sc">==</span> <span class="dv">4</span>, <span class="cn">NA</span>,</span>
<span id="cb282-18"><a href="regressao-multipla.html#cb282-18" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(perpart <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb282-19"><a href="regressao-multipla.html#cb282-19" tabindex="-1"></a>         <span class="at">genero =</span> <span class="fu">factor</span>(sexo, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;homem&quot;</span>, <span class="st">&quot;mulher&quot;</span>)),</span>
<span id="cb282-20"><a href="regressao-multipla.html#cb282-20" tabindex="-1"></a>         <span class="at">evangelico =</span> <span class="fu">ifelse</span>(s1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">98</span>), <span class="cn">NA</span>,</span>
<span id="cb282-21"><a href="regressao-multipla.html#cb282-21" tabindex="-1"></a>                             <span class="fu">ifelse</span>(s1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="dv">1</span>, <span class="dv">0</span>))) <span class="co"># não considera adventista, testemunha Jeová, Mórmon</span></span></code></pre></div>
<pre><code>## Warning: There was 1 warning in `mutate()`.
## ℹ In argument: `idade = year(as.period(interval(s17, data_base)))`.
## Caused by warning in `.local()`:
## ! NAs introduced by coercion to integer range</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="regressao-multipla.html#cb284-1" tabindex="-1"></a>br_latbar_23 <span class="ot">&lt;-</span> lat_bar23 <span class="sc">%&gt;%</span></span>
<span id="cb284-2"><a href="regressao-multipla.html#cb284-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">idenpa =</span> <span class="fu">remove_all_labels</span>(idenpa)) <span class="sc">%&gt;%</span> <span class="co"># haven_labelled problems</span></span>
<span id="cb284-3"><a href="regressao-multipla.html#cb284-3" tabindex="-1"></a>  <span class="fu">filter</span>(idenpa <span class="sc">==</span> <span class="dv">76</span>) <span class="sc">%&gt;%</span> <span class="do">## seelciona brasil</span></span>
<span id="cb284-4"><a href="regressao-multipla.html#cb284-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(votaria_governo) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(evangelico) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ideologia) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(econ_12_meses))</span>
<span id="cb284-5"><a href="regressao-multipla.html#cb284-5" tabindex="-1"></a></span>
<span id="cb284-6"><a href="regressao-multipla.html#cb284-6" tabindex="-1"></a><span class="fu">glimpse</span>(br_latbar_23)</span></code></pre></div>
<pre><code>## Rows: 472
## Columns: 282
## $ numinves             &lt;fct&gt; 23, 23, 23, 23, 23, 23, 23, 23, 23, 23…
## $ idenpa               &lt;fct&gt; 76, 76, 76, 76, 76, 76, 76, 76, 76, 76…
## $ numentre             &lt;dbl&gt; 372, 373, 1100, 351, 15, 1101, 375, 95…
## $ reg                  &lt;fct&gt; 76002, 76002, 76004, 76002, 76001, 760…
## $ ciudad               &lt;fct&gt; 76002020, 76002020, 76004129, 76002192…
## $ tamciud              &lt;fct&gt; 7, 7, 4, 6, 8, 4, 7, 7, 7, 6, 7, 8, 4,…
## $ comdist              &lt;dbl&gt; 35, 35, 102, 34, 3, 102, 35, 89, 80, 3…
## $ edad                 &lt;dbl&gt; 57, 37, 18, 47, 47, 33, 47, 65, 26, 55…
## $ sexo                 &lt;fct&gt; 2, 2, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2,…
## $ codigo               &lt;dbl&gt; 80, 80, 9, 78, 20, 9, 80, 53, 44, 78, …
## $ diareal              &lt;fct&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…
## $ mesreal              &lt;fct&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,…
## $ ini                  &lt;dbl&gt; 757, 905, 913, 909, 946, 1002, 1046, 1…
## $ fin                  &lt;dbl&gt; 859, 946, 956, 1002, 1035, 1042, 1123,…
## $ dura                 &lt;dbl&gt; 62, 41, 43, 53, 49, 40, 37, 49, 49, 65…
## $ totrevi              &lt;dbl&gt; 4, 3, 6, 3, 0, 1, 6, 0, 1, 1, 0, 0, 0,…
## $ totcuot              &lt;dbl&gt; 99, 0, 0, 99, 0, 0, 99, 0, 0, 99, 0, 0…
## $ totrech              &lt;dbl&gt; 5, 0, 0, 2, 0, 1, 2, 0, 0, 6, 2, 3, 1,…
## $ totperd              &lt;dbl&gt; 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1,…
## $ numcasa              &lt;dbl&gt; 6, 1, 1, 3, 1, 2, 3, 1, 1, 7, 3, 4, 2,…
## $ codsuper             &lt;dbl&gt; 2, 2, 13, 2, 1, 13, 2, 11, 10, 2, 10, …
## $ supervvi             &lt;fct&gt; 2, 1, 2, 2, 1, 1, 2, 2, 2, 2, 2, 1, 2,…
## $ superven             &lt;fct&gt; 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 2,…
## $ codif                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ digit                &lt;dbl&gt; 80, 80, 9, 78, 20, 9, 80, 53, 44, 78, …
## $ p1st                 &lt;fct&gt; 4, 3, 2, 2, 2, 2, 3, 1, 2, 2, 2, 3, 2,…
## $ p2st                 &lt;fct&gt; 1, 2, 2, 3, 2, 3, 2, 2, 2, 2, 1, 1, 2,…
## $ p3n                  &lt;fct&gt; 4, 4, 2, 2, 3, 3, 2, 3, 2, 4, 3, 2, 3,…
## $ p4stgbs              &lt;fct&gt; 16, 16, 36, 16, 5, 4, 9, NA, 16, 9, 26…
## $ p5stgbs              &lt;fct&gt; 5, 4, 3, 4, 3, 5, 4, 2, 4, 3, 3, 3, 5,…
## $ p6stgbs              &lt;fct&gt; 3, 3, 2, 2, 3, 3, 3, 3, 3, 2, 2, 3, 2,…
## $ p7st                 &lt;fct&gt; 1, 2, 2, 1, 2, 3, 5, 2, 5, 4, 2, 3, 2,…
## $ p8stgbs              &lt;fct&gt; 1, 2, 3, 1, 2, 3, 2, 1, 3, 1, 2, NA, 2…
## $ p9stgbs              &lt;fct&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
## $ p10stgbs             &lt;fct&gt; 1, 3, 1, 1, 3, 3, 1, 3, NA, 1, 1, NA, …
## $ p11stgbs_a           &lt;fct&gt; 2, 3, 3, 3, 3, 4, 4, 3, NA, 3, 2, 3, 3…
## $ p11stgbs_b           &lt;fct&gt; 3, 4, 3, 3, 3, 4, 3, NA, 4, 4, 2, 3, 3…
## $ p12st                &lt;dbl&gt; 2, 2, 1, 2, 1, 1, 1, 2, NA, 1, 2, 2, 2…
## $ p13stgbs_a           &lt;fct&gt; 3, 3, 2, 1, 1, 4, 1, 1, 1, 2, 3, 3, 4,…
## $ p13stgbs_b           &lt;fct&gt; 2, 3, 1, 1, 1, 1, 3, 1, 1, 1, 2, 3, 3,…
## $ p13st_c              &lt;fct&gt; 2, 3, 3, 1, 1, 3, 1, 1, 1, 1, 4, 1, 1,…
## $ p13st_d              &lt;fct&gt; 1, 3, 3, 2, 1, 4, 3, 2, 2, 2, 1, 3, 3,…
## $ p13st_e              &lt;fct&gt; 1, 3, 3, 1, 3, 4, 4, 1, 2, 3, 3, 2, 3,…
## $ p13st_f              &lt;fct&gt; 1, 3, 3, 1, 1, 4, 4, 1, 3, 4, 1, 3, 2,…
## $ p13st_g              &lt;fct&gt; 2, 4, 3, 2, 3, 4, 3, 4, 3, 3, 2, 3, 4,…
## $ p13st_h              &lt;fct&gt; 1, 3, 3, 1, 1, 4, 4, 1, 2, 4, 1, 3, 1,…
## $ p13st_i              &lt;fct&gt; 1, 3, 3, 1, 3, 3, 4, 1, 3, 3, 1, 1, 1,…
## $ p14st_a              &lt;fct&gt; 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,…
## $ p14st_b              &lt;fct&gt; 2, 3, 2, 2, 1, 3, 3, 1, 2, 2, 2, 4, 3,…
## $ p14st_c              &lt;fct&gt; 2, 4, 3, 2, 3, 3, 4, 4, 2, 2, 4, 4, 3,…
## $ p14st_d              &lt;fct&gt; 1, 4, 2, 2, 3, 3, 4, 1, 3, 4, 4, 3, 2,…
## $ p14st_e              &lt;fct&gt; 2, 4, 2, 2, 3, 3, 3, 1, 3, 4, 2, NA, 4…
## $ p14st_f              &lt;fct&gt; 2, 3, 1, 2, 1, 2, 3, 1, 2, 3, 2, 4, 4,…
## $ p14st_g              &lt;fct&gt; 1, 4, 2, 2, 1, 3, 2, 1, 2, 3, 2, 3, 3,…
## $ p14st_h              &lt;fct&gt; 2, 3, 2, 2, 3, 2, 3, 1, 2, 3, 2, 4, 3,…
## $ p14n_i               &lt;fct&gt; 3, 4, 2, 2, 3, 4, 3, 1, 3, 4, 4, 4, 4,…
## $ p15stgbs             &lt;fct&gt; 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1,…
## $ p16st                &lt;fct&gt; 5, 6, 6, 5, 6, 5, 10, 10, 5, 8, 5, 7, …
## $ p17st                &lt;fct&gt; 3, 2, 3, 2, 1, 3, 4, 1, 4, 2, 3, 3, 4,…
## $ p18st_a              &lt;fct&gt; 1, 1, 2, 1, 1, 1, 1, 1, 3, 1, 1, 1, 2,…
## $ p18stm_b             &lt;fct&gt; 1, 4, 3, 3, 2, 2, 1, 1, 4, 4, 4, 1, 4,…
## $ p18stm_c             &lt;fct&gt; 3, 1, 3, 2, 2, 4, 4, 1, 4, 2, 4, 1, 2,…
## $ p18n_d               &lt;fct&gt; 2, 2, 2, 2, 2, 4, 1, 4, 2, 1, 2, 4, 2,…
## $ p18n_e               &lt;fct&gt; 3, 3, 2, 3, 2, 3, 1, 3, 2, 3, 1, 1, 3,…
## $ p18n_f               &lt;fct&gt; 2, 4, 3, 3, 2, 4, 2, 4, 4, 2, 3, 4, 3,…
## $ p18n_g               &lt;fct&gt; 2, 1, 2, 2, 1, 1, 1, 4, 4, 1, 3, 1, 1,…
## $ p18n_h               &lt;fct&gt; 1, 2, 2, 2, 1, 1, 1, 1, 2, 1, 3, 1, 1,…
## $ p18st_i              &lt;fct&gt; 2, 1, 2, 1, 1, 4, 2, 1, 4, 1, 1, 4, 3,…
## $ p19n                 &lt;fct&gt; 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 1, 1, 2,…
## $ p20stm               &lt;fct&gt; 1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2,…
## $ p21st                &lt;fct&gt; 1, 2, 1, 2, 2, 2, 1, 1, 2, 1, 1, 2, 2,…
## $ p22st                &lt;fct&gt; 1, 1, 6, 2, 7, 5, 1, 3, 1, 8, 8, 1, 3,…
## $ p23st_a              &lt;fct&gt; 2, 2, 1, 1, 2, 2, 1, 4, 1, 1, 2, 2, 4,…
## $ p23st_b              &lt;fct&gt; 3, 3, 2, 2, 3, 2, 2, 4, 3, 1, 2, 4, NA…
## $ p23st_c              &lt;fct&gt; 2, 3, 2, 2, 3, 2, 4, 4, 1, 3, 1, 4, 4,…
## $ p23st_d              &lt;fct&gt; 2, 3, 2, 3, 2, 2, 2, 4, 2, 2, 2, 4, NA…
## $ p23st_e              &lt;fct&gt; 3, 3, 4, 2, 2, 2, 2, 4, 2, 4, 2, 4, 4,…
## $ p23st_f              &lt;fct&gt; 3, 3, 4, 3, 3, 3, 4, 4, 3, 3, 3, 4, 4,…
## $ p24st_a              &lt;fct&gt; 2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2,…
## $ p24st_b              &lt;fct&gt; 3, 2, 2, 2, 2, 2, 2, 3, NA, 2, 2, 3, N…
## $ p24st_c              &lt;fct&gt; 1, 2, 2, 1, 2, 2, 2, 3, 2, 3, 1, 3, 4,…
## $ p24st_d              &lt;fct&gt; 1, 2, 2, 2, 1, 2, 2, 3, NA, 3, 2, 3, 2…
## $ p24st_e              &lt;fct&gt; 2, 2, 3, 1, 3, 3, 4, 3, NA, 3, 3, 3, 3…
## $ p25n_a               &lt;fct&gt; 2, 2, 1, 1, 2, 2, 2, 3, 1, 2, 2, 2, 2,…
## $ p25n_b               &lt;fct&gt; 2, 2, 1, 2, 2, 2, 2, 3, 3, 1, 2, 3, 3,…
## $ p25n_c               &lt;fct&gt; 1, 3, 1, 1, 2, 2, 2, 3, 1, 3, 1, 3, 4,…
## $ p26sdn_a             &lt;fct&gt; 1, 3, 2, 1, 2, 1, 4, 4, 3, 4, 2, NA, 4…
## $ p26sdn_b             &lt;fct&gt; 3, 4, 1, 4, 3, 1, 1, 4, NA, 1, 4, 4, 1…
## $ p26sdn_c             &lt;fct&gt; 2, NA, 2, 3, 3, 1, 3, 4, 2, 3, 2, 4, 3…
## $ p26sdn_d             &lt;fct&gt; 1, 1, 3, 1, 1, 1, 3, 4, NA, 3, 1, 4, 4…
## $ p26sdn_e             &lt;fct&gt; 3, 3, 2, 1, 1, 1, 3, 4, 1, 3, 4, 3, 4,…
## $ p26sdn_f             &lt;fct&gt; 3, 3, 1, 1, 2, 1, 3, 4, 3, 3, 1, NA, 4…
## $ p27sdn               &lt;fct&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1,…
## $ p28stin              &lt;fct&gt; 4, 1, 1, 2, 1, NA, 3, 3, NA, 1, 4, 3, …
## $ p29stin_a            &lt;fct&gt; 1, 2, 1, 2, 2, 1, 2, 4, 1, 3, 1, NA, 2…
## $ p29stin_b            &lt;fct&gt; 1, 2, 1, 2, 1, NA, 1, 4, 2, 4, 1, 1, 2…
## $ p30stin_a            &lt;fct&gt; 4, 4, 2, 2, 4, 4, 1, 1, 2, 1, 3, 4, 1,…
## $ p30inn_b             &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ p30inn_c             &lt;fct&gt; 2, 1, 2, 3, 2, 1, 4, 3, 1, 1, 1, 4, 1,…
## $ p30inn_d             &lt;fct&gt; 4, 1, 1, 4, 2, 1, 2, 1, 1, 4, 1, 1, 1,…
## $ p30inn_e             &lt;fct&gt; 4, 1, 3, 4, 2, 4, 2, 4, 2, 4, 1, 3, 4,…
## $ p30inn_f             &lt;fct&gt; 2, 1, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 2,…
## $ p31inn_a             &lt;fct&gt; 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1,…
## $ p31inn_b             &lt;fct&gt; 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0,…
## $ p31inn_c             &lt;fct&gt; 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0,…
## $ p31inn_d             &lt;fct&gt; 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0,…
## $ p31inn_e             &lt;fct&gt; 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0,…
## $ p31inn_f             &lt;fct&gt; 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0,…
## $ p31inn_1             &lt;fct&gt; 3, 1, 1, 3, 2, 2, 2, 4, 1, 1, 6, NA, 1…
## $ p31inn_2             &lt;fct&gt; 6, 3, 3, NA, 3, NA, 3, NA, 2, 3, NA, N…
## $ p31inn_3             &lt;fct&gt; NA, 4, 6, NA, 4, NA, 4, NA, 3, NA, NA,…
## $ p31inn_4             &lt;fct&gt; NA, 5, NA, NA, 5, NA, 5, NA, 4, NA, NA…
## $ p31inn_5             &lt;fct&gt; NA, 6, NA, NA, 6, NA, 6, NA, NA, NA, N…
## $ p31inn_6             &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ p32inn               &lt;fct&gt; 1, 1, 1, 3, 2, 2, 1, 2, 3, 2, 3, 2, 3,…
## $ p33n_a               &lt;fct&gt; 3, 2, 2, 3, 2, 4, 2, 2, 2, 3, 2, 1, 2,…
## $ p33st_b              &lt;fct&gt; 3, 3, 4, 4, 2, 1, 3, 4, 3, 1, 4, 4, 3,…
## $ p33n_c               &lt;fct&gt; 2, 2, 4, 3, 2, 4, 3, 4, 3, 4, 4, 1, 3,…
## $ p33n_d               &lt;fct&gt; 2, 1, 1, 2, 2, 4, 2, 4, 2, 3, 1, 4, 1,…
## $ p34wvsna             &lt;fct&gt; 2, 1, 2, 3, 2, 2, 3, 1, 1, 2, 1, 2, 4,…
## $ p34wvsnb             &lt;fct&gt; 3, 3, 1, 4, 1, 3, 1, 2, 3, 1, 2, 3, 2,…
## $ p35na                &lt;fct&gt; 2, 4, 4, 4, 4, 4, 4, 1, 1, 4, 2, 2, 4,…
## $ p35nb                &lt;fct&gt; 4, 1, 2, 3, 2, 3, 2, 4, 3, 1, 4, 4, 3,…
## $ p36st                &lt;fct&gt; 2, 1, 1, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1,…
## $ p37csn_a             &lt;fct&gt; 1, 4, 1, 2, 1, 1, 4, 4, 3, 4, 1, 1, 1,…
## $ p37csn_b             &lt;fct&gt; 1, 4, 1, 2, 2, 1, 4, 4, 4, 4, 1, 4, 1,…
## $ p37stcs_c            &lt;fct&gt; 4, 4, 4, 1, 2, 4, 1, 1, 4, 4, 4, 4, 4,…
## $ p37wvsstcs_d         &lt;fct&gt; 2, 4, 4, 4, 2, 4, 2, 1, 4, 4, 4, 1, 4,…
## $ p37stcs_e            &lt;fct&gt; 4, 4, 2, 2, 2, 4, 3, 2, 4, 4, 3, 4, 4,…
## $ p37csn_f             &lt;fct&gt; 4, 4, 1, 1, 2, 1, 4, 1, 4, 4, 1, 4, 1,…
## $ p37wvscs_g           &lt;fct&gt; 4, 4, 4, 4, 2, 4, 2, 1, 4, 4, 4, 4, 4,…
## $ p37wvscs_h           &lt;fct&gt; 1, 4, 1, 3, 2, 1, 4, 4, 4, 4, 1, 1, 1,…
## $ p38csn_a             &lt;fct&gt; 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1,…
## $ p38csn_b             &lt;fct&gt; 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ p38csn_c             &lt;fct&gt; 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0,…
## $ p38csn_d             &lt;fct&gt; 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0,…
## $ p38csn_e             &lt;fct&gt; 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0,…
## $ p38csn_f             &lt;fct&gt; 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0,…
## $ p38csn_g             &lt;fct&gt; 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0,…
## $ p39n                 &lt;fct&gt; 2, 2, 3, 2, 1, 2, 2, 1, 2, 1, 3, 2, 3,…
## $ p40stgbs             &lt;fct&gt; 1, 4, 2, 1, 3, 3, 1, 4, 3, 2, 1, 3, 3,…
## $ p41st_a              &lt;fct&gt; 2, 3, 2, 1, 1, 3, 3, 1, 4, 1, 1, 3, 2,…
## $ p41st_b              &lt;fct&gt; 2, 3, 2, 1, 3, 3, 4, 1, 3, 1, 3, 3, 2,…
## $ p41st_c              &lt;fct&gt; 3, 4, 3, 3, 1, 3, 3, 1, 3, 1, 3, 4, 2,…
## $ p41st_d              &lt;fct&gt; 3, 3, 2, 2, 3, 3, 3, 1, 3, 2, 1, NA, 2…
## $ p41st_e              &lt;fct&gt; 4, 4, 3, 3, 2, 3, 4, 1, 4, 3, 3, 4, 4,…
## $ p41st_f              &lt;fct&gt; 2, 3, 2, 1, 3, 3, 3, 1, 4, 1, 4, NA, 2…
## $ p41st_g              &lt;fct&gt; 2, 3, 3, 3, 1, 3, 3, 1, NA, 1, 3, NA, …
## $ p41st_h              &lt;fct&gt; 1, 3, 3, 1, 3, 3, 4, 1, 3, 1, 3, NA, 2…
## $ p41st_i              &lt;fct&gt; 1, 1, 3, 1, 1, 3, 4, 1, 2, 1, 1, 4, 2,…
## $ p41st_j              &lt;fct&gt; 3, 4, 3, 4, 3, 3, 4, 1, 4, 1, 3, 4, 3,…
## $ p41st_k              &lt;fct&gt; 3, 4, 2, 2, 1, 3, 3, 1, 3, 1, 3, 3, 3,…
## $ p41st_l              &lt;fct&gt; 2, 3, 3, 3, 1, 3, 4, 1, 4, 1, 4, 4, 2,…
## $ p41st_m              &lt;fct&gt; 3, 3, 2, 2, 3, 3, 3, 1, 3, 1, 3, 3, 2,…
## $ p42stgbs             &lt;fct&gt; 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, NA, 2…
## $ p43stgbs_a           &lt;fct&gt; 76001, 76001, 76021, 76038, 76014, 760…
## $ p43stgbs_b           &lt;fct&gt; 1, 1, 2, NA, 1, 1, 2, 1, 2, 1, 1, 1, 1…
## $ p44st_a              &lt;fct&gt; 1, 4, 2, 1, 2, 4, 2, 4, 4, 1, 1, 4, 2,…
## $ p44st_b              &lt;fct&gt; 2, 2, 2, 4, 1, 2, 4, 4, 4, 1, 4, NA, 4…
## $ p44st_c              &lt;fct&gt; 1, 4, 3, 1, 2, 4, 2, 4, 4, 1, 4, 2, 4,…
## $ p44st_d              &lt;fct&gt; 2, 4, 3, 1, 4, 4, 4, 4, 4, 1, 4, NA, 4…
## $ p45st_a              &lt;fct&gt; 2, 3, 2, 2, 1, 2, 2, 3, 2, 1, 1, 1, 2,…
## $ p45s_b               &lt;fct&gt; 2, 3, 2, 2, 1, 2, 2, 3, 3, 1, 3, 3, 2,…
## $ p45st_c              &lt;fct&gt; 3, 3, 3, 3, 1, 3, 3, 3, 3, 3, 3, 3, 3,…
## $ p45stn_d             &lt;fct&gt; 1, 3, 2, 3, 1, 3, 2, 3, 3, 1, 3, 3, 2,…
## $ p46n                 &lt;fct&gt; 2, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, NA, 2…
## $ p47st                &lt;fct&gt; 2, 1, 2, 5, 1, 5, 2, 1, 1, 1, 2, 5, 2,…
## $ p48st                &lt;fct&gt; 2, 1, 1, 2, 2, 2, 2, 1, 2, 1, 1, 2, NA…
## $ p49st                &lt;fct&gt; 1, 1, 1, 2, 2, 1, 1, 2, 1, 1, 1, 2, 1,…
## $ p50st                &lt;fct&gt; 1, 5, 3, 4, 3, 5, 5, 5, 5, 4, 3, 5, 1,…
## $ p51n                 &lt;fct&gt; 1, 3, 1, 1, 1, 2, 1, 2, 3, 2, 3, 2, 2,…
## $ p52n                 &lt;fct&gt; 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 1, 2, 1,…
## $ p53n_a               &lt;fct&gt; 1, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1,…
## $ p53n_b               &lt;fct&gt; 2, 1, 2, 1, 1, 2, 1, 1, 1, 2, 2, 1, 3,…
## $ p53n_c               &lt;fct&gt; 2, 3, 3, 1, 1, 2, 3, 1, 3, 2, 2, 1, 1,…
## $ p53n_d               &lt;fct&gt; 1, 1, 3, 1, 1, 2, 1, 1, 1, 2, 2, 1, 1,…
## $ p54n_a               &lt;fct&gt; 2, 3, 2, 3, 1, 4, 2, 3, 3, 1, 2, 4, 2,…
## $ p54st_b              &lt;fct&gt; 2, 2, 4, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2,…
## $ p55n                 &lt;fct&gt; 3, 1, 4, 3, 2, 5, 2, 5, 3, 2, 4, 1, 4,…
## $ p56n_a               &lt;fct&gt; 3, 4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 2,…
## $ p56n_b               &lt;fct&gt; 4, 4, 2, 3, 1, 2, 1, 1, 2, 2, 2, 1, 2,…
## $ p56n_c               &lt;fct&gt; 3, 4, 1, 1, 1, 1, 3, 1, 1, 1, 2, 1, 2,…
## $ p56n_d               &lt;fct&gt; 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2,…
## $ p57st_a              &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,…
## $ p57st_b              &lt;fct&gt; 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,…
## $ p57st_c              &lt;fct&gt; 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0,…
## $ p57st_d              &lt;fct&gt; 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0,…
## $ p57st_e              &lt;fct&gt; 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0,…
## $ p57st_f              &lt;fct&gt; 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0,…
## $ p57st_g              &lt;fct&gt; 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,…
## $ p57st_h              &lt;fct&gt; 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1,…
## $ p58st                &lt;fct&gt; 4, 4, 4, 4, 2, 4, 4, 4, 4, 4, 4, 4, 4,…
## $ p59st                &lt;fct&gt; 1, 1, 2, 1, 1, 1, 1, 4, 1, 1, 3, 1, 3,…
## $ p60st                &lt;fct&gt; 4, 3, 3, 3, 3, 4, 1, 3, 3, 1, 2, 4, 4,…
## $ p61st                &lt;fct&gt; 10, 8, 4, 10, 8, 1, 1, 8, 1, 8, 1, 1, …
## $ p62n_1               &lt;fct&gt; 5, 7, 96, 0, 8, 96, 96, 0, 96, 7, 5, 9…
## $ p62st_2              &lt;fct&gt; 4, 96, 96, 0, 8, 96, 96, 10, 96, 3, 96…
## $ p62st_3              &lt;fct&gt; 96, 96, 96, 0, 8, 96, 96, 0, 96, 4, 5,…
## $ p62st_4              &lt;fct&gt; 2, 0, 5, 6, 7, 0, 8, 8, 1, 8, 0, 0, 0,…
## $ p62st_5              &lt;fct&gt; 0, 0, 96, 0, 6, 96, 0, 0, 1, 8, 0, 96,…
## $ p62n_6               &lt;fct&gt; 96, 96, 96, 0, 7, 96, 96, 0, 96, 8, 96…
## $ p62st_7              &lt;fct&gt; 9, 10, 96, 10, 10, 8, 0, 0, 8, 4, 9, 1…
## $ p62st_8              &lt;fct&gt; 7, 96, 96, 0, 8, NA, 0, 0, 96, 4, 9, 9…
## $ p62n_9               &lt;fct&gt; 0, 96, 96, 1, 8, 96, 96, 0, 96, 8, 5, …
## $ p62st_10             &lt;fct&gt; 5, 5, 8, 0, 8, 96, 1, 0, 5, 7, 0, 0, 0…
## $ p62st_11             &lt;fct&gt; 96, 96, 96, 0, 8, 96, 96, 0, 96, 5, NA…
## $ p62n_12              &lt;fct&gt; 3, 96, 96, 0, 8, 96, 0, 0, 4, 8, 0, 96…
## $ p62n_13              &lt;fct&gt; 96, 96, 96, 0, 8, 96, 96, 0, 96, 4, 5,…
## $ p62n_14              &lt;fct&gt; 5, 4, 3, 2, 8, 96, 1, 0, NA, 8, 7, 96,…
## $ p62n_15              &lt;fct&gt; 3, 2, 96, 0, 8, 96, 5, 0, 96, 8, 2, 96…
## $ p62n_16              &lt;fct&gt; 9, 10, 6, 10, 7, 5, 0, 10, 0, 8, 7, 10…
## $ p62n_17              &lt;fct&gt; 8, 9, 3, 5, 8, 96, 1, 0, 96, 8, 1, 8, …
## $ p63st                &lt;fct&gt; 4, 4, 2, 4, 3, 3, 3, 1, 3, 3, 3, NA, N…
## $ s1                   &lt;fct&gt; 2, 2, 1, 1, 1, 1, 2, 1, 2, 5, 96, 1, 1…
## $ s1a                  &lt;fct&gt; 3, 3, 3, 3, 2, 3, 2, 1, 2, 2, 2, 2, 2,…
## $ s2                   &lt;fct&gt; 4, 3, 4, 4, 3, 4, 5, 3, 4, 3, 3, 5, 4,…
## $ s3                   &lt;fct&gt; 1, 1, 1, 1, 4, 1, 2, 1, 1, 3, 1, 3, 1,…
## $ s4                   &lt;fct&gt; 5, 5, 5, 1, 5, 3, 5, 5, 5, 5, 4, 5, 5,…
## $ s5                   &lt;fct&gt; 3, 2, 1, 1, 4, 2, 4, 2, 3, 1, 1, 4, 1,…
## $ s6                   &lt;fct&gt; 1, 1, 4, 2, 2, 2, 3, 1, 4, 1, 4, 1, 1,…
## $ s7                   &lt;fct&gt; 4, 6, 6, 6, 4, 6, 6, 6, 6, 6, 4, 6, 6,…
## $ s8                   &lt;fct&gt; 1, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2,…
## $ s9                   &lt;fct&gt; 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2,…
## $ s10                  &lt;dbl&gt; 18, 12, 18, 22, 19, 20, 22, 12, 18, 32…
## $ s11                  &lt;fct&gt; 11, 7, 13, 13, 12, 13, 8, 5, 13, 13, 1…
## $ s12                  &lt;fct&gt; 5, 2, 15, 9, 9, 5, 5, 1, 13, 4, 9, 1, …
## $ s13inn_a_a           &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ s13inn_a_b           &lt;fct&gt; 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0,…
## $ s13inn_a_c           &lt;fct&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
## $ s13inn_a_d           &lt;fct&gt; 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1,…
## $ s13inn_a_1           &lt;fct&gt; 4, 4, 2, 2, 4, 4, 4, 4, 2, 2, 3, 4, 4,…
## $ s13inn_a_2           &lt;dbl&gt; 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ s13inn_a_3           &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ s14m_a               &lt;fct&gt; 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0,…
## $ s14m_b               &lt;fct&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ s14m_c               &lt;fct&gt; 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0,…
## $ s14m_d               &lt;fct&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ s14m_e               &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0,…
## $ s14m_f               &lt;fct&gt; 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1,…
## $ s14m_g               &lt;fct&gt; 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,…
## $ s14m_h               &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ s14m_i               &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ s14m_j               &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,…
## $ s15_a                &lt;fct&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
## $ s15_b                &lt;fct&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
## $ s16                  &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1,…
## $ s17                  &lt;date&gt; 1965-11-30, 1985-10-01, 2004-07-23, 1…
## $ s18_a                &lt;fct&gt; 4, 4, 4, 1, 4, 3, 4, 5, 4, 6, 1, 5, 6,…
## $ s18_b                &lt;fct&gt; 8, 3, 8, NA, 4, NA, 8, 8, 8, NA, NA, 8…
## $ s19                  &lt;fct&gt; NA, NA, NA, 2, NA, 8, NA, NA, NA, NA, …
## $ s20_a                &lt;fct&gt; 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1,…
## $ s20_b                &lt;fct&gt; 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2,…
## $ s20_c                &lt;fct&gt; 2, 2, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2,…
## $ s20_d                &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ s20_e                &lt;fct&gt; 2, 1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2, 2,…
## $ s20_f                &lt;fct&gt; 2, 2, 1, 1, 2, 1, 2, 1, 1, 2, 1, 1, 2,…
## $ s20_g                &lt;fct&gt; 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2,…
## $ s20_h                &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ s20_i                &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,…
## $ s20_j                &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,…
## $ s20_k                &lt;fct&gt; 2, 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2,…
## $ s21a                 &lt;dbl&gt; 21, NA, 26, NA, NA, NA, NA, NA, NA, NA…
## $ s21b                 &lt;fct&gt; 15, 5, 15, NA, NA, NA, NA, NA, NA, NA,…
## $ s22_a                &lt;fct&gt; 1, 1, 3, NA, NA, NA, NA, NA, NA, NA, N…
## $ s22_b                &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ s23                  &lt;fct&gt; 1, 4, 1, NA, NA, NA, NA, NA, NA, NA, N…
## $ s24                  &lt;fct&gt; 3, 2, 3, 2, 3, 3, 3, 2, 2, 3, 2, 2, 4,…
## $ reeeduc_1            &lt;fct&gt; 4, 2, 6, 6, 5, 6, 2, 2, 6, 6, 5, 2, 6,…
## $ reeduc_2             &lt;fct&gt; 2, 2, 7, 3, 3, 2, 2, 1, 6, 2, 3, 1, 2,…
## $ reeduc_3             &lt;fct&gt; 7, 2, 7, NA, NA, NA, NA, NA, NA, NA, N…
## $ reedad               &lt;fct&gt; 3, 2, 1, 3, 3, 2, 3, 4, 2, 3, 2, 4, 1,…
## $ perpart              &lt;fct&gt; 1, 1, 2, 3, 1, 1, 2, 1, 2, 1, 1, 1, 1,…
## $ fampart              &lt;fct&gt; 30, 30, 40, 20, 20, 30, 40, 30, 30, 30…
## $ wt                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ data_base            &lt;date&gt; 2023-03-03, 2023-03-03, 2023-03-03, 2…
## $ idade                &lt;int&gt; 4949181, 3235309, 1609495, 4144420, 40…
## $ econ_12_meses        &lt;fct&gt; other, other, better, better, other, o…
## $ aprovacao_presidente &lt;int&gt; 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1,…
## $ ideologia            &lt;int&gt; 6, 7, 7, 6, 7, 6, 11, 11, 6, 9, 6, 8, …
## $ votaria_governo      &lt;dbl&gt; 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1,…
## $ genero               &lt;fct&gt; mulher, mulher, mulher, homem, homem, …
## $ evangelico           &lt;dbl&gt; 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0,…</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="regressao-multipla.html#cb286-1" tabindex="-1"></a>reg_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(votaria_governo <span class="sc">~</span> ideologia <span class="sc">+</span> idade <span class="sc">+</span> genero <span class="sc">+</span> econ_12_meses <span class="sc">+</span> evangelico, <span class="at">data=</span>br_latbar_23 )</span>
<span id="cb286-2"><a href="regressao-multipla.html#cb286-2" tabindex="-1"></a><span class="fu">summary</span>(reg_full)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = votaria_governo ~ ideologia + idade + genero + econ_12_meses + 
##     evangelico, data = br_latbar_23)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0002 -0.3261  0.1037  0.3224  0.6924 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          8.859e-01  7.719e-02  11.477  &lt; 2e-16 ***
## ideologia           -3.860e-02  5.622e-03  -6.866 2.40e-11 ***
## idade               -4.189e-09  1.594e-08  -0.263  0.79280    
## generomulher         1.195e-01  3.860e-02   3.097  0.00209 ** 
## econ_12_mesesbetter  1.766e-01  3.970e-02   4.448 1.11e-05 ***
## evangelico          -1.445e-01  4.510e-02  -3.204  0.00146 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3949 on 417 degrees of freedom
##   (49 observations deleted due to missingness)
## Multiple R-squared:  0.2274, Adjusted R-squared:  0.2181 
## F-statistic: 24.55 on 5 and 417 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="regressao-multipla.html#cb288-1" tabindex="-1"></a>residuos_full <span class="ot">&lt;-</span> <span class="fu">resid</span>(reg_full)</span>
<span id="cb288-2"><a href="regressao-multipla.html#cb288-2" tabindex="-1"></a></span>
<span id="cb288-3"><a href="regressao-multipla.html#cb288-3" tabindex="-1"></a>reg_res_evan <span class="ot">&lt;-</span> <span class="fu">lm</span>(votaria_governo <span class="sc">~</span> ideologia <span class="sc">+</span> idade <span class="sc">+</span> genero <span class="sc">+</span> econ_12_meses, <span class="at">data=</span>br_latbar_23 )</span>
<span id="cb288-4"><a href="regressao-multipla.html#cb288-4" tabindex="-1"></a><span class="fu">summary</span>(reg_res_evan)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = votaria_governo ~ ideologia + idade + genero + econ_12_meses, 
##     data = br_latbar_23)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.99732 -0.39237  0.09575  0.30292  0.60771 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          8.477e-01  7.710e-02  10.994  &lt; 2e-16 ***
## ideologia           -4.141e-02  5.615e-03  -7.375 8.90e-13 ***
## idade                6.369e-11  1.606e-08   0.004  0.99684    
## generomulher         1.141e-01  3.899e-02   2.925  0.00363 ** 
## econ_12_mesesbetter  1.907e-01  3.989e-02   4.781 2.42e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3993 on 418 degrees of freedom
##   (49 observations deleted due to missingness)
## Multiple R-squared:  0.2084, Adjusted R-squared:  0.2008 
## F-statistic: 27.51 on 4 and 418 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="regressao-multipla.html#cb290-1" tabindex="-1"></a>residuos_res_evan <span class="ot">&lt;-</span> <span class="fu">resid</span>(reg_res_evan)</span>
<span id="cb290-2"><a href="regressao-multipla.html#cb290-2" tabindex="-1"></a></span>
<span id="cb290-3"><a href="regressao-multipla.html#cb290-3" tabindex="-1"></a>partial_R2_evangelico <span class="ot">&lt;-</span> (<span class="fu">sum</span>(residuos_res_evan<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">sum</span>(residuos_full<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sum</span>(residuos_res_evan<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb290-4"><a href="regressao-multipla.html#cb290-4" tabindex="-1"></a><span class="fu">print</span>(partial_R2_evangelico)</span></code></pre></div>
<pre><code>## [1] 0.02402629</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="regressao-multipla.html#cb292-1" tabindex="-1"></a><span class="co"># alternative</span></span>
<span id="cb292-2"><a href="regressao-multipla.html#cb292-2" tabindex="-1"></a>partial_R2_evangelico_alt <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">var</span>(<span class="fu">resid</span>(reg_full))<span class="sc">/</span><span class="fu">var</span>(<span class="fu">resid</span>(reg_res_evan))</span>
<span id="cb292-3"><a href="regressao-multipla.html#cb292-3" tabindex="-1"></a><span class="fu">print</span>(partial_R2_evangelico_alt)</span></code></pre></div>
<pre><code>## [1] 0.02402629</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="regressao-multipla.html#cb294-1" tabindex="-1"></a><span class="co"># another alternative</span></span>
<span id="cb294-2"><a href="regressao-multipla.html#cb294-2" tabindex="-1"></a>reg_evan <span class="ot">&lt;-</span> <span class="fu">lm</span>(evangelico <span class="sc">~</span> ideologia <span class="sc">+</span> idade <span class="sc">+</span> genero <span class="sc">+</span> econ_12_meses , <span class="at">data=</span>br_latbar_23)</span>
<span id="cb294-3"><a href="regressao-multipla.html#cb294-3" tabindex="-1"></a></span>
<span id="cb294-4"><a href="regressao-multipla.html#cb294-4" tabindex="-1"></a>partial_R2_evangelico_alt1 <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">resid</span>(reg_evan), <span class="fu">resid</span>(reg_res_evan))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb294-5"><a href="regressao-multipla.html#cb294-5" tabindex="-1"></a><span class="fu">print</span>(partial_R2_evangelico_alt1)</span></code></pre></div>
<pre><code>## [1] 0.02402629</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="regressao-multipla.html#cb296-1" tabindex="-1"></a> <span class="do">## Cohen partial f2</span></span>
<span id="cb296-2"><a href="regressao-multipla.html#cb296-2" tabindex="-1"></a>r_squared_full <span class="ot">&lt;-</span> <span class="fu">summary</span>(reg_full)<span class="sc">$</span>r.squared</span>
<span id="cb296-3"><a href="regressao-multipla.html#cb296-3" tabindex="-1"></a>r_squared_res <span class="ot">&lt;-</span> <span class="fu">summary</span>(reg_res_evan)<span class="sc">$</span>r.squared</span>
<span id="cb296-4"><a href="regressao-multipla.html#cb296-4" tabindex="-1"></a></span>
<span id="cb296-5"><a href="regressao-multipla.html#cb296-5" tabindex="-1"></a>partial_f2 <span class="ot">&lt;-</span> (r_squared_full <span class="sc">-</span> r_squared_res)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>r_squared_full)</span>
<span id="cb296-6"><a href="regressao-multipla.html#cb296-6" tabindex="-1"></a><span class="fu">print</span>(partial_f2)</span></code></pre></div>
<pre><code>## [1] 0.02461776</code></pre>
<p>E agora podemos reescrever o viés de variável omitida em termos do R-quadrado parcial.</p>
</div>
<div id="viés-de-variável-omitida" class="section level3 hasAnchor" number="12.10.2">
<h3><span class="header-section-number">12.10.2</span> Viés de variável omitida<a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nós vimos que o viés de variável omitida, em uma amostra, pode ser explicitado por:
<span class="math display">\[
\hat{\beta_1^*} = \hat{\beta_1} + \frac{\hat{\beta_2} \cdot \mathbb{Cov}[X_1, X_2]}{\mathbb{Var}[X_1]}
\]</span>
Vamos reescrever essa equação do seguinte modo. Seja <span class="math inline">\(\frac{\mathbb{Cov}[X_1, X_2]}{\mathbb{Var}[X_1]} = \hat{\gamma}\)</span>, então noss equação fica:
<span class="math display">\[
\hat{\beta_1^*} = \hat{\beta_1} + \hat{\beta_2} \cdot \hat{\gamma}
\]</span></p>
<p>Em que <span class="math inline">\(\hat{\beta_2}\)</span> mede o “impacto” da variável omitida sobre Y. Ou seja, ela mede a diferença na esperança linear da resposta (diferença média) entre indivíduos que diferem em uma unidade na variável omitida e têm o mesmo status no tratamento, bem como o mesmo valor para todas as variáveis de controle restante. Digamos que estou interessado em estimar o efeito causal da experiência (variávle binária, experiente ou não experiente) sobre votação. Candidatas mais experientes devem ter mais votos, mas também maior visibilidade e reconhecimento, o que viesa a regressão (efeito da experiência). Suponha que controlei para arrecadação de campanha. Então, <span class="math inline">\(\hat{\gamma}\)</span> mede a diferença esperada (média) na votação entre pessoas experinetes (tratamento = 1) com uma mesma dada arrecadação de campanha, mas que difiram em uma unidade em visibilidade.</p>
<p>Já a Quantidade <span class="math inline">\(\hat{\gamma}\)</span> parece que mede o impacto de Z sobre o tratamento, mas na verdade ela é resultado da regressão reversa, isto é, <span class="math inline">\(Z = \hat{\alpha_1} + \hat{\gamma} T + \hat{\psi} X + \hat{u}\)</span>. Ou seja, mede a diferença média na variável de confusão entre indivíduos que diferem de uma unidade no tratamento. Em nosso exemplo, como candidatas experientes diferem em visibilidade, em média, de não experientes. Ainda em outras palavras, mede o “balanceamento” (condicional aos controles) entre indivíduos alocados pro tratamento e controle no que diz respeito à variável omitida.</p>
<p>Essa formulação é útil para pensar sobre como o viés de variável omitida impacta nossas estimativas. Quanto maior o “imbalance”, maior será <span class="math inline">\(\hat{\gamma}\)</span>. Similarmente, quanto maior o impacto da variável omitida na resposta, maior <span class="math inline">\(\hat{\beta_2}\)</span>. Por isso que é comum checar o imbalance nas variáveis de controle. Se ele é alto, pode significar alto viés das variáveis omitidas, se o imbalance delas for correlacionado com o imbalance das variáveis de controle.</p>
<p>Numa regressão mais completa, da forma, <span class="math inline">\(y = \alpha + \delta T + \beta X + \beta_2 Z + e\)</span>, em que <span class="math inline">\(T\)</span> é o tratamento, <span class="math inline">\(X\)</span> controles e <span class="math inline">\(Z\)</span> a variável omitida, o viés pode ser reescrito como:
<span class="math display">\[
\hat{&lt;viés&gt;} = \hat{\beta_2} \cdot \hat{\gamma}
\]</span>
Em que $ hat{} = $</p>
</div>
<div id="viés-de-variável-omitida-em-função-do-r-quadrado" class="section level3 hasAnchor" number="12.10.3">
<h3><span class="header-section-number">12.10.3</span> Viés de variável omitida em função do R-quadrado<a href="#vi%C3%A9s-de-vari%C3%A1vel-omitida-em-fun%C3%A7%C3%A3o-do-r-quadrado" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\hat{&lt;viés&gt;} = \sqrt{\frac{R^2_{y\sim Z|T,X} R^2_{T \sim Z|X}}{1 - R^2_{T \sim Z|X}}} \cdot \frac{sd(Y^{\perp X,T})}{sd(T^{\perp X})}
\]</span></p>
<p>Vamos olhar cada componente dessa parametrização do viés:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(R^2_{y\sim Z|T,X}\)</span> é o R-quadrado parcial de <span class="math inline">\(Z\)</span> com relação à variável resposta <span class="math inline">\(y\)</span> controlando para <span class="math inline">\(T\)</span>, o tratamento, e <span class="math inline">\(X\)</span> os controles. Ou seja, quanto <span class="math inline">\(Z\)</span> contribui para explicar a variação em <span class="math inline">\(Y\)</span>, após descontar a explicação de <span class="math inline">\(X\)</span> e <span class="math inline">\(T\)</span>.</p></li>
<li><p><span class="math inline">\(R^2_{T \sim Z|X}\)</span> é o R-quadrado parcial de <span class="math inline">\(Z\)</span> com relação à variável dependente <span class="math inline">\(T\)</span>, o tratamento. Ou seja, quanto a variável omitida explica do tratamento, após descontar a explicação na variância dos controles.</p></li>
<li><p><span class="math inline">\(1 - R^2_{T \sim Z|X}\)</span> é o complemento do R-quadrado parcial de Z sobre T, após controlar para <span class="math inline">\(X\)</span>. Representa a variância não-explicada em <span class="math inline">\(T\)</span> por <span class="math inline">\(Z\)</span> após descontar a influência de <span class="math inline">\(X\)</span>.</p></li>
</ol>
<p>E os demais termos são os desvios-padrões dos resíduos da regressão restrita, sem a variável não-observada <span class="math inline">\(Z\)</span> e da regressão do tratamento em função dos controles. Em nosso exemplo, nós observamos a variável regilião evangélica, mas vamos supor que não é calcular o viés de variável omitida pela fórmula tradicional.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="regressao-multipla.html#cb298-1" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb298-2"><a href="regressao-multipla.html#cb298-2" tabindex="-1"></a><span class="co"># tratamento é ideologia.</span></span>
<span id="cb298-3"><a href="regressao-multipla.html#cb298-3" tabindex="-1"></a><span class="co"># omitida é religião</span></span>
<span id="cb298-4"><a href="regressao-multipla.html#cb298-4" tabindex="-1"></a></span>
<span id="cb298-5"><a href="regressao-multipla.html#cb298-5" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg_full)[<span class="dv">6</span>]</span>
<span id="cb298-6"><a href="regressao-multipla.html#cb298-6" tabindex="-1"></a>cov_x1x2 <span class="ot">&lt;-</span> <span class="fu">cov</span>(br_latbar_23<span class="sc">$</span>ideologia, br_latbar_23<span class="sc">$</span>evangelico)</span>
<span id="cb298-7"><a href="regressao-multipla.html#cb298-7" tabindex="-1"></a>var_x1 <span class="ot">&lt;-</span> <span class="fu">var</span>(br_latbar_23<span class="sc">$</span>ideologia)</span>
<span id="cb298-8"><a href="regressao-multipla.html#cb298-8" tabindex="-1"></a>vies <span class="ot">&lt;-</span> beta2<span class="sc">*</span>cov_x1x2<span class="sc">/</span>var_x1</span>
<span id="cb298-9"><a href="regressao-multipla.html#cb298-9" tabindex="-1"></a><span class="fu">print</span>(vies)</span></code></pre></div>
<pre><code>##   evangelico 
## -0.002611602</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="regressao-multipla.html#cb300-1" tabindex="-1"></a>coef_res_sem_vies <span class="ot">=</span> <span class="fu">coef</span>(reg_res_evan)[<span class="dv">2</span>] <span class="sc">-</span> vies</span>
<span id="cb300-2"><a href="regressao-multipla.html#cb300-2" tabindex="-1"></a><span class="fu">all.equal</span>(coef_res_sem_vies, <span class="fu">coef</span>(reg_full)[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] &quot;Mean relative difference: 0.005018672&quot;</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="regressao-multipla.html#cb302-1" tabindex="-1"></a>coef_res_sem_vies <span class="sc">-</span> <span class="fu">coef</span>(reg_full)[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>##     ideologia 
## -0.0001947166</code></pre>
<p>O que essa equação nos mostra é que o viés depende de quanto a variável omitida explica o tratamento e quanto o tratamento é explicado pela variável omitida. O que é bastante intuitivo. E para entender melhor essa equação, vale falar o viés de relativo, definido como a razão entre o viés estimado e o coeifciente do tratamento estimado.</p>
<p><span class="math display">\[
Viés relatrivo = \frac{\hat{&lt;viés&gt;}}{\hat{\beta_1}} = \frac{f(R^2_{y\sim Z|T,X},  R^2_{D \sim Z|X)})}{t_-do_-tratamento \cdot \sqrt(df)}
\]</span></p>
<p>a parcela da variável resposta que o tratamento explica (medida pelo R-quadrado parcial do tratamento) dá uma medida da robustez da regressão à potenciais vieses de variável omitida. Uma intuição simples é que se o tratamento explicar 100% da variação, então não há, por definição, viés de variável omitida. Se explicar 95%, há muito pouco que um viés de variável omitida pode viesar as estimativas.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="regressao-multipla.html#cb304-1" tabindex="-1"></a><span class="fu">library</span>(sensemakr)</span>
<span id="cb304-2"><a href="regressao-multipla.html#cb304-2" tabindex="-1"></a></span>
<span id="cb304-3"><a href="regressao-multipla.html#cb304-3" tabindex="-1"></a><span class="co"># loads dataset</span></span>
<span id="cb304-4"><a href="regressao-multipla.html#cb304-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;darfur&quot;</span>)</span>
<span id="cb304-5"><a href="regressao-multipla.html#cb304-5" tabindex="-1"></a></span>
<span id="cb304-6"><a href="regressao-multipla.html#cb304-6" tabindex="-1"></a><span class="co"># runs regression model</span></span>
<span id="cb304-7"><a href="regressao-multipla.html#cb304-7" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(peacefactor <span class="sc">~</span> directlyharmed <span class="sc">+</span> age <span class="sc">+</span> farmer_dar <span class="sc">+</span> herder_dar <span class="sc">+</span></span>
<span id="cb304-8"><a href="regressao-multipla.html#cb304-8" tabindex="-1"></a>                         pastvoted <span class="sc">+</span> hhsize_darfur <span class="sc">+</span> female <span class="sc">+</span> village, <span class="at">data =</span> darfur)</span>
<span id="cb304-9"><a href="regressao-multipla.html#cb304-9" tabindex="-1"></a></span>
<span id="cb304-10"><a href="regressao-multipla.html#cb304-10" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = peacefactor ~ directlyharmed + age + farmer_dar + 
##     herder_dar + pastvoted + hhsize_darfur + female + village, 
##     data = darfur)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.67487 -0.14712  0.00000  0.09857  0.90307 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                 1.0818918  0.3149160   3.435 0.000623
## directlyharmed              0.0973158  0.0232565   4.184 3.18e-05
## age                        -0.0020717  0.0008232  -2.517 0.012044
## farmer_dar                 -0.0404429  0.0292449  -1.383 0.167087
## herder_dar                  0.0142791  0.0321319   0.444 0.656884
## pastvoted                  -0.0480250  0.0240462  -1.997 0.046150
## hhsize_darfur               0.0012298  0.0019277   0.638 0.523685
## female                     -0.2320514  0.0237057  -9.789  &lt; 2e-16
## villageAbdi Dar            -0.0192558  0.4411017  -0.044 0.965191
## villageAbu Dejaj           -0.7197809  0.3609182  -1.994 0.046465
## villageAbu Gamra           -0.5271364  0.3151842  -1.672 0.094831
## villageAbu Gawar           -1.0657332  0.4418454  -2.412 0.016094
## villageAbu Geran           -0.8733307  0.3819967  -2.286 0.022507
## villageAbu Jidad           -0.4878930  0.3826800  -1.275 0.202710
## villageAbu Lihya           -0.5707994  0.3477972  -1.641 0.101161
## villageAbu Mugu            -0.9671213  0.4407133  -2.194 0.028496
## villageAbu Shouka          -0.7249739  0.4415203  -1.642 0.100993
## villageAbu Sorog           -0.5959154  0.3598746  -1.656 0.098143
## villageAbune               -0.6855577  0.4402757  -1.557 0.119849
## villageAdar                -0.5229708  0.3172264  -1.649 0.099636
## villageAgadier             -0.4777710  0.4409077  -1.084 0.278872
## villageAgudna              -0.8405289  0.4418986  -1.902 0.057527
## villageAgumi               -0.7306179  0.4408603  -1.657 0.097869
## villageAid Alkhair         -0.3317194  0.3594243  -0.923 0.356334
## villageAirgy               -1.0462455  0.4418388  -2.368 0.018130
## villageAish Barra          -0.4528391  0.3422855  -1.323 0.186226
## villageAjayana             -0.9536066  0.4411943  -2.161 0.030965
## villageAjiji               -0.1441859  0.4411427  -0.327 0.743871
## villageAkomi               -0.6962401  0.4410606  -1.579 0.114841
## villageAl Gedisa           -0.1618676  0.4402377  -0.368 0.713210
## villageAl Geneina          -0.5089806  0.3595054  -1.416 0.157238
## villageAllah Forga         -0.6846515  0.4413098  -1.551 0.121208
## villageAlmetrabia          -0.8571347  0.4411693  -1.943 0.052390
## villageAm Baro             -0.4399481  0.3493009  -1.260 0.208221
## villageAm Dalal            -0.3310802  0.3605518  -0.918 0.358766
## villageAm Dariro           -0.4589021  0.4416337  -1.039 0.299078
## villageAm Dukhn            -0.6986997  0.4408066  -1.585 0.113359
## villageAm Jarad            -0.0324659  0.4402236  -0.074 0.941229
## villageAm Jemma            -0.4549818  0.4410044  -1.032 0.302534
## villageAm Kharouba         -0.8496693  0.4415697  -1.924 0.054691
## villageAmar                -0.8092879  0.4416047  -1.833 0.067241
## villageAmdukhn             -0.6676235  0.4412174  -1.513 0.130648
## villageAndabook            -0.1478622  0.4418610  -0.335 0.737990
## villageAnderola            -0.6171842  0.4412653  -1.399 0.162308
## villageAndita              -0.3409366  0.3828738  -0.890 0.373489
## villageAnjilati            -0.1729516  0.4415549  -0.392 0.695396
## villageAnjokati            -0.4587088  0.4416816  -1.039 0.299334
## villageAorda               -0.5289973  0.4406382  -1.201 0.230298
## villageAradeeba            -0.7560845  0.4427057  -1.708 0.088057
## villageArara               -0.5076057  0.3367427  -1.507 0.132112
## villageArgote              -0.5396439  0.4423977  -1.220 0.222902
## villageArgoy                0.0149665  0.4432207   0.034 0.973071
## villageArimba              -0.6829014  0.4406053  -1.550 0.121566
## villageArmi                -0.6461755  0.4424048  -1.461 0.144527
## villageArola               -0.8283216  0.4413782  -1.877 0.060935
## villageAroom               -0.8244814  0.3268598  -2.522 0.011852
## villageArsa                 0.0352721  0.4415647   0.080 0.936353
## villageArsaliya            -0.4433270  0.4407646  -1.006 0.314816
## villageAsirni              -0.5386620  0.3496601  -1.541 0.123835
## villageAta                 -0.3173291  0.4414191  -0.719 0.472427
## villageAurab               -0.5240046  0.4433175  -1.182 0.237562
## villageAwrish              -0.9556967  0.4400959  -2.172 0.030188
## villageAwSanga             -0.2316845  0.4406254  -0.526 0.599170
## villageBadaria             -0.7452505  0.4399552  -1.694 0.090677
## villageBajourba            -0.8023955  0.4418360  -1.816 0.069745
## villageBakjo               -0.7543060  0.4417158  -1.708 0.088094
## villageBaldi               -0.6176931  0.4422282  -1.397 0.162877
## villageBandis              -0.6918758  0.3273657  -2.113 0.034877
## villageBango               -0.4402689  0.4413116  -0.998 0.318764
## villageBaranga             -0.7021792  0.3826181  -1.835 0.066856
## villageBardia              -0.5500589  0.3612288  -1.523 0.128226
## villageBare                -0.7405756  0.4423093  -1.674 0.094463
## villageBarkhalla           -0.6033473  0.4420309  -1.365 0.172663
## villageBasaw                0.0344349  0.4416336   0.078 0.937870
## villageBeero               -0.7571496  0.4422768  -1.712 0.087304
## villageBeida               -0.3995823  0.3228242  -1.238 0.216172
## villageBeir Saliba         -0.4969939  0.3239577  -1.534 0.125401
## villageBerdia              -0.4840524  0.4415632  -1.096 0.273318
## villageBertabid            -0.6213939  0.4418463  -1.406 0.160015
## villageBida Alginina        0.0506031  0.4404663   0.115 0.908565
## villageBidigy              -0.7467247  0.4416074  -1.691 0.091249
## villageBidt Faraga         -0.4182936  0.4412517  -0.948 0.343437
## villageBier Saliba         -0.1137829  0.4401430  -0.259 0.796079
## villageBiera               -0.9352163  0.4398015  -2.126 0.033778
## villageBigaga              -0.8191926  0.4412653  -1.856 0.063763
## villageBinary Mbila        -0.7419358  0.4410630  -1.682 0.092938
## villageBindis              -0.5660965  0.3226974  -1.754 0.079776
## villageBinediyah           -0.4636796  0.4420565  -1.049 0.294541
## villageBiot Mofarag        -0.2313714  0.4416336  -0.524 0.600497
## villageBir Tabat           -0.3855859  0.3811145  -1.012 0.311979
## villageBirdeya             -0.5674605  0.3816577  -1.487 0.137462
## villageBireiga             -0.8047992  0.4405760  -1.827 0.068126
## villageBirgy               -0.2774692  0.4422840  -0.627 0.530609
## villageBirhaliba           -0.5028462  0.4415694  -1.139 0.255147
## villageBirtabit            -0.4326597  0.4403429  -0.983 0.326132
## villageBla Al Biyya        -0.5203886  0.4415373  -1.179 0.238922
## villageBoba                -0.3232529  0.3613616  -0.895 0.371307
## villageBoranga             -0.8938475  0.4405666  -2.029 0.042811
## villageBorat               -0.8254741  0.4418505  -1.868 0.062105
## villageBorgio              -0.2946768  0.4428656  -0.665 0.505999
## villageBoymawang           -0.4645084  0.4443430  -1.045 0.296169
## villageBrega               -0.6417835  0.3602645  -1.781 0.075231
## villageBukar               -0.2129811  0.4405112  -0.483 0.628886
## villageCoda Mee            -0.7370959  0.4411427  -1.671 0.095145
## villageCongi               -0.7041392  0.4412732  -1.596 0.110960
## villageDabaky              -0.8039146  0.4417510  -1.820 0.069166
## villageDabis               -0.7910301  0.4415104  -1.792 0.073576
## villageDagjor              -0.8288332  0.3827254  -2.166 0.030642
## villageDalta               -0.6429420  0.4415115  -1.456 0.145730
## villageDamra               -0.6914967  0.3418709  -2.023 0.043445
## villageDangojaro            0.2739928  0.4417491   0.620 0.535277
## villageDanko               -1.0656670  0.4413197  -2.415 0.015975
## villageDardure             -0.8440405  0.4424176  -1.908 0.056784
## villageDargily             -0.2051507  0.4417229  -0.464 0.642467
## villageDasa                -0.7082827  0.4412540  -1.605 0.108862
## villageDeegada             -0.9721730  0.4414091  -2.202 0.027926
## villageDeero               -0.9531525  0.4407434  -2.163 0.030874
## villageDengar              -1.0573931  0.4404987  -2.400 0.016608
## villageDerenda             -0.9407220  0.4406995  -2.135 0.033103
## villageDerisa              -0.7284137  0.4400596  -1.655 0.098272
## villageDinbo Kabdi         -0.0762685  0.4416960  -0.173 0.862954
## villageDingajour           -0.8460460  0.4419309  -1.914 0.055929
## villageDinjir              -0.4258255  0.4402739  -0.967 0.333751
## villageDirdkna             -0.9290673  0.4402316  -2.110 0.035140
## villageDirgily             -0.1909702  0.4414838  -0.433 0.665450
## villageDiria               -0.0321443  0.4405844  -0.073 0.941858
## villageDirisa              -0.8467204  0.3827434  -2.212 0.027238
## villageDiro                -0.6413792  0.3827291  -1.676 0.094176
## villageDofata              -0.4621368  0.4414224  -1.047 0.295457
## villageDongita             -0.2273873  0.4415117  -0.515 0.606684
## villageDoty                -0.7117490  0.4414669  -1.612 0.107313
## villageDoudata             -0.4053538  0.4413884  -0.918 0.358713
## villageDriol               -0.1273862  0.4405906  -0.289 0.772561
## villageDunjurou            -0.7430352  0.4420034  -1.681 0.093150
## villageEid Elkhair          0.1471996  0.4413397   0.334 0.738824
## villageEish Bida           -0.7091246  0.4413971  -1.607 0.108557
## villageEl Fasher           -0.1290909  0.3826521  -0.337 0.735937
## villageFanginta            -0.4996049  0.4408992  -1.133 0.257498
## villageFarne               -0.7184251  0.4406761  -1.630 0.103445
## villageFew                  0.0489193  0.4407322   0.111 0.911648
## villageFokdo               -0.6846515  0.4413098  -1.551 0.121208
## villageFondlayat           -0.6371146  0.4413502  -1.444 0.149263
## villageFonu                -0.3863996  0.3823911  -1.010 0.312576
## villageFur Baranga         -0.4722050  0.4427732  -1.066 0.286539
## villageFur Barenga         -0.5386874  0.3816931  -1.411 0.158550
## villageFurawiya            -0.4018213  0.3160416  -1.271 0.203957
## villageFuraWiya            -0.6767524  0.4411722  -1.534 0.125437
## villageFuro                -0.7078286  0.4408655  -1.606 0.108778
## villageGadir               -0.7980483  0.3827604  -2.085 0.037394
## villageGalala              -0.8499320  0.4411201  -1.927 0.054371
## villageGarady               0.0872493  0.4409768   0.198 0.843210
## villageGarsila             -0.4646958  0.3602177  -1.290 0.197417
## villageGasheeb             -1.1054843  0.4417947  -2.502 0.012543
## villageGasimba             -0.3270378  0.3824628  -0.855 0.392766
## villageGasmina             -0.8672176  0.4422053  -1.961 0.050219
## villageGebeesh             -0.6337299  0.3604515  -1.758 0.079112
## villageGedernii            -0.0239234  0.4411098  -0.054 0.956762
## villageGemana              -0.7725639  0.4418454  -1.748 0.080770
## villageGemena              -0.7589281  0.3830921  -1.981 0.047934
## villageGhibish             -0.1200345  0.4401247  -0.273 0.785134
## villageGhoz Doggy          -0.3848804  0.4415179  -0.872 0.383628
## villageGinfara             -0.7091246  0.4413971  -1.607 0.108557
## villageGirgida             -0.4931539  0.3249533  -1.518 0.129515
## villageGobi                -0.7791942  0.3265448  -2.386 0.017261
## villageGodambi             -0.7320502  0.4416464  -1.658 0.097809
## villageGogar                0.0249566  0.4418816   0.056 0.954975
## villageGoji                -0.7924017  0.4418578  -1.793 0.073304
## villageGondilat            -0.7105749  0.3420180  -2.078 0.038072
## villageGono                -0.5032090  0.3826007  -1.315 0.188817
## villageGoraba              -0.7503344  0.3830636  -1.959 0.050494
## villageGorboki             -0.5462044  0.3410967  -1.601 0.109710
## villageGoroku              -0.7194172  0.4407247  -1.632 0.103008
## villageGosimba             -0.1532168  0.4414278  -0.347 0.728614
## villageGoslayat            -0.2325307  0.3820374  -0.609 0.542927
## villageGouba                0.0523001  0.4412564   0.119 0.905682
## villageGoz Bagar           -0.5075722  0.3596931  -1.411 0.158605
## villageGoz Beida           -0.4741205  0.3830058  -1.238 0.216126
## villageGoz Deega           -0.5603087  0.3386511  -1.655 0.098420
## villageGoz Gabor           -0.0629400  0.4410408  -0.143 0.886558
## villageGoz Mono            -0.4840189  0.3814558  -1.269 0.204863
## villageGttara              -0.8632253  0.4415476  -1.955 0.050939
## villageGubbey              -0.5120457  0.3814134  -1.342 0.179825
## villageHabila              -0.6333912  0.3312515  -1.912 0.056226
## villageHabshaba            -0.0210759  0.4416653  -0.048 0.961952
## villageHadjer Suleiman     -0.6158241  0.3827020  -1.609 0.107987
## villageHai Jadid           -0.7498481  0.4402517  -1.703 0.088923
## villageHajar farkhabta      0.0133910  0.4408325   0.030 0.975774
## villageHajar Kharkhita     -0.9514686  0.4404759  -2.160 0.031068
## villageHajar Seleman       -0.7623162  0.4413206  -1.727 0.084499
## villageHajilija            -1.0471667  0.4414993  -2.372 0.017941
## villageHaleila             -0.3347389  0.3830161  -0.874 0.382411
## villageHara                -0.2983782  0.4418256  -0.675 0.499665
## villageHarkow              -0.7728384  0.4420899  -1.748 0.080830
## villageHashaba             -0.2023767  0.3827321  -0.529 0.597116
## villageHaskanita           -0.7814071  0.3819002  -2.046 0.041080
## villageHee Al Gameena      -0.7957580  0.4409485  -1.805 0.071513
## villageHeemada             -1.0593079  0.4413909  -2.400 0.016631
## villageHijileja            -0.5584427  0.4421291  -1.263 0.206938
## villageHila Haraz          -0.7607728  0.4412846  -1.724 0.085103
## villageHila Jadad           0.0489986  0.4411090   0.111 0.911581
##                               
## (Intercept)                ***
## directlyharmed             ***
## age                        *  
## farmer_dar                    
## herder_dar                    
## pastvoted                  *  
## hhsize_darfur                 
## female                     ***
## villageAbdi Dar               
## villageAbu Dejaj           *  
## villageAbu Gamra           .  
## villageAbu Gawar           *  
## villageAbu Geran           *  
## villageAbu Jidad              
## villageAbu Lihya              
## villageAbu Mugu            *  
## villageAbu Shouka             
## villageAbu Sorog           .  
## villageAbune                  
## villageAdar                .  
## villageAgadier                
## villageAgudna              .  
## villageAgumi               .  
## villageAid Alkhair            
## villageAirgy               *  
## villageAish Barra             
## villageAjayana             *  
## villageAjiji                  
## villageAkomi                  
## villageAl Gedisa              
## villageAl Geneina             
## villageAllah Forga            
## villageAlmetrabia          .  
## villageAm Baro                
## villageAm Dalal               
## villageAm Dariro              
## villageAm Dukhn               
## villageAm Jarad               
## villageAm Jemma               
## villageAm Kharouba         .  
## villageAmar                .  
## villageAmdukhn                
## villageAndabook               
## villageAnderola               
## villageAndita                 
## villageAnjilati               
## villageAnjokati               
## villageAorda                  
## villageAradeeba            .  
## villageArara                  
## villageArgote                 
## villageArgoy                  
## villageArimba                 
## villageArmi                   
## villageArola               .  
## villageAroom               *  
## villageArsa                   
## villageArsaliya               
## villageAsirni                 
## villageAta                    
## villageAurab                  
## villageAwrish              *  
## villageAwSanga                
## villageBadaria             .  
## villageBajourba            .  
## villageBakjo               .  
## villageBaldi                  
## villageBandis              *  
## villageBango                  
## villageBaranga             .  
## villageBardia                 
## villageBare                .  
## villageBarkhalla              
## villageBasaw                  
## villageBeero               .  
## villageBeida                  
## villageBeir Saliba            
## villageBerdia                 
## villageBertabid               
## villageBida Alginina          
## villageBidigy              .  
## villageBidt Faraga            
## villageBier Saliba            
## villageBiera               *  
## villageBigaga              .  
## villageBinary Mbila        .  
## villageBindis              .  
## villageBinediyah              
## villageBiot Mofarag           
## villageBir Tabat              
## villageBirdeya                
## villageBireiga             .  
## villageBirgy                  
## villageBirhaliba              
## villageBirtabit               
## villageBla Al Biyya           
## villageBoba                   
## villageBoranga             *  
## villageBorat               .  
## villageBorgio                 
## villageBoymawang              
## villageBrega               .  
## villageBukar                  
## villageCoda Mee            .  
## villageCongi                  
## villageDabaky              .  
## villageDabis               .  
## villageDagjor              *  
## villageDalta                  
## villageDamra               *  
## villageDangojaro              
## villageDanko               *  
## villageDardure             .  
## villageDargily                
## villageDasa                   
## villageDeegada             *  
## villageDeero               *  
## villageDengar              *  
## villageDerenda             *  
## villageDerisa              .  
## villageDinbo Kabdi            
## villageDingajour           .  
## villageDinjir                 
## villageDirdkna             *  
## villageDirgily                
## villageDiria                  
## villageDirisa              *  
## villageDiro                .  
## villageDofata                 
## villageDongita                
## villageDoty                   
## villageDoudata                
## villageDriol                  
## villageDunjurou            .  
## villageEid Elkhair            
## villageEish Bida              
## villageEl Fasher              
## villageFanginta               
## villageFarne                  
## villageFew                    
## villageFokdo                  
## villageFondlayat              
## villageFonu                   
## villageFur Baranga            
## villageFur Barenga            
## villageFurawiya               
## villageFuraWiya               
## villageFuro                   
## villageGadir               *  
## villageGalala              .  
## villageGarady                 
## villageGarsila                
## villageGasheeb             *  
## villageGasimba                
## villageGasmina             .  
## villageGebeesh             .  
## villageGedernii               
## villageGemana              .  
## villageGemena              *  
## villageGhibish                
## villageGhoz Doggy             
## villageGinfara                
## villageGirgida                
## villageGobi                *  
## villageGodambi             .  
## villageGogar                  
## villageGoji                .  
## villageGondilat            *  
## villageGono                   
## villageGoraba              .  
## villageGorboki                
## villageGoroku                 
## villageGosimba                
## villageGoslayat               
## villageGouba                  
## villageGoz Bagar              
## villageGoz Beida              
## villageGoz Deega           .  
## villageGoz Gabor              
## villageGoz Mono               
## villageGttara              .  
## villageGubbey                 
## villageHabila              .  
## villageHabshaba               
## villageHadjer Suleiman        
## villageHai Jadid           .  
## villageHajar farkhabta        
## villageHajar Kharkhita     *  
## villageHajar Seleman       .  
## villageHajilija            *  
## villageHaleila                
## villageHara                   
## villageHarkow              .  
## villageHashaba                
## villageHaskanita           *  
## villageHee Al Gameena      .  
## villageHeemada             *  
## villageHijileja               
## villageHila Haraz          .  
## villageHila Jadad             
##  [ reached getOption(&quot;max.print&quot;) -- omitted 293 rows ]
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3102 on 783 degrees of freedom
## Multiple R-squared:  0.5115, Adjusted R-squared:  0.2046 
## F-statistic: 1.667 on 492 and 783 DF,  p-value: 9.367e-11</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="regressao-multipla.html#cb306-1" tabindex="-1"></a><span class="co"># runs sensemakr for sensitivity analysis</span></span>
<span id="cb306-2"><a href="regressao-multipla.html#cb306-2" tabindex="-1"></a>sensitivity <span class="ot">&lt;-</span> <span class="fu">sensemakr</span>(<span class="at">model =</span> model, </span>
<span id="cb306-3"><a href="regressao-multipla.html#cb306-3" tabindex="-1"></a>                         <span class="at">treatment =</span> <span class="st">&quot;directlyharmed&quot;</span>,</span>
<span id="cb306-4"><a href="regressao-multipla.html#cb306-4" tabindex="-1"></a>                         <span class="at">benchmark_covariates =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb306-5"><a href="regressao-multipla.html#cb306-5" tabindex="-1"></a>                         <span class="at">kd =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb306-6"><a href="regressao-multipla.html#cb306-6" tabindex="-1"></a></span>
<span id="cb306-7"><a href="regressao-multipla.html#cb306-7" tabindex="-1"></a><span class="co"># short description of results</span></span>
<span id="cb306-8"><a href="regressao-multipla.html#cb306-8" tabindex="-1"></a>sensitivity</span></code></pre></div>
<pre><code>## Sensitivity Analysis to Unobserved Confounding
## 
## Model Formula: peacefactor ~ directlyharmed + age + farmer_dar + herder_dar + 
##     pastvoted + hhsize_darfur + female + village
## 
## Null hypothesis: q = 1 and reduce = TRUE 
## 
## Unadjusted Estimates of &#39; directlyharmed &#39;:
##   Coef. estimate: 0.09732 
##   Standard Error: 0.02326 
##   t-value: 4.18445 
## 
## Sensitivity Statistics:
##   Partial R2 of treatment with outcome: 0.02187 
##   Robustness Value, q = 1 : 0.13878 
##   Robustness Value, q = 1 alpha = 0.05 : 0.07626 
## 
## For more information, check summary.</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="regressao-multipla.html#cb308-1" tabindex="-1"></a><span class="fu">summary</span>(sensitivity)</span></code></pre></div>
<pre><code>## Sensitivity Analysis to Unobserved Confounding
## 
## Model Formula: peacefactor ~ directlyharmed + age + farmer_dar + herder_dar + 
##     pastvoted + hhsize_darfur + female + village
## 
## Null hypothesis: q = 1 and reduce = TRUE 
## -- This means we are considering biases that reduce the absolute value of the current estimate.
## -- The null hypothesis deemed problematic is H0:tau = 0 
## 
## Unadjusted Estimates of &#39;directlyharmed&#39;: 
##   Coef. estimate: 0.0973 
##   Standard Error: 0.0233 
##   t-value (H0:tau = 0): 4.1844 
## 
## Sensitivity Statistics:
##   Partial R2 of treatment with outcome: 0.0219 
##   Robustness Value, q = 1: 0.1388 
##   Robustness Value, q = 1, alpha = 0.05: 0.0763 
## 
## Verbal interpretation of sensitivity statistics:
## 
## -- Partial R2 of the treatment with the outcome: an extreme confounder (orthogonal to the covariates) that explains 100% of the residual variance of the outcome, would need to explain at least 2.19% of the residual variance of the treatment to fully account for the observed estimated effect.
## 
## -- Robustness Value, q = 1: unobserved confounders (orthogonal to the covariates) that explain more than 13.88% of the residual variance of both the treatment and the outcome are strong enough to bring the point estimate to 0 (a bias of 100% of the original estimate). Conversely, unobserved confounders that do not explain more than 13.88% of the residual variance of both the treatment and the outcome are not strong enough to bring the point estimate to 0.
## 
## -- Robustness Value, q = 1, alpha = 0.05: unobserved confounders (orthogonal to the covariates) that explain more than 7.63% of the residual variance of both the treatment and the outcome are strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0 (a bias of 100% of the original estimate), at the significance level of alpha = 0.05. Conversely, unobserved confounders that do not explain more than 7.63% of the residual variance of both the treatment and the outcome are not strong enough to bring the estimate to a range where it is no longer &#39;statistically different&#39; from 0, at the significance level of alpha = 0.05.
## 
## Bounds on omitted variable bias:
## 
## --The table below shows the maximum strength of unobserved confounders with association with the treatment and the outcome bounded by a multiple of the observed explanatory power of the chosen benchmark covariate(s).
## 
##  Bound Label R2dz.x R2yz.dx      Treatment Adjusted Estimate
##    1x female 0.0092  0.1246 directlyharmed            0.0752
##    2x female 0.0183  0.2493 directlyharmed            0.0529
##    3x female 0.0275  0.3741 directlyharmed            0.0304
##  Adjusted Se Adjusted T Adjusted Lower CI Adjusted Upper CI
##       0.0219     3.4389            0.0323            0.1182
##       0.0204     2.6002            0.0130            0.0929
##       0.0187     1.6281           -0.0063            0.0670</code></pre>
</div>
</div>
<div id="referências-1" class="section level2 hasAnchor" number="12.11">
<h2><span class="header-section-number">12.11</span> Referências<a href="#refer%C3%AAncias-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://grantmcdermott.com/interaction-effects/" class="uri">https://grantmcdermott.com/interaction-effects/</a></p>
<p>Brambor, T., Clark, W. R., &amp; Golder, M. (2006). Understanding interaction models: Improving empirical analyses. Political analysis, 14(1), 63-82.</p>
<p>Corrêa, D. S. (2015). Economy, Ideology and Elections in Latin America. DADOS: Revista de Ciencias Sociais, 58(2), 401.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inferencia.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="glm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mgaldino/book-regression/edit/main/12-Regressao-Multipla.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mgaldino/book-regression/blob/main/12-Regressao-Multipla.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
